int __fastcall sub_2D4F6C(int a1, _DWORD *a2)
{
  int v2; // r3
  int v4; // r2
  _DWORD *v5; // r11
  int v6; // r1
  int v7; // r3
  _DWORD *v8; // r0
  _DWORD *v9; // r3
  int v10; // r3
  _DWORD *v11; // r2
  _DWORD *v12; // lr
  unsigned int n; // r11
  int v14; // r3
  _DWORD *v15; // r3
  unsigned int v16; // r9
  int v17; // r2
  _DWORD *v18; // r11
  unsigned int v19; // r5
  unsigned int v20; // r6
  unsigned int v21; // r12
  unsigned int v22; // lr
  int v23; // r0
  int v24; // r1
  unsigned int v25; // r4
  unsigned int v26; // r7
  int v27; // r8
  int v28; // r10
  int v29; // r1
  _DWORD *v30; // r3
  int v31; // r1
  int v32; // r0
  unsigned int v33; // r4
  unsigned int v34; // r12
  _DWORD *v35; // r10
  int v36; // r6
  int v37; // r5
  unsigned int v38; // r11
  unsigned int v39; // r7
  int v40; // r4
  unsigned int v41; // r2
  int v42; // r3
  _BOOL4 v43; // r1
  unsigned int v44; // r0
  unsigned int v45; // r1
  unsigned int v46; // r1
  unsigned int v47; // r1
  unsigned int v48; // r2
  _BOOL4 v49; // r0
  unsigned int v50; // r12
  unsigned int v51; // r0
  unsigned int v52; // r2
  unsigned int v53; // r2
  unsigned int v54; // r3
  _BYTE *v55; // r0
  void *v56; // r9
  int v57; // r1
  char v58; // r3
  int v59; // r2
  int v60; // r2
  unsigned int v61; // r3
  int v62; // r2
  unsigned int v63; // r0
  unsigned int v64; // r2
  char v65; // r2
  char v66; // r3
  _DWORD *v67; // r3
  _DWORD *v68; // r3
  unsigned int v69; // r2
  unsigned int v70; // r7
  unsigned int v71; // r5
  int v72; // r6
  int v73; // r8
  unsigned int v74; // r3
  int v75; // r2
  unsigned int v76; // r1
  unsigned int v77; // r0
  unsigned int v78; // r1
  _DWORD *v79; // r3
  unsigned int v80; // r2
  int v81; // r12
  unsigned int v82; // r0
  unsigned int v83; // lr
  int v84; // r1
  unsigned int v85; // r12
  unsigned int v86; // r0
  unsigned int v87; // r12
  int v88; // r0
  unsigned int v89; // r1
  unsigned int v90; // r3
  unsigned int v91; // r12
  unsigned int v92; // r0
  unsigned int v93; // r3
  unsigned int v94; // r2
  unsigned int v95; // r3
  char v96; // r3
  unsigned int v97; // r2
  unsigned int v98; // r1
  bool v99; // cf
  int v100; // r2
  unsigned int v101; // r2
  unsigned int v102; // r3
  bool v103; // cf
  unsigned int v104; // r3
  _DWORD *v105; // r7
  int v106; // r6
  int v107; // r8
  unsigned int v108; // r0
  unsigned int v109; // r2
  unsigned int v110; // r12
  unsigned int v111; // r2
  int v112; // r2
  unsigned int v113; // r1
  int v114; // r4
  int v115; // t1
  _DWORD *v116; // r5
  unsigned int v117; // r3
  unsigned int v118; // r0
  unsigned int v119; // r2
  __int64 v120; // r0
  unsigned int v121; // r1
  unsigned int v122; // r12
  unsigned int v123; // r0
  bool v124; // cf
  _DWORD *v125; // r3
  _BYTE *v126; // r0
  int v127; // r2
  char v128; // r3
  int v129; // r2
  _BYTE *v130; // r0
  char v131; // r3
  int v132; // r2
  unsigned int v133; // lr
  unsigned int v134; // r0
  int v135; // r1
  unsigned int v136; // r12
  unsigned int v137; // r1
  unsigned int v138; // lr
  unsigned int v139; // r0
  _DWORD *v140; // r3
  int v141; // r3
  int v142; // r3
  _DWORD *v143; // r10
  _DWORD *v144; // r3
  int v145; // r8
  int v146; // r1
  int v147; // r0
  bool v148; // zf
  int v149; // r12
  int v150; // r2
  bool v151; // cc
  int v152; // r12
  unsigned int v153; // r4
  unsigned int v154; // r5
  _DWORD *v155; // r3
  unsigned int v156; // r2
  __int64 v157; // r4
  unsigned int v158; // lr
  unsigned int v159; // lr
  __int64 v160; // r6
  unsigned int v161; // r12
  unsigned int v162; // r2
  unsigned int v163; // r0
  unsigned int v164; // r5
  unsigned int v165; // r4
  unsigned int v166; // r4
  int *v167; // r3
  int v168; // r2
  int v169; // r3
  _DWORD *j; // r2
  _DWORD *v171; // r9
  _DWORD *v172; // r11
  int v173; // lr
  _DWORD *k; // r8
  int v175; // r3
  int v176; // r1
  bool v177; // zf
  int v178; // r2
  int v179; // r0
  bool v180; // cc
  int v181; // r12
  __int64 v182; // r4
  unsigned int v183; // r6
  unsigned int v184; // r2
  unsigned int v185; // r12
  unsigned int v186; // r1
  int v187; // r1
  _DWORD *v188; // r0
  int v189; // r1
  unsigned int v190; // r4
  unsigned int v191; // r5
  unsigned int v192; // r4
  unsigned int v193; // r2
  unsigned int v194; // r4
  size_t v195; // r1
  _BYTE *v196; // r10
  int v197; // lr
  char v198; // r3
  int v199; // r2
  int v200; // r2
  char v201; // r3
  char v202; // r3
  int v203; // r2
  int v204; // r2
  unsigned int v205; // r4
  int v206; // r2
  unsigned int v207; // r3
  char v208; // r2
  char v209; // r3
  char v210; // r3
  int v211; // r3
  _DWORD *v212; // r3
  unsigned int v213; // r2
  __int64 v214; // r6
  unsigned int v215; // r1
  unsigned int v216; // r3
  unsigned int v217; // r1
  unsigned int v218; // r4
  unsigned int v219; // r5
  int v220; // r3
  _DWORD *v221; // r3
  int v222; // r2
  int v223; // r12
  bool v224; // zf
  int v225; // r1
  int v226; // r2
  bool v227; // cc
  int v228; // r5
  int v229; // r0
  unsigned int v230; // r2
  bool v231; // zf
  int v232; // r3
  int v233; // r3
  unsigned int v234; // r0
  unsigned int v235; // r1
  bool v236; // zf
  unsigned int v237; // r0
  int v238; // r12
  int v239; // r1
  unsigned int v240; // r12
  unsigned int v241; // r2
  unsigned int v242; // r1
  char v243; // r3
  unsigned int v244; // [sp+0h] [bp-90h]
  int v245; // [sp+0h] [bp-90h]
  int v246; // [sp+0h] [bp-90h]
  int v247; // [sp+0h] [bp-90h]
  unsigned int v248; // [sp+4h] [bp-8Ch]
  unsigned int v249; // [sp+4h] [bp-8Ch]
  int v250; // [sp+4h] [bp-8Ch]
  unsigned int v252; // [sp+Ch] [bp-84h]
  unsigned int v253; // [sp+Ch] [bp-84h]
  int v254; // [sp+Ch] [bp-84h]
  unsigned int v255; // [sp+10h] [bp-80h]
  int v256; // [sp+10h] [bp-80h]
  unsigned int v257; // [sp+10h] [bp-80h]
  char v258; // [sp+10h] [bp-80h]
  _DWORD *v259; // [sp+14h] [bp-7Ch]
  _DWORD *v261; // [sp+1Ch] [bp-74h]
  _DWORD *v262; // [sp+1Ch] [bp-74h]
  int v263; // [sp+1Ch] [bp-74h]
  unsigned int v264; // [sp+20h] [bp-70h]
  _DWORD *v265; // [sp+24h] [bp-6Ch]
  int v266; // [sp+24h] [bp-6Ch]
  _DWORD *v267; // [sp+28h] [bp-68h]
  int v268; // [sp+28h] [bp-68h]
  int i; // [sp+28h] [bp-68h]
  _DWORD *v270; // [sp+28h] [bp-68h]
  int v271; // [sp+2Ch] [bp-64h]
  int v272; // [sp+2Ch] [bp-64h]
  unsigned int m; // [sp+30h] [bp-60h]
  _DWORD *ptr; // [sp+38h] [bp-58h]
  int v275; // [sp+44h] [bp-4Ch]
  size_t v276; // [sp+48h] [bp-48h]
  unsigned int v277; // [sp+48h] [bp-48h]
  int v278; // [sp+4Ch] [bp-44h]
  int v279; // [sp+50h] [bp-40h]
  unsigned int v280; // [sp+58h] [bp-38h]
  _DWORD v281[11]; // [sp+64h] [bp-2Ch] BYREF

  v2 = *(_DWORD *)(a1 + 4);
  if ( *(_DWORD *)(v2 + 4) != 5 )
    return 1;
  v4 = a2[1];
  if ( *(_DWORD *)(v4 + 4) != 5 )
    return 1;
  v265 = **(_DWORD ***)(a2[40] + 2348);
  if ( v265 )
    return sub_2D4E6C(a1, 0);
  v5 = *(_DWORD **)(*(_DWORD *)(a1 + 160) + 68);
  v259 = *(_DWORD **)(a1 + 160);
  if ( !v5 )
    return sub_2D4E6C(a1, 0);
  v6 = *(_DWORD *)(v4 + 444);
  if ( v2 == v4 )
  {
    if ( (*(_BYTE *)(v6 + 466) & 0x40) != 0 )
    {
LABEL_365:
      v264 = v259[12];
      if ( v264 )
      {
LABEL_339:
        v153 = 0;
        v154 = 0;
        do
        {
          if ( v5[8 * v153] == 1 )
          {
            v155 = &v5[8 * v153];
            v156 = v155[7];
            if ( v156 > v154 )
            {
              if ( v156 > 0x40000000 )
                sub_2A6A5C("%B: warning: segment alignment of %#Lx is too large", a1);
              else
                v154 = v155[7];
            }
          }
          ++v153;
        }
        while ( v153 < v264 );
      }
      else
      {
        v154 = 0;
      }
      v167 = (int *)a2[1];
      v6 = v167[111];
      if ( *(_DWORD *)(v6 + 16) == v154 )
      {
        v2 = *(_DWORD *)(a1 + 4);
        v259 = *(_DWORD **)(a1 + 160);
        v5 = (_DWORD *)v259[17];
      }
      else
      {
        sub_2A7D3C(*v167, v154);
        v2 = *(_DWORD *)(a1 + 4);
        v259 = *(_DWORD **)(a1 + 160);
        v5 = (_DWORD *)v259[17];
        v6 = *(_DWORD *)(a2[1] + 444);
      }
      goto LABEL_8;
    }
    v142 = a2[25];
    for ( i = v142; v142; v142 = *(_DWORD *)(v142 + 12) )
      *(_BYTE *)(v142 + 24) &= ~0x40u;
    v264 = v259[12];
    if ( v264 )
    {
      v143 = v5 + 8;
      v272 = 0;
      while ( 1 )
      {
        if ( !*(v143 - 4) && !*(v143 - 2) && (unsigned int)(*(v143 - 8) - 2) <= 1 )
          goto LABEL_339;
        v144 = *(_DWORD **)(a1 + 100);
        if ( v144 )
          break;
LABEL_370:
        v143 += 8;
        v148 = v264 == ++v272;
        if ( v148 )
        {
          v168 = i;
          goto LABEL_375;
        }
      }
      v145 = *(v143 - 8);
      v253 = v145 - 1;
      while ( 1 )
      {
        v146 = v144[15];
        if ( v146 )
          *(_BYTE *)(v146 + 24) |= 0x40u;
        v147 = v144[35];
        if ( (*(_DWORD *)(v147 + 8) & 0x400) != 0 )
        {
          v148 = v145 == 1685382482;
          if ( v145 != 1685382482 )
            v148 = v145 == 7;
          v149 = v148;
          if ( v145 == 1 )
            v149 |= 1u;
          if ( !v149 )
            goto LABEL_314;
        }
        else if ( (unsigned int)(v145 - 6) <= 1 )
        {
          goto LABEL_314;
        }
        v150 = *(_DWORD *)(v147 + 8) & 2;
        if ( v150 )
          break;
        v151 = v253 > 1;
        if ( v253 > 1 )
          v151 = (unsigned int)(v145 - 1685382480) > 2;
        if ( !v151 )
          goto LABEL_314;
        v152 = *(_DWORD *)(v147 + 4);
        if ( v152 != 8 )
          goto LABEL_347;
LABEL_332:
        if ( !v146
          || v144[5] != *(_DWORD *)(v146 + 20)
          || v144[8] != *(_DWORD *)(v146 + 32)
          || v144[7] != *(_DWORD *)(v146 + 28)
          || v144[9] != *(_DWORD *)(v146 + 36)
          || v144[10] != *(_DWORD *)(v146 + 40)
          || v144[16] != *(_DWORD *)(v146 + 64) )
        {
          goto LABEL_339;
        }
LABEL_314:
        v144 = (_DWORD *)v144[3];
        if ( !v144 )
          goto LABEL_370;
      }
      v152 = *(_DWORD *)(v147 + 4);
      if ( v152 == 8 )
      {
        v164 = *(_DWORD *)(v147 + 12);
        v165 = *(v143 - 5);
        if ( v164 < v165 )
          goto LABEL_314;
        v166 = v164 - v165;
        if ( (*(_DWORD *)(v147 + 8) & 0x400) == 0 || v145 == 7 )
          v158 = *(_DWORD *)(v147 + 24);
        else
          v158 = 0;
      }
      else
      {
LABEL_347:
        v157 = *(_QWORD *)(v147 + 16);
        if ( *(v143 - 6) > (unsigned int)v157 )
          goto LABEL_314;
        v158 = *(_DWORD *)(v147 + 24);
        if ( (unsigned int)*(v143 - 3) < v157 - (unsigned int)*(v143 - 3) + v158 )
          goto LABEL_314;
        if ( !v150 )
        {
LABEL_350:
          if ( v145 == 2 && !*(_DWORD *)(v147 + 24) )
          {
            v159 = *(v143 - 2);
            if ( v159 )
            {
              if ( v152 != 8 )
              {
                v160 = *(_QWORD *)(v147 + 16);
                v161 = *(v143 - 6);
                if ( v161 >= (unsigned int)v160 || v160 - v161 >= (unsigned int)*(v143 - 3) )
                  goto LABEL_314;
              }
              if ( v150 )
              {
                v162 = *(_DWORD *)(v147 + 12);
                v163 = *(v143 - 5);
                if ( v162 <= v163 || v159 <= v162 - v163 )
                  goto LABEL_314;
              }
            }
          }
          goto LABEL_332;
        }
        v190 = *(_DWORD *)(v147 + 12);
        v191 = *(v143 - 5);
        if ( v190 < v191 )
          goto LABEL_314;
        v166 = v190 - v191;
      }
      if ( v158 + v166 > *(v143 - 2) )
        goto LABEL_314;
      goto LABEL_350;
    }
    v168 = i;
LABEL_375:
    while ( v168 )
    {
      if ( (*(_BYTE *)(v168 + 24) & 0x40) == 0 )
        goto LABEL_365;
      *(_BYTE *)(v168 + 24) &= ~0x40u;
      v168 = *(_DWORD *)(v168 + 12);
    }
    v169 = 0;
    v281[0] = 0;
    for ( j = v5; ; j += 8 )
    {
      if ( v264 == v169 )
      {
        v258 = 0;
        goto LABEL_381;
      }
      if ( j[4] )
        break;
      ++v169;
    }
    v258 = 1;
LABEL_381:
    v171 = v5 + 8;
    v263 = 0;
    v250 = 0;
    v270 = v281;
LABEL_382:
    if ( v264 == v250 )
    {
      **(_DWORD **)(a2[40] + 2348) = v281[0];
      return sub_2D4E6C(a1, 0);
    }
    v172 = 0;
    v173 = 0;
    for ( k = *(_DWORD **)(a1 + 100); ; k = (_DWORD *)k[3] )
    {
      if ( !k )
      {
        if ( v173 )
          v195 = 4 * v173;
        else
          v195 = 44;
        v247 = v173;
        if ( v173 )
          v195 += 40;
        v196 = sub_2AD09C((int)a2, v195);
        if ( !v196 )
          return 0;
        v197 = *(v171 - 8);
        v198 = v196[32];
        *(_DWORD *)v196 = 0;
        *((_DWORD *)v196 + 1) = v197;
        v199 = *(v171 - 7);
        v198 |= 1u;
        v196[32] = v198;
        *((_DWORD *)v196 + 2) = v199;
        v200 = *(v171 - 4);
        v201 = v198 & 0xFD | (2 * (v258 & 1));
        v196[32] = v201;
        *((_DWORD *)v196 + 3) = v200;
        v202 = v201 | 4;
        v254 = v200;
        v203 = *(v171 - 1);
        v196[32] = v202;
        *((_DWORD *)v196 + 4) = 0;
        *((_DWORD *)v196 + 5) = v203;
        if ( (unsigned int)(v197 - 1685382481) <= 1 )
        {
          v204 = *(v171 - 2);
          v196[32] = v202 | 8;
          *((_DWORD *)v196 + 6) = v204;
        }
        v205 = *(v171 - 6);
        v206 = v263 ^ 1;
        if ( v197 != 1 )
          v206 |= 1u;
        if ( v205 )
        {
          v196[32] &= 0xCFu;
          if ( !v206 )
            goto LABEL_473;
          v207 = v259[5];
          if ( v205 > v207 )
          {
LABEL_471:
            v208 = 0;
            goto LABEL_463;
          }
LABEL_461:
          if ( v205 + *(v171 - 3) < v207 + v259[11] * v259[12] )
            goto LABEL_471;
          v208 = 1;
LABEL_463:
          v209 = v196[32] & 0xDF | (32 * (v208 & 1));
          v196[32] = v209;
          if ( v197 == 1 && (v209 & 0x20) != 0 )
            goto LABEL_473;
          goto LABEL_464;
        }
        if ( *(v171 - 3) < v259[10] )
        {
          v196[32] &= 0xCFu;
          if ( !v206 )
            goto LABEL_473;
LABEL_460:
          v207 = v259[5];
          goto LABEL_461;
        }
        v196[32] = v196[32] & 0xCF | 0x10;
        if ( v206 )
          goto LABEL_460;
LABEL_473:
        v263 = 1;
LABEL_464:
        if ( !v247 )
        {
          v210 = v196[32];
          v148 = (v210 & 0x10) == 0;
          v211 = v210 & 0x32;
          if ( !v148 )
            goto LABEL_492;
          if ( (unsigned __int8)v211 != 2 )
            goto LABEL_468;
LABEL_493:
          v220 = 0;
          goto LABEL_494;
        }
        v266 = 0;
        v277 = v197 - 1685382480;
        while ( 2 )
        {
          if ( v172 )
          {
            v221 = (_DWORD *)v172[35];
            v222 = v221[2];
            v223 = v222 & 0x400;
            if ( (v222 & 0x400) != 0 )
            {
              v224 = v197 == 1685382482;
              if ( v197 != 1685382482 )
                v224 = v197 == 7;
              v225 = v224;
              if ( v197 == 1 )
                v225 |= 1u;
              if ( !v225 )
                goto LABEL_499;
            }
            else if ( (unsigned int)(v197 - 6) <= 1 )
            {
LABEL_499:
              v172 = (_DWORD *)v172[3];
              continue;
            }
            v226 = v222 & 2;
            if ( !v226 )
            {
              v227 = v277 > 2;
              if ( v277 > 2 )
                v227 = (unsigned int)(v197 - 1) > 1;
              if ( !v227 )
                goto LABEL_499;
              v228 = v221[1];
              if ( v228 == 8 )
                goto LABEL_514;
LABEL_531:
              if ( v205 > v221[4]
                || (unsigned int)*(v171 - 3) < (__int64)(*((_QWORD *)v221 + 2) - v205 + (unsigned int)v221[6]) )
              {
                goto LABEL_499;
              }
              if ( v226 )
              {
LABEL_534:
                v234 = v221[3];
                v235 = *(v171 - 5);
                if ( v234 < v235 )
                  goto LABEL_499;
                v236 = v223 == 0;
                if ( v223 )
                  v236 = v197 == 7;
                v237 = v234 - v235;
                v238 = v236;
                if ( v228 != 8 )
                  v238 |= 1u;
                v239 = v238 ? v221[6] : 0;
                if ( v237 + v239 > *(v171 - 2) )
                  goto LABEL_499;
              }
LABEL_514:
              if ( v197 != 2
                || v221[6]
                || (v240 = *(v171 - 2)) == 0
                || (v228 == 8 || v205 < v221[4] && *((_QWORD *)v221 + 2) - v205 < (__int64)(unsigned int)*(v171 - 3))
                && (!v226 || (v241 = v221[3], v242 = *(v171 - 5), v241 > v242) && v240 > v241 - v242) )
              {
                v229 = v172[5];
                *(_DWORD *)&v196[4 * v266 + 40] = v172[15];
                if ( (v229 & 1) != 0 )
                {
                  v230 = v172[8];
                  if ( k )
                  {
                    if ( k[8] > v230 )
                      k = v172;
                  }
                  else
                  {
                    k = v172;
                  }
                  v231 = (v229 & 2) == 0;
                  if ( (v229 & 2) != 0 )
                  {
                    v232 = v221[4];
                  }
                  else
                  {
                    v229 = v221[3];
                    v232 = *(v171 - 5);
                  }
                  if ( v231 )
                    v233 = v229 - v232;
                  else
                    v233 = v232 - v205;
                  if ( v230 - v254 != v233 )
                    v196[32] &= ~2u;
                }
                if ( v247 == v266 + 1 )
                  break;
                ++v266;
              }
              goto LABEL_499;
            }
            v228 = v221[1];
            if ( v228 != 8 )
              goto LABEL_531;
            goto LABEL_534;
          }
          break;
        }
        v243 = v196[32];
        v148 = (v243 & 0x10) == 0;
        v211 = v243 & 0x32;
        if ( v148 )
        {
          if ( (unsigned __int8)v211 != 2 )
            goto LABEL_468;
          if ( !k )
            goto LABEL_493;
LABEL_559:
          v220 = k[8];
LABEL_494:
          *((_DWORD *)v196 + 4) = v220 - v254;
          goto LABEL_468;
        }
        if ( !k )
        {
LABEL_492:
          if ( v211 != 2 )
            goto LABEL_468;
          goto LABEL_493;
        }
        *((_DWORD *)v196 + 7) = k[7] - *(v171 - 5);
        if ( (unsigned __int8)v211 == 2 )
          goto LABEL_559;
LABEL_468:
        v171 += 8;
        *((_DWORD *)v196 + 9) = v247;
        ++v250;
        v212 = v270;
        v270 = v196;
        *v212 = v196;
        goto LABEL_382;
      }
      v175 = k[35];
      v176 = *(v171 - 8);
      if ( (*(_DWORD *)(v175 + 8) & 0x400) != 0 )
      {
        v177 = v176 == 1685382482;
        if ( v176 != 1685382482 )
          v177 = v176 == 7;
        v178 = v177;
        if ( v176 == 1 )
          v178 |= 1u;
        if ( !v178 )
          continue;
      }
      else if ( (unsigned int)(v176 - 6) <= 1 )
      {
        continue;
      }
      v179 = *(_DWORD *)(v175 + 8) & 2;
      if ( v179 )
      {
        v181 = *(_DWORD *)(v175 + 4);
        if ( v181 != 8 )
          goto LABEL_402;
        v192 = *(_DWORD *)(v175 + 12);
        v193 = *(v171 - 5);
        if ( v192 < v193 )
          continue;
        v194 = v192 - v193;
        if ( (*(_DWORD *)(v175 + 8) & 0x400) == 0 || v176 == 7 )
          v184 = *(_DWORD *)(v175 + 24);
        else
          v184 = 0;
        goto LABEL_445;
      }
      v180 = (unsigned int)(v176 - 1) > 1;
      if ( (unsigned int)(v176 - 1) > 1 )
        v180 = (unsigned int)(v176 - 1685382480) > 2;
      if ( v180 )
      {
        v181 = *(_DWORD *)(v175 + 4);
        if ( v181 != 8 )
        {
LABEL_402:
          v182 = *(_QWORD *)(v175 + 16);
          v183 = *(v171 - 6);
          if ( v183 > (unsigned int)v182 )
            continue;
          v184 = *(_DWORD *)(v175 + 24);
          if ( (unsigned int)*(v171 - 3) < v182 - v183 + v184 )
            continue;
          if ( !v179 )
            goto LABEL_405;
          v218 = *(_DWORD *)(v175 + 12);
          v219 = *(v171 - 5);
          if ( v218 < v219 )
            continue;
          v194 = v218 - v219;
LABEL_445:
          if ( v184 + v194 > *(v171 - 2) )
            continue;
LABEL_405:
          if ( v176 == 2 && !*(_DWORD *)(v175 + 24) )
          {
            v213 = *(v171 - 2);
            if ( v213 )
            {
              if ( v181 != 8 )
              {
                v214 = *(_QWORD *)(v175 + 16);
                v215 = *(v171 - 6);
                if ( v215 >= (unsigned int)v214 || v214 - v215 >= (unsigned int)*(v171 - 3) )
                  continue;
              }
              if ( v179 )
              {
                v216 = *(_DWORD *)(v175 + 12);
                v217 = *(v171 - 5);
                if ( v216 <= v217 || v213 <= v216 - v217 )
                  continue;
              }
            }
          }
        }
        ++v173;
        if ( !v172 )
          v172 = k;
        continue;
      }
    }
  }
LABEL_8:
  v7 = *(_DWORD *)(v2 + 444);
  v8 = *(_DWORD **)(a1 + 100);
  v281[0] = 0;
  v279 = v7;
  v267 = v8;
  v252 = *(_DWORD *)(v6 + 16);
  v9 = v8;
  for ( m = v259[12]; v9; v9 = (_DWORD *)v9[3] )
    *((_BYTE *)v9 + 24) &= ~0x40u;
  if ( !m )
  {
    **(_DWORD **)(a2[40] + 2348) = 0;
    return sub_2D4E6C(a1, 0);
  }
  v10 = v5[4];
  if ( v10 )
  {
LABEL_298:
    v275 = 1;
  }
  else
  {
    v11 = v5;
    while ( 1 )
    {
      ++v10;
      v11 += 8;
      if ( m == v10 )
        break;
      if ( v11[4] )
        goto LABEL_298;
    }
    v275 = 0;
  }
  v261 = v5;
  v12 = v5;
  for ( n = 0; n < m; ++n )
  {
    v14 = *v12;
    if ( *v12 == 3 )
    {
      v30 = v267;
      if ( !v267 )
        goto LABEL_19;
      while ( 1 )
      {
        if ( !v12[3] && !v12[4] && !v12[6] )
        {
          v31 = v12[5];
          if ( v31 )
          {
            if ( (v30[5] & 0x100) != 0 )
            {
              v32 = v30[9];
              if ( v32 )
              {
                v33 = v30[20];
                v34 = v12[2];
                if ( v33 >= v34 && v32 + v33 <= v31 + v34 )
                  break;
              }
            }
          }
        }
        v30 = (_DWORD *)v30[3];
        if ( !v30 )
          goto LABEL_19;
      }
      v12[3] = v30[7];
    }
    else
    {
      if ( v14 == 1 )
      {
        if ( !n )
          goto LABEL_19;
        v15 = v261;
        v16 = n;
        v17 = 0;
        v18 = v12;
        while ( 1 )
        {
          if ( *v15 == 1 )
          {
            v19 = v15[5];
            v20 = v15[6];
            v21 = v15[3];
            v22 = v18[3];
            v23 = v19 < v20 ? v15[6] : v15[5];
            v24 = v21 + v23;
            if ( v22 < v21 + v23 )
            {
              v25 = v18[5];
              v26 = v18[6];
              v27 = v25 < v26 ? v18[6] : v18[5];
              v28 = v22 + v27;
              if ( v21 < v22 + v27 )
              {
                v244 = v15[4];
                v255 = v18[4];
                if ( v255 < v23 + v244 && v244 < v27 + v255 )
                {
                  if ( v22 > v21 )
                  {
                    v187 = v28 - v24;
                    v12 = v261;
                    if ( v187 > 0 )
                    {
                      v15[6] = v20 + v187;
                      v15[5] = v19 + v187;
                    }
                    *v18 = 0;
                    n = 0;
                    goto LABEL_19;
                  }
                  v29 = v24 - v28;
                  if ( v29 > 0 )
                  {
                    v18[6] = v26 + v29;
                    v18[5] = v25 + v29;
                  }
                  *v15 = 0;
                }
              }
            }
          }
          ++v17;
          v15 += 8;
          if ( v17 == v16 )
          {
            v12 = v18;
            n = v16;
            goto LABEL_19;
          }
        }
      }
      if ( v14 == 1685382482 )
        *v12 = 0;
    }
LABEL_19:
    v12 += 8;
  }
  v280 = 0;
  v35 = v261 + 8;
  v268 = 0;
  v278 = 0;
  v262 = v281;
  while ( 1 )
  {
    v36 = *(v35 - 8);
    if ( v36 )
      break;
LABEL_112:
    v35 += 8;
    v148 = m == ++v268;
    if ( v148 )
    {
      v68 = (_DWORD *)v281[0];
      **(_DWORD **)(a2[40] + 2348) = v281[0];
      if ( v265 && v68 )
      {
        v69 = 0;
        do
        {
          v68 = (_DWORD *)*v68;
          ++v69;
        }
        while ( v68 );
        if ( v69 > v280 )
          v265[3] -= v259[11] * (v69 - v280);
      }
      return sub_2D4E6C(a1, 0);
    }
  }
  v37 = *(_DWORD *)(a1 + 100);
  if ( !v37 )
  {
    v130 = sub_2AD09C((int)a2, 0x28u);
    v56 = v130;
    if ( v130 )
    {
      v57 = *(v35 - 8);
      v40 = 0;
      v131 = v130[32];
      v38 = 0;
      *(_DWORD *)v130 = 0;
      *((_DWORD *)v130 + 1) = v57;
      v132 = *(v35 - 7);
      v130[32] = v131 | 1;
      v276 = 40;
      *((_DWORD *)v130 + 2) = v132;
      goto LABEL_100;
    }
    return 0;
  }
  v38 = 0;
  v39 = *(v35 - 4);
  v40 = 0;
  do
  {
    if ( v39 )
    {
      v41 = *(_DWORD *)(v37 + 32);
      if ( v39 > v41 )
        goto LABEL_92;
      v42 = *(_DWORD *)(v37 + 20);
      v43 = v36 == 7;
      if ( (v42 & 0x500) != 0x400 )
        v43 = 1;
      v44 = *(v35 - 2);
      if ( v43 )
        v41 += *(_DWORD *)(v37 + 36);
      v45 = *(v35 - 3);
      v46 = v45 < v44 ? v39 + v44 : v39 + v45;
      if ( v46 < v41 )
        goto LABEL_92;
    }
    else
    {
      v47 = *(_DWORD *)(v37 + 28);
      v48 = *(v35 - 5);
      if ( v47 < v48 )
        goto LABEL_92;
      v42 = *(_DWORD *)(v37 + 20);
      v49 = v36 == 7;
      if ( (v42 & 0x500) != 0x400 )
        v49 = 1;
      v50 = *(v35 - 3);
      if ( v49 )
        v47 += *(_DWORD *)(v37 + 36);
      v51 = *(v35 - 2);
      v52 = v50 < v51 ? v48 + v51 : v48 + v50;
      if ( v52 < v47 )
        goto LABEL_92;
    }
    if ( (v42 & 1) != 0 )
    {
      switch ( v36 )
      {
        case 1685382481:
          goto LABEL_81;
        case 7:
          if ( (v42 & 0x400) == 0 )
            goto LABEL_81;
          goto LABEL_76;
        case 1:
          goto LABEL_76;
      }
      goto LABEL_70;
    }
LABEL_92:
    if ( v36 != 4 )
      goto LABEL_81;
    if ( *(_DWORD *)(*(_DWORD *)(v37 + 140) + 4) != 7 )
      goto LABEL_81;
    v53 = *(_DWORD *)(v37 + 80);
    v54 = *(v35 - 6);
    if ( v53 < v54 || v53 + *(_DWORD *)(v37 + 36) > v54 + *(v35 - 3) )
      goto LABEL_81;
    v42 = *(_DWORD *)(v37 + 20);
LABEL_70:
    if ( (v42 & 0x400) != 0 )
      goto LABEL_81;
    if ( v36 == 2 && ((v42 & 0x500) == 0x400 || !*(_DWORD *)(v37 + 36)) )
    {
      if ( v39 )
      {
        if ( v39 == *(_DWORD *)(v37 + 32) )
          goto LABEL_296;
      }
      else if ( *(v35 - 5) == *(_DWORD *)(v37 + 28) )
      {
LABEL_296:
        if ( strcmp(*(const char **)v37, ".dynamic") )
          goto LABEL_81;
      }
    }
LABEL_76:
    if ( (*(_BYTE *)(v37 + 24) & 0x40) == 0 )
    {
      if ( !v40 )
        v40 = v37;
      if ( *(_DWORD *)(v37 + 60) )
        ++v38;
    }
LABEL_81:
    v37 = *(_DWORD *)(v37 + 12);
  }
  while ( v37 );
  v276 = 4 * v38 + 40;
  v55 = sub_2AD09C((int)a2, v276);
  v56 = v55;
  if ( !v55 )
    return 0;
  v57 = *(v35 - 8);
  v58 = v55[32];
  *(_DWORD *)v55 = 0;
  *((_DWORD *)v55 + 1) = v57;
  v59 = *(v35 - 7);
  v55[32] = v58 | 1;
  *((_DWORD *)v55 + 2) = v59;
  if ( !v40 || *(_DWORD *)(v40 + 60) )
  {
LABEL_100:
    v60 = *(v35 - 4);
    *((_BYTE *)v56 + 32) = *((_BYTE *)v56 + 32) & 0xFD | (2 * (v275 & 1));
    *((_DWORD *)v56 + 3) = v60;
  }
  v61 = *(v35 - 6);
  v62 = v278 ^ 1;
  if ( v57 != 1 )
    v62 |= 1u;
  if ( v61 )
  {
    *((_BYTE *)v56 + 32) &= 0xCFu;
    if ( !v62 )
      goto LABEL_264;
    v64 = v259[5];
    if ( v61 > v64 )
      goto LABEL_120;
    goto LABEL_123;
  }
  v63 = *(v35 - 3);
  if ( v63 < v259[10] )
  {
    *((_BYTE *)v56 + 32) &= 0xCFu;
    if ( !v62 )
      goto LABEL_264;
    v64 = v259[5];
LABEL_123:
    v63 = *(v35 - 3);
LABEL_107:
    if ( v61 + v63 >= v64 + v259[11] * v259[12] )
    {
      v65 = 1;
LABEL_109:
      v66 = *((_BYTE *)v56 + 32) & 0xDF | (32 * (v65 & 1));
      *((_BYTE *)v56 + 32) = v66;
      if ( v57 == 1 )
      {
        if ( (v66 & 0x20) != 0 )
          goto LABEL_264;
        goto LABEL_265;
      }
      if ( v38 )
        goto LABEL_126;
LABEL_111:
      *((_DWORD *)v56 + 9) = 0;
      v67 = v262;
      v262 = v56;
      *v67 = v56;
      goto LABEL_112;
    }
LABEL_120:
    v65 = 0;
    goto LABEL_109;
  }
  *((_BYTE *)v56 + 32) = *((_BYTE *)v56 + 32) & 0xCF | 0x10;
  if ( v62 )
  {
    v64 = v259[5];
    goto LABEL_107;
  }
LABEL_264:
  v278 = 1;
LABEL_265:
  if ( !v38 )
  {
    if ( *(v35 - 3) || !*(v35 - 2) )
      sub_2A6A5C("%B: warning: Empty loadable segment detected at vaddr=%#Lx, is this intentional?", a1, *(v35 - 5));
    goto LABEL_111;
  }
LABEL_126:
  ptr = sub_2AB3B4(v38, 4u);
  if ( !ptr )
    return 0;
  if ( v40 )
  {
    v70 = 0;
    v71 = *(v35 - 4);
    v72 = 0;
    v73 = *(v35 - 8);
    v271 = 1;
    v248 = 0;
    v245 = 0;
    v256 = 1;
    while ( 1 )
    {
      if ( v71 )
      {
        v74 = *(_DWORD *)(v40 + 32);
        if ( v71 > v74 )
          goto LABEL_175;
        v75 = *(_DWORD *)(v40 + 20);
        if ( (v75 & 0x500) != 0x400 || v73 == 7 )
          v74 += *(_DWORD *)(v40 + 36);
        v76 = *(v35 - 3);
        v77 = *(v35 - 2);
        v78 = v76 < v77 ? v71 + v77 : v71 + v76;
        if ( v74 > v78 )
        {
LABEL_175:
          if ( v73 != 4 )
            goto LABEL_166;
          if ( *(_DWORD *)(*(_DWORD *)(v40 + 140) + 4) != 7 )
            goto LABEL_166;
          v94 = *(_DWORD *)(v40 + 80);
          v95 = *(v35 - 6);
          if ( v94 < v95 || v94 + *(_DWORD *)(v40 + 36) > v95 + *(v35 - 3) )
            goto LABEL_166;
          v75 = *(_DWORD *)(v40 + 20);
          goto LABEL_140;
        }
      }
      else
      {
        v89 = *(_DWORD *)(v40 + 28);
        v90 = *(v35 - 5);
        if ( v89 < v90 )
          goto LABEL_175;
        v75 = *(_DWORD *)(v40 + 20);
        if ( (v75 & 0x500) != 0x400 || v73 == 7 )
          v89 += *(_DWORD *)(v40 + 36);
        v91 = *(v35 - 3);
        v92 = *(v35 - 2);
        v93 = v91 < v92 ? v90 + v92 : v90 + v91;
        if ( v93 < v89 )
          goto LABEL_175;
      }
      if ( (v75 & 1) == 0 )
        goto LABEL_175;
      switch ( v73 )
      {
        case 1685382481:
          goto LABEL_166;
        case 7:
          if ( (v75 & 0x400) != 0 )
            goto LABEL_146;
          goto LABEL_166;
        case 1:
          goto LABEL_146;
      }
LABEL_140:
      if ( (v75 & 0x400) == 0 )
      {
        if ( v73 != 2 || (v75 & 0x500) != 0x400 && *(_DWORD *)(v40 + 36) )
          goto LABEL_146;
        if ( v71 )
        {
          if ( v71 != *(_DWORD *)(v40 + 32) )
            goto LABEL_146;
        }
        else if ( *(v35 - 5) != *(_DWORD *)(v40 + 28) )
        {
          goto LABEL_146;
        }
        if ( !strcmp(*(const char **)v40, ".dynamic") )
        {
LABEL_146:
          if ( (*(_BYTE *)(v40 + 24) & 0x40) == 0 )
          {
            v79 = *(_DWORD **)(v40 + 60);
            if ( v79 )
            {
              ptr[v72++] = v40;
              v80 = v79[8];
              if ( !v275 )
              {
                v81 = *(v35 - 5);
                if ( v81 )
                {
                  if ( ((v245 == 0) & ((*(unsigned __int8 *)(v279 + 466) ^ 0x40u) >> 6)) != 0 && v80 )
                  {
                    if ( (*((_BYTE *)v56 + 32) & 0x10) != 0 )
                      v188 = v259;
                    else
                      v188 = 0;
                    if ( (*((_BYTE *)v56 + 32) & 0x10) != 0 )
                      v188 = (_DWORD *)v188[10];
                    v189 = *((_BYTE *)v56 + 32) & 0x20;
                    if ( (*((_BYTE *)v56 + 32) & 0x20) != 0 )
                      v189 = v259[11] * v259[12];
                    if ( (_DWORD *)v79[7] == (_DWORD *)((char *)v188 + v81 + v189) )
                      *((_DWORD *)v56 + 3) = v81;
                  }
                }
              }
              v82 = *((_DWORD *)v56 + 3);
              if ( v82 <= v80 )
              {
                v83 = *(v35 - 3);
                v84 = v73 == 7;
                if ( (v79[5] & 0x500) != 0x400 )
                  v84 = 1;
                v85 = *(v35 - 2);
                if ( v84 )
                  v84 = v79[9];
                v86 = v83 < v85 ? v82 + v85 : v82 + v83;
                if ( v84 + v80 <= v86 )
                  goto LABEL_160;
              }
              if ( v73 == 4 && *(_DWORD *)(*(_DWORD *)(v40 + 140) + 4) == 7 )
              {
                v185 = *(_DWORD *)(v40 + 80);
                v186 = *(v35 - 6);
                if ( v185 >= v186
                  && v185 + *(_DWORD *)(v40 + 36) <= v186 + *(v35 - 3)
                  && (*(_BYTE *)(a1 + 40) & 7) == 3
                  && !*(_DWORD *)(v40 + 28)
                  && !*(_DWORD *)(v40 + 32) )
                {
                  goto LABEL_160;
                }
              }
              if ( (*(_BYTE *)(v279 + 466) & 0x40) == 0 )
                goto LABEL_565;
              v133 = v79[7];
              v134 = *(v35 - 5);
              if ( v133 < v134 )
                goto LABEL_565;
              v135 = v73 == 7;
              if ( (v79[5] & 0x500) != 0x400 )
                v135 = 1;
              v136 = *(v35 - 3);
              if ( v135 )
                v135 = v79[9];
              v137 = v133 + v135;
              v138 = *(v35 - 2);
              v139 = v136 < v138 ? v134 + v138 : v134 + v136;
              if ( v137 <= v139 )
              {
LABEL_160:
                v87 = v248;
                v88 = v256;
                if ( v80 < v248 )
                  v88 = v256 | 1;
                *((_DWORD *)v56 + v245 + 10) = v79;
                if ( v88 )
                  v87 = v80;
                ++v245;
                v248 = v87;
                v256 = 0;
              }
              else
              {
LABEL_565:
                if ( v271 )
                {
                  v70 = v80;
                  v271 = 0;
                }
              }
              if ( v72 == v38 )
                goto LABEL_186;
            }
          }
        }
      }
LABEL_166:
      v40 = *(_DWORD *)(v40 + 12);
      if ( !v40 )
      {
        if ( v72 != v38 )
          goto LABEL_185;
        goto LABEL_186;
      }
    }
  }
  v70 = 0;
  v245 = 0;
  v256 = 1;
  v248 = 0;
LABEL_185:
  sub_2A6BBC("elf.c", 6911);
LABEL_186:
  if ( v38 == v245 )
  {
    *((_DWORD *)v56 + 9) = v38;
    v140 = v262;
    v262 = v56;
    *v140 = v56;
    if ( v275 )
    {
      if ( (*(_BYTE *)(v279 + 466) & 0x40) == 0 )
      {
        v141 = *((_DWORD *)v56 + 3);
        if ( v141 != v248 && (*((_BYTE *)v56 + 32) & 0x30) == 0 )
          *((_DWORD *)v56 + 4) = v248 - v141;
      }
    }
LABEL_260:
    free(ptr);
    goto LABEL_112;
  }
  v96 = *((_BYTE *)v56 + 32);
  v97 = v248;
  if ( v256 )
    v97 = v70;
  *((_DWORD *)v56 + 3) = v97;
  if ( (v96 & 0x10) != 0 )
  {
    v98 = v259[10];
    v99 = v97 >= v98;
    v100 = v97 >= v98 ? v97 - v98 : v96 & 0xEF;
    if ( v99 )
      *((_DWORD *)v56 + 3) = v100;
    else
      LOBYTE(v100) = v100 & 0xDF;
    if ( !v99 )
    {
      v96 = v100;
      *((_BYTE *)v56 + 32) = v100;
    }
  }
  if ( (v96 & 0x20) != 0 )
  {
    v101 = *((_DWORD *)v56 + 3);
    v102 = v259[11] * v259[12];
    v103 = v101 >= v102;
    if ( v101 >= v102 )
    {
      v104 = v101 - v102;
      v280 = v259[12];
      *((_DWORD *)v56 + 3) = v104;
    }
    else
    {
      LOBYTE(v104) = *((_BYTE *)v56 + 32);
    }
    if ( v103 )
      v265 = v56;
    else
      LOBYTE(v104) = v104 & 0xDF;
    if ( !v103 )
      *((_BYTE *)v56 + 32) = v104;
  }
  v249 = 0;
  while ( 2 )
  {
    v105 = ptr - 1;
    v106 = 0;
    v246 = 0;
    v107 = 1;
    *((_DWORD *)v56 + 9) = 0;
    v257 = v252 - 1;
    while ( 2 )
    {
      v115 = v105[1];
      ++v105;
      v114 = v115;
      if ( v115 )
      {
        v116 = *(_DWORD **)(v114 + 60);
        if ( !v116 )
          sub_2A6BBC("elf.c", 7011);
        v117 = v116[8];
        v113 = *((_DWORD *)v56 + 3);
        if ( v117 < v113
          || ((v116[5] & 0x500) != 0x400 || *(v35 - 8) == 7 ? (v108 = v117 + v116[9]) : (v108 = v116[8]),
              (v109 = *(v35 - 3), v110 = *(v35 - 2), v109 < v110) ? (v111 = v113 + v110) : (v111 = v113 + v109),
              v111 < v108) )
        {
          if ( *(v35 - 8) != 4 )
            goto LABEL_228;
          if ( *(_DWORD *)(*(_DWORD *)(v114 + 140) + 4) != 7 )
            goto LABEL_228;
          v118 = *(_DWORD *)(v114 + 80);
          v119 = *(v35 - 6);
          if ( v118 < v119
            || v118 + *(_DWORD *)(v114 + 36) > v119 + *(v35 - 3)
            || (*(_BYTE *)(a1 + 40) & 7) != 3
            || *(_DWORD *)(v114 + 28)
            || *(_DWORD *)(v114 + 32) )
          {
            goto LABEL_228;
          }
        }
        v112 = *((_DWORD *)v56 + 9);
        if ( !v112 )
        {
          if ( (*((_BYTE *)v56 + 32) & 0x10) != 0 )
            v113 += v259[10];
          if ( (*((_BYTE *)v56 + 32) & 0x20) != 0 )
            v113 += v259[11] * v259[12];
          if ( v117 != v113 )
            sub_2A6BF0((int)"elf.c", 7027, (int)"rewrite_elf_program_header");
          goto LABEL_221;
        }
        v120 = *(_QWORD *)(*((_DWORD *)v56 + v112 + 9) + 32);
        v121 = HIDWORD(v120) + v120;
        if ( __CFADD__(v121, v257) )
          v122 = -1;
        else
          v122 = v252;
        if ( !__CFADD__(v121, v257) )
          v122 = -v122 & (v121 + v257);
        if ( __CFADD__(v117, v257) )
          v123 = -1;
        else
          v123 = v252;
        if ( !__CFADD__(v117, v257) )
          v123 = -v123 & (v117 + v257);
        v124 = v122 >= v123;
        if ( v122 >= v123 )
          v124 = v117 >= v121;
        if ( v124 )
        {
LABEL_221:
          *((_DWORD *)v56 + 9) = v112 + 1;
          *((_DWORD *)v56 + v112 + 10) = v116;
          ++v249;
          *v105 = 0;
          *(_BYTE *)(v114 + 24) |= 0x40u;
        }
        else
        {
LABEL_228:
          if ( v107 )
          {
            v246 = v116[8];
            v107 = 0;
          }
        }
      }
      if ( ++v106 != v38 )
        continue;
      break;
    }
    if ( !*((_DWORD *)v56 + 9) )
      sub_2A6BBC("elf.c", 7066);
    v125 = v262;
    v262 = v56;
    *v125 = v56;
    if ( v249 >= v38 )
      goto LABEL_260;
    v126 = sub_2AD09C((int)a2, v276);
    v56 = v126;
    if ( v126 )
    {
      v127 = *(v35 - 8);
      v128 = v126[32] | 1;
      *(_DWORD *)v126 = 0;
      *((_DWORD *)v126 + 1) = v127;
      v129 = *(v35 - 7);
      v126[32] = v128 & 0xCD | (2 * (v275 & 1)) & 0xCF;
      *((_DWORD *)v126 + 2) = v129;
      *((_DWORD *)v126 + 3) = v246;
      continue;
    }
    break;
  }
  free(ptr);
  return 0;
}
