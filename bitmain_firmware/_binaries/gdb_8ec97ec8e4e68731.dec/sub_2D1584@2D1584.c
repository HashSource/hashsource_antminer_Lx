int __fastcall sub_2D1584(int a1, int a2)
{
  int v2; // r10
  __int64 v3; // r10
  int v4; // r4
  int (*v5)(void); // r3
  int v6; // r6
  int v7; // r5
  int v8; // r0
  int v9; // r7
  int v10; // r3
  char v11; // r2
  __int16 v12; // r3
  int v13; // r0
  int v14; // r3
  int v15; // r12
  int v16; // r8
  unsigned __int8 *v17; // r3
  int v18; // r0
  int v19; // r0
  int v20; // r5
  int v21; // r5
  int v22; // r0
  _DWORD *v23; // r3
  int v24; // r8
  _DWORD *v25; // r7
  unsigned int v26; // r9
  int v27; // r5
  int v28; // r2
  int v29; // r1
  int v30; // r1
  _DWORD *v31; // r3
  _DWORD *v32; // r12
  int v33; // r1
  _DWORD *v34; // r11
  _DWORD *v35; // r2
  int v36; // r3
  char v37; // r2
  _DWORD *v38; // r6
  int *v39; // r5
  _DWORD *v40; // r3
  int (__fastcall *v41)(_DWORD, int); // r2
  unsigned __int8 *v42; // r4
  int v43; // r0
  int v44; // r2
  int v45; // r5
  _DWORD *v46; // r3
  int v48; // r12
  int v49; // r2
  int i; // r0
  int v51; // r1
  int *v52; // r3
  int v53; // r1
  int *v54; // r6
  int v55; // r1
  int v56; // r3
  int *v57; // r3
  int v58; // r1
  int v59; // r6
  _DWORD *v60; // r3
  _DWORD *v61; // r7
  void *v62; // r0
  int v63; // r2
  int v64; // r1
  _DWORD *v65; // r3
  int v66; // r5
  int v67; // r6
  _DWORD *v68; // r2
  int v69; // r0
  int v70; // r1
  int v71; // r12
  _DWORD *v72; // r2
  int v73; // r0
  int v74; // r1
  int v75; // r8
  char **v76; // r3
  unsigned int v77; // r3
  const char *v78; // r8
  size_t v79; // r0
  int v80; // r2
  const char *v81; // r8
  char *v82; // r0
  char *v83; // r8
  int v84; // r2
  int v85; // r1
  _DWORD *v86; // r5
  int v87; // r1
  int v88; // r3
  int v89; // r2
  unsigned int v90; // r0
  int *v91; // r0
  int v92; // r3
  int *v93; // r6
  int v94; // r0
  int v95; // r0
  int v96; // r3
  char *v97; // r0
  int v98; // r8
  bool v99; // zf
  const char *v100; // r4
  int v101; // r0
  int v102; // r2
  void (__fastcall *v103)(const char *, _DWORD, int); // r3
  char *v104; // r0
  const char *v105; // r1
  int v106; // r2
  unsigned int v107; // r6
  int v108; // r9
  int v109; // r8
  __int64 v110; // r4
  __int64 v111; // r0
  int v112; // lr
  int v113; // r7
  unsigned int v114; // r7
  bool v115; // cf
  int v116; // r11
  int v117; // r1
  int v118; // t1
  int v119; // r0
  int v120; // r12
  bool v121; // zf
  int v122; // r0
  int v123; // r1
  unsigned __int8 *v124; // r0
  unsigned int v125; // r2
  int v126; // r12
  unsigned int v127; // r4
  int v128; // r5
  unsigned int v129; // lr
  int v130; // lr
  unsigned int v131; // r12
  int v132; // r5
  int v133; // r6
  unsigned int v134; // r0
  char *v135; // r0
  int v136; // r2
  unsigned __int8 *v137; // r1
  __int64 v138; // r6
  int v139; // r2
  __int64 v140; // r8
  int v141; // r2
  int *v142; // r9
  int v143; // r5
  int v144; // r3
  char v145; // r4
  int *v146; // r2
  int v147; // r3
  int v148; // t1
  int v149; // r8
  int v150; // r2
  int v151; // r3
  unsigned int v152; // r3
  unsigned int v153; // r0
  int v154; // r0
  unsigned __int8 *v155; // r1
  int v156; // r3
  __int64 v157; // r2
  int v158; // r1
  int v159; // r1
  int v160; // r8
  unsigned int v161; // r7
  int v162; // r3
  int v163; // r2
  bool v164; // zf
  int v165; // r6
  int v166; // r4
  unsigned int v167; // r5
  int v168; // r1
  int v169; // r2
  int v170; // r8
  unsigned int v171; // r3
  unsigned int v172; // r8
  int v173; // r0
  unsigned int v174; // r8
  unsigned int v175; // r3
  __int64 v176; // r0
  int v177; // r3
  int v178; // lr
  unsigned int v179; // r2
  char v180; // r3
  int v181; // r9
  int *v182; // r6
  unsigned int v183; // r8
  int v184; // r7
  int v185; // r1
  const char *v186; // r2
  unsigned int v187; // r0
  int v188; // r5
  int v189; // r2
  int v190; // r4
  int v191; // t1
  __int64 v192; // r2
  int v193; // r0
  __int64 v194; // r2
  int v195; // r2
  unsigned int v196; // r3
  void *v197; // r0
  void *v198; // r8
  int v199; // r3
  int v200; // r1
  int v201; // r2
  int *v202; // r3
  int v203; // r2
  int v204; // r1
  int v205; // r0
  int v206; // t1
  _DWORD *v207; // r1
  _DWORD *v208; // r1
  int v209; // r4
  int v210; // r3
  int v211; // lr
  int v212; // r12
  int v213; // r1
  char *v214; // r5
  int *v215; // r8
  unsigned int v216; // r5
  const char **v217; // t1
  bool v218; // zf
  char v219; // r1
  int v220; // r1
  int v221; // lr
  bool v222; // cc
  _BOOL4 v223; // r5
  int v224; // r1
  unsigned int v225; // r0
  int v226; // r12
  __int64 v227; // r6
  bool v228; // cf
  int v229; // r3
  int v230; // r0
  int v231; // r0
  unsigned int v232; // lr
  unsigned int v233; // r4
  bool v234; // cf
  int v235; // r3
  int v236; // r4
  unsigned int v237; // r0
  bool v238; // cf
  int v239; // r3
  int v240; // r0
  __int64 v241; // r4
  int v242; // r5
  __int64 v243; // r0
  unsigned int v244; // r5
  int v245; // lr
  __int64 v246; // r0
  unsigned int v247; // lr
  unsigned int v248; // r1
  unsigned int v249; // r0
  int v250; // r0
  bool v251; // zf
  _DWORD *v252; // r3
  int v253; // r2
  int v254; // r3
  unsigned int v255; // r3
  unsigned int v256; // r2
  bool v257; // cc
  int *v258; // r1
  int v259; // r3
  int v260; // r2
  int v261; // t1
  int *v262; // r1
  int v263; // r2
  int v264; // t1
  unsigned int v265; // r2
  unsigned int v266; // r3
  int v267; // r2
  __int64 v268; // r2
  int v269; // r3
  unsigned int v270; // r7
  unsigned int v271; // r2
  unsigned int v272; // r1
  _DWORD *v273; // r0
  _DWORD *v274; // r6
  int v275; // r3
  int *v276; // r9
  int *v277; // r8
  int *v278; // r7
  int *v279; // t1
  int v280; // r3
  int v281; // r7
  int v282; // t1
  _DWORD *j; // r8
  int v284; // r0
  int v285; // r1
  int v286; // r7
  int v287; // r2
  _DWORD *v288; // r4
  int v289; // r5
  int v290; // lr
  _DWORD *v291; // r3
  char v292; // r12
  int v293; // r12
  unsigned int v294; // r7
  int v295; // r2
  int v296; // r3
  int v297; // r0
  _DWORD *v298; // r2
  int v299; // r3
  _DWORD *v300; // r2
  int v301; // lr
  int v302; // r1
  int v303; // t1
  int v304; // r0
  char v305; // r3
  _DWORD *v306; // r3
  int v307; // r0
  int v308; // r7
  int *v309; // r8
  int *v310; // r4
  int *v311; // r9
  int v312; // r8
  int v313; // r1
  int v314; // r0
  int *v315; // r6
  int v316; // t1
  int *v317; // r0
  unsigned int v318; // r2
  unsigned int v319; // r3
  int v320; // t1
  unsigned int v321; // r1
  unsigned int v322; // r3
  _DWORD *k; // r8
  int v324; // r3
  int v325; // r9
  int v326; // r0
  int v327; // r3
  int v328; // r2
  int v329; // r0
  _DWORD *v330; // r0
  int (*v331)(const void *, const void *); // r12
  _DWORD *v332; // r1
  int v333; // r1
  int v334; // r3
  int v335; // r0
  _DWORD *v336; // r6
  _DWORD *v337; // r2
  int (__fastcall *v338)(_DWORD); // r3
  int v339; // r3
  _DWORD *v340; // r6
  int v341; // r9
  int v342; // r3
  _DWORD *v343; // r1
  int v344; // r0
  int v345; // r7
  unsigned int v346; // r8
  int (__fastcall *v347)(_DWORD *, int); // r3
  char v348; // r3
  char v349; // r1
  _DWORD *v350; // r4
  _DWORD *v351; // r3
  _DWORD *v352; // t1
  unsigned int v353; // r5
  int v354; // r3
  bool v355; // zf
  int v356; // r1
  int v357; // r0
  int v358; // r3
  int v359; // r0
  int v360; // r3
  unsigned int v361; // r2
  _DWORD *v362; // r3
  bool v363; // cc
  int v364; // r3
  _DWORD *v365; // r3
  char v366; // r3
  char v367; // r2
  int v368; // r5
  unsigned int v369; // r0
  unsigned int v370; // r1
  unsigned int v371; // r1
  unsigned int v372; // r0
  __int64 v373; // r2
  int v374; // r3
  char *v375; // r0
  int v376; // r1
  _DWORD *v377; // r3
  int v378; // r0
  int v379; // r0
  char v380; // r3
  const char *v381; // r1
  int v382; // r2
  unsigned int v383; // r2
  int v384; // r1
  unsigned int v385; // r0
  unsigned int v386; // r2
  unsigned int v387; // r12
  _DWORD *v388; // r5
  int v389; // r6
  _DWORD *v390; // r1
  int v391; // lr
  int v392; // r3
  int v393; // r0
  int v394; // r1
  unsigned int v395; // r1
  unsigned int v396; // r2
  _DWORD *v397; // r2
  int v398; // r1
  int v399; // r0
  int v400; // [sp+Ch] [bp-A0h]
  int v401; // [sp+Ch] [bp-A0h]
  int v402; // [sp+Ch] [bp-A0h]
  int *v403; // [sp+Ch] [bp-A0h]
  int v404; // [sp+Ch] [bp-A0h]
  int v405; // [sp+Ch] [bp-A0h]
  size_t n; // [sp+10h] [bp-9Ch]
  char *na; // [sp+10h] [bp-9Ch]
  __int64 nb; // [sp+10h] [bp-9Ch]
  int *nc; // [sp+10h] [bp-9Ch]
  int nd; // [sp+10h] [bp-9Ch]
  unsigned int ne; // [sp+10h] [bp-9Ch]
  int v412; // [sp+18h] [bp-94h]
  int v413; // [sp+1Ch] [bp-90h]
  int v414; // [sp+1Ch] [bp-90h]
  int v415; // [sp+1Ch] [bp-90h]
  int v416; // [sp+1Ch] [bp-90h]
  int v417; // [sp+1Ch] [bp-90h]
  int v419; // [sp+24h] [bp-88h]
  int v420; // [sp+24h] [bp-88h]
  int v421; // [sp+24h] [bp-88h]
  int v422; // [sp+24h] [bp-88h]
  unsigned int v423; // [sp+24h] [bp-88h]
  int v424; // [sp+28h] [bp-84h]
  int v425; // [sp+28h] [bp-84h]
  _DWORD *v426; // [sp+28h] [bp-84h]
  int v427; // [sp+28h] [bp-84h]
  int v428; // [sp+2Ch] [bp-80h]
  int v429; // [sp+2Ch] [bp-80h]
  int v430; // [sp+30h] [bp-7Ch]
  int v431; // [sp+30h] [bp-7Ch]
  int v432; // [sp+30h] [bp-7Ch]
  int v433; // [sp+30h] [bp-7Ch]
  int v434; // [sp+30h] [bp-7Ch]
  unsigned int v435; // [sp+38h] [bp-74h]
  int v436; // [sp+38h] [bp-74h]
  unsigned int v437; // [sp+38h] [bp-74h]
  int v438; // [sp+38h] [bp-74h]
  _DWORD *v439; // [sp+38h] [bp-74h]
  unsigned int v440; // [sp+3Ch] [bp-70h]
  _DWORD *v441; // [sp+3Ch] [bp-70h]
  int v442; // [sp+40h] [bp-6Ch]
  int ptr; // [sp+44h] [bp-68h]
  _DWORD *ptra; // [sp+44h] [bp-68h]
  int v445; // [sp+48h] [bp-64h]
  _DWORD *v446; // [sp+4Ch] [bp-60h]
  int v447; // [sp+4Ch] [bp-60h]
  _DWORD *v448; // [sp+4Ch] [bp-60h]
  __compar_fn_t compar; // [sp+50h] [bp-5Ch]
  unsigned int v450; // [sp+54h] [bp-58h]
  int v451; // [sp+54h] [bp-58h]
  _DWORD *v452; // [sp+58h] [bp-54h]
  unsigned int v453; // [sp+5Ch] [bp-50h]
  int v454; // [sp+5Ch] [bp-50h]
  int v455; // [sp+60h] [bp-4Ch]
  int v456; // [sp+7Ch] [bp-30h] BYREF
  int v457; // [sp+80h] [bp-2Ch] BYREF
  int v458; // [sp+84h] [bp-28h]
  char s[32]; // [sp+88h] [bp-24h] BYREF

  if ( (*(_BYTE *)(a1 + 43) & 0x40) != 0 )
    return 1;
  HIDWORD(v3) = a1;
  v4 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 444);
  v5 = *(int (**)(void))(v4 + 160);
  if ( v5 )
  {
    a1 = v5();
    v6 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 4) + 444);
  }
  else
  {
    v6 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 444);
  }
  v7 = *(_DWORD *)(HIDWORD(v3) + 160);
  v8 = sub_2F00E8(a1);
  v9 = v8;
  if ( !v8 )
    return 0;
  *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348) + 4) = v8;
  *(_DWORD *)v7 = 1179403647;
  v10 = *(_DWORD *)(v6 + 392);
  *(_BYTE *)(v7 + 4) = *(_BYTE *)(v10 + 12);
  if ( *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 4) + 8) )
    v11 = 1;
  else
    v11 = 2;
  *(_BYTE *)(v7 + 5) = v11;
  *(_BYTE *)(v7 + 6) = *(_BYTE *)(v10 + 13);
  if ( ((*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0x40) != 0 )
  {
    *(_WORD *)(v7 + 36) = 3;
  }
  else if ( ((*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 2) != 0 )
  {
    *(_WORD *)(v7 + 36) = 2;
  }
  else
  {
    if ( (*(_BYTE *)(HIDWORD(v3) + 40) & 7) == 3 )
      v12 = 4;
    else
      v12 = 1;
    *(_WORD *)(v7 + 36) = v12;
  }
  v13 = sub_2A6780(SHIDWORD(v3));
  v15 = *(_DWORD *)(HIDWORD(v3) + 116);
  if ( v13 )
    v14 = *(_DWORD *)(v6 + 8);
  else
    *(_WORD *)(v7 + 38) = 0;
  v16 = *(_DWORD *)(HIDWORD(v3) + 160);
  if ( v13 )
    *(_WORD *)(v7 + 38) = v14;
  v17 = *(unsigned __int8 **)(v6 + 392);
  *(_DWORD *)(v7 + 28) = v17[13];
  v18 = *v17;
  *(_DWORD *)(v7 + 16) = v15;
  *(_DWORD *)(v7 + 20) = 0;
  *(_DWORD *)(v7 + 40) = v18;
  *(_DWORD *)(v7 + 44) = 0;
  *(_DWORD *)(v7 + 48) = 0;
  *(_DWORD *)(v7 + 52) = v17[2];
  v19 = sub_2F0184(v9, ".symtab", 0);
  v20 = *(_DWORD *)(HIDWORD(v3) + 160);
  *(_DWORD *)(v16 + 72) = v19;
  *(_DWORD *)(v20 + 184) = sub_2F0184(v9, ".strtab", 0);
  v21 = *(_DWORD *)(HIDWORD(v3) + 160);
  v22 = sub_2F0184(v9, ".shstrtab", 0);
  v23 = *(_DWORD **)(HIDWORD(v3) + 160);
  *(_DWORD *)(v21 + 128) = v22;
  if ( v23[18] == -1 )
    return 0;
  if ( v23[46] == -1 )
    return 0;
  if ( v23[32] == -1 )
    return 0;
  (*(void (__fastcall **)(_DWORD, int))(v4 + 200))(HIDWORD(v3), a2);
  v457 = a2;
  v458 = 0;
  sub_2ADCFC(SHIDWORD(v3), (int (__fastcall *)(int, int, int))sub_2CCC68, (int)&v457);
  v412 = v458;
  if ( v458 )
    return 0;
  v24 = *(_DWORD *)(HIDWORD(v3) + 160);
  sub_2F038C(*(_DWORD *)(*(_DWORD *)(v24 + 2348) + 4));
  if ( a2 )
  {
    v25 = *(_DWORD **)(HIDWORD(v3) + 100);
    if ( (*(_BYTE *)(a2 + 1) & 0x10) != 0 )
    {
      v26 = 2;
      v27 = 1;
      goto LABEL_79;
    }
  }
  else
  {
    v25 = *(_DWORD **)(HIDWORD(v3) + 100);
  }
  if ( !v25 )
  {
    v26 = 2;
    v27 = 1;
LABEL_78:
    *(_DWORD *)(HIDWORD(v3) + 40) = *(_DWORD *)(HIDWORD(v3) + 40) & 0xFE00001F
                                  | (32 * ((*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0xFFFFE));
    goto LABEL_79;
  }
  v28 = 0;
  v27 = 1;
  do
  {
    v30 = v25[35];
    v26 = v27 + 1;
    v31 = (_DWORD *)v25[3];
    v32 = v31;
    if ( *(_DWORD *)(v30 + 4) == 17 )
    {
      if ( (v25[5] & 0x100000) != 0 )
      {
        v33 = v25[4];
        if ( v33 )
          *(_DWORD *)(v33 + 12) = v31;
        else
          *(_DWORD *)(HIDWORD(v3) + 100) = v31;
        if ( v33 )
          v31 = (_DWORD *)v25[3];
        if ( v32 )
          v32[4] = v33;
        else
          *(_DWORD *)(HIDWORD(v3) + 104) = v33;
        --*(_DWORD *)(HIDWORD(v3) + 108);
      }
      else
      {
        v90 = v27 + 2;
        *(_DWORD *)(v30 + 92) = v27++;
        v26 = v90;
      }
    }
    v29 = v25[19];
    v25 = v31;
    v28 += v29;
  }
  while ( v31 );
  v25 = *(_DWORD **)(HIDWORD(v3) + 100);
  if ( !v28 )
    goto LABEL_78;
LABEL_79:
  v48 = *(_DWORD *)(HIDWORD(v3) + 160);
  v49 = *(_DWORD *)(v48 + 2348);
  for ( i = *(_DWORD *)(v49 + 4); v25; v27 = v2 )
  {
    while ( 1 )
    {
      v54 = (int *)v25[35];
      v2 = v27 + 1;
      v55 = *v54;
      if ( v54[1] != 17 )
      {
        v56 = v27 + 2;
        v54[23] = v27++;
        v2 = v56;
      }
      if ( v55 != -1 )
      {
        sub_2F0260(i);
        v48 = *(_DWORD *)(HIDWORD(v3) + 160);
        v49 = *(_DWORD *)(v48 + 2348);
        i = *(_DWORD *)(v49 + 4);
      }
      v57 = (int *)v54[15];
      if ( !v57 )
        break;
      v51 = *v57;
      v54[17] = v27;
      v27 = v2 + 1;
      if ( v51 != -1 )
      {
        sub_2F0260(i);
        v48 = *(_DWORD *)(HIDWORD(v3) + 160);
        v49 = *(_DWORD *)(v48 + 2348);
        i = *(_DWORD *)(v49 + 4);
      }
      v52 = (int *)v54[19];
      if ( !v52 )
        goto LABEL_93;
LABEL_84:
      v53 = *v52;
      v26 = v27 + 1;
      v54[21] = v2;
      if ( v53 != -1 )
      {
        sub_2F0260(i);
        v48 = *(_DWORD *)(HIDWORD(v3) + 160);
        v49 = *(_DWORD *)(v48 + 2348);
        i = *(_DWORD *)(v49 + 4);
      }
      v25 = (_DWORD *)v25[3];
      if ( !v25 )
        goto LABEL_94;
    }
    v54[17] = 0;
    v58 = v2;
    v52 = (int *)v54[19];
    v2 = v27;
    v27 = v58;
    if ( v52 )
      goto LABEL_84;
LABEL_93:
    v25 = (_DWORD *)v25[3];
    v26 = v27;
    v54[21] = (int)v52;
  }
LABEL_94:
  v59 = *(_DWORD *)(HIDWORD(v3) + 124);
  if ( v59 )
    goto LABEL_141;
  if ( !a2 )
  {
    if ( ((*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0x43) != 1 )
    {
      v59 = 0;
      goto LABEL_96;
    }
LABEL_141:
    *(_DWORD *)(v48 + 2320) = v27;
    sub_2F0260(i);
    if ( v26 > 0xFEFE )
    {
      if ( *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 520) )
        sub_2A6BBC("elf.c", 3703);
      v91 = (int *)sub_2AD09C(SHIDWORD(v3), 0x40u);
      v92 = *(_DWORD *)(HIDWORD(v3) + 160);
      v93 = v91;
      v91[14] = v26;
      v94 = *(_DWORD *)(v92 + 2348);
      *(_DWORD *)(v92 + 520) = v93;
      v95 = sub_2F0184(*(_DWORD *)(v94 + 4), ".symtab_shndx", 0);
      *v93 = v95;
      if ( v95 == -1 )
        return 0;
      v26 = v27 + 2;
    }
    v27 = v26 + 1;
    v59 = 1;
    v96 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348);
    *(_DWORD *)(v96 + 48) = v26;
    v26 += 2;
    sub_2F0260(*(_DWORD *)(v96 + 4));
    v49 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348);
    i = *(_DWORD *)(v49 + 4);
  }
LABEL_96:
  *(_DWORD *)(v49 + 44) = v27;
  sub_2F0260(i);
  v60 = *(_DWORD **)(HIDWORD(v3) + 160);
  v60[15] = *(_DWORD *)(v60[587] + 44);
  if ( v26 >= 0xFFFFFF00 )
  {
    sub_2A6A5C("%B: too many sections: %u", HIDWORD(v3), v26);
    return v412;
  }
  v60[133] = v26;
  v60[14] = v26;
  v61 = sub_2AD188(SHIDWORD(v3), v26, 4u);
  if ( !v61 )
    return 0;
  v62 = sub_2AD09C(SHIDWORD(v3), 0x38u);
  *v61 = v62;
  if ( !v62 )
  {
    sub_2AD1F0(SHIDWORD(v3));
    return v412;
  }
  v63 = *(_DWORD *)(HIDWORD(v3) + 160);
  v64 = *(_DWORD *)(v63 + 2348);
  *(_DWORD *)(v63 + 64) = v61;
  v61[*(_DWORD *)(v64 + 44)] = v24 + 128;
  if ( v59 )
  {
    v61[*(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2320)] = v24 + 72;
    v65 = *(_DWORD **)(HIDWORD(v3) + 160);
    if ( v65[133] > 0xFF00u )
    {
      v66 = v65[130];
      if ( !v66 )
        sub_2A6BBC("elf.c", 3757);
      v61[*(_DWORD *)(v66 + 56)] = v66;
      v65 = *(_DWORD **)(HIDWORD(v3) + 160);
      *(_DWORD *)(v66 + 28) = v65[580];
    }
    v61[*(_DWORD *)(v65[587] + 48)] = v24 + 184;
    *(_DWORD *)(v24 + 100) = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348) + 48);
  }
  v67 = *(_DWORD *)(HIDWORD(v3) + 100);
  if ( v67 )
  {
    v413 = v4;
    v2 = a2;
    while ( 1 )
    {
      v86 = *(_DWORD **)(v67 + 140);
      v87 = v86[17];
      v88 = v86[23];
      v89 = v86[21];
      v61[v88] = v86;
      if ( v87 )
      {
        v61[v87] = v86[15];
        if ( v89 )
        {
          v61[v89] = v86[19];
          v68 = (_DWORD *)v86[15];
          v69 = *(_DWORD *)(HIDWORD(v3) + 160);
          v70 = v68[2];
          v71 = *(_DWORD *)(v69 + 2320);
          v68[8] = v88;
          v68[7] = v71;
          v68[2] = v70 | 0x40;
LABEL_109:
          v72 = (_DWORD *)v86[19];
          v73 = *(_DWORD *)(v69 + 2320);
          v74 = v72[2];
          v72[8] = v88;
          v72[7] = v73;
          v72[2] = v74 | 0x40;
          goto LABEL_110;
        }
        v397 = (_DWORD *)v86[15];
        v398 = v397[2];
        v399 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2320);
        v397[8] = v88;
        v397[7] = v399;
        v397[2] = v398 | 0x40;
      }
      else if ( v89 )
      {
        v61[v89] = v86[19];
        v69 = *(_DWORD *)(HIDWORD(v3) + 160);
        goto LABEL_109;
      }
LABEL_110:
      if ( (v86[2] & 0x80) == 0 )
        goto LABEL_117;
      v75 = *(_DWORD *)(*(_DWORD *)(v67 + 140) + 100);
      if ( v75 )
      {
        if ( a2 )
        {
          if ( (char **)v75 == &off_470950 )
          {
            v76 = off_47098C;
            goto LABEL_115;
          }
          v76 = *(char ***)(v75 + 60);
          if ( v76 == &off_470950 )
          {
            if ( (((*(_WORD *)(v75 + 24) & 0x380) - 256) & 0xFEFF) != 0 )
            {
              sub_2A6A5C(
                "%B: sh_link of section `%A' points to discarded section `%A' of `%B'",
                HIDWORD(v3),
                v86[11],
                *(_DWORD *)(*(_DWORD *)(v67 + 140) + 100),
                *(_DWORD *)(v75 + 148));
              v122 = sub_2E9524(v75, a2);
              if ( !v122 )
                goto LABEL_181;
              v76 = *(char ***)(v122 + 60);
              goto LABEL_115;
            }
          }
          else
          {
LABEL_115:
            if ( !v76 )
            {
              sub_2A6BBC("elf.c", 3826);
              __und(0);
            }
          }
        }
        else
        {
          v76 = *(char ***)(v75 + 60);
          if ( !v76 )
          {
            sub_2A6A5C(
              "%B: sh_link of section `%A' points to removed section `%A' of `%B'",
              HIDWORD(v3),
              v86[11],
              *(_DWORD *)(*(_DWORD *)(v67 + 140) + 100),
              *(_DWORD *)(v75 + 148));
LABEL_181:
            ((void (__fastcall *)(int))loc_2A6C48)(17);
            return v412;
          }
        }
        v86[7] = *((_DWORD *)v76[35] + 23);
        goto LABEL_117;
      }
      v103 = *(void (__fastcall **)(const char *, _DWORD, int))(*(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 4) + 444) + 376);
      if ( v103 )
        v103("%B: warning: sh_link not set for section `%A'", HIDWORD(v3), v67);
LABEL_117:
      v77 = v86[1];
      if ( v77 == 11 )
        goto LABEL_175;
      if ( v77 <= 0xB )
      {
        if ( v77 != 5 )
        {
          if ( v77 > 5 )
          {
            if ( v77 == 6 )
              goto LABEL_175;
            if ( v77 == 9 )
              goto LABEL_154;
          }
          else
          {
            if ( v77 == 3 )
            {
              v78 = *(const char **)v67;
              if ( !strncmp(*(const char **)v67, ".stab", 5u) )
              {
                v79 = strlen(v78);
                v80 = (unsigned __int8)v78[v79 - 3];
                v81 = &v78[v79 - 3];
                n = v79 - 3;
                if ( v80 == 115 && v81[1] == 116 && v81[2] == 114 && !v81[3] )
                {
                  v82 = (char *)sub_2AB368(v79 - 2);
                  v83 = v82;
                  if ( !v82 )
                    return 0;
                  memcpy(v82, *(const void **)v67, n);
                  v83[n] = 0;
                  na = sub_2AD7AC(SHIDWORD(v3), v83);
                  free(v83);
                  if ( na )
                  {
                    v84 = *((_DWORD *)na + 35);
                    v85 = *(_DWORD *)(v84 + 40);
                    *(_DWORD *)(v84 + 28) = v86[23];
                    if ( !v85 )
                      *(_DWORD *)(*((_DWORD *)na + 35) + 40) = sub_2A789C(SHIDWORD(v3)) / 4 + 4;
                  }
                }
              }
              goto LABEL_131;
            }
            if ( v77 == 4 )
            {
LABEL_154:
              v97 = sub_2AD7AC(SHIDWORD(v3), ".dynsym");
              if ( v97 )
                v86[7] = *(_DWORD *)(*((_DWORD *)v97 + 35) + 92);
              v98 = *(_DWORD *)(*(_DWORD *)(v67 + 140) + 4);
              v99 = v98 == 9;
              if ( v98 != 9 )
                v99 = v98 == 4;
              if ( v99 )
              {
                v100 = *(const char **)v67;
                if ( !strncmp(*(const char **)v67, ".rel", 4u) && (v98 != 4 || v100[4] == 97) )
                {
                  v101 = (*(int (**)(void))(*(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v67 + 148) + 4) + 444) + 368))();
                  if ( v101 )
                  {
                    v102 = *(_DWORD *)(*(_DWORD *)(v101 + 140) + 92);
                    v86[2] |= 0x40u;
                    v86[8] = v102;
                  }
                }
              }
              goto LABEL_131;
            }
          }
          goto LABEL_131;
        }
        goto LABEL_169;
      }
      if ( v77 == 1879048183 )
      {
        v105 = ".gnu.libstr";
        if ( (*(_DWORD *)(v67 + 20) & 1) != 0 )
          v105 = ".dynstr";
        v104 = sub_2AD7AC(SHIDWORD(v3), v105);
        if ( !v104 )
          goto LABEL_131;
LABEL_170:
        v86[7] = *(_DWORD *)(*((_DWORD *)v104 + 35) + 92);
        goto LABEL_131;
      }
      if ( v77 <= 0x6FFFFFF7 )
      {
        if ( v77 == 17 )
        {
          v86[7] = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2320);
          goto LABEL_131;
        }
        if ( v77 != 1879048182 )
          goto LABEL_131;
LABEL_169:
        v104 = sub_2AD7AC(SHIDWORD(v3), ".dynsym");
        if ( v104 )
          goto LABEL_170;
        goto LABEL_131;
      }
      if ( v77 >= 0x6FFFFFFD )
      {
        if ( v77 <= 0x6FFFFFFE )
        {
LABEL_175:
          v104 = sub_2AD7AC(SHIDWORD(v3), ".dynstr");
          if ( !v104 )
            goto LABEL_131;
          goto LABEL_170;
        }
        if ( v77 == 1879048191 )
          goto LABEL_169;
      }
LABEL_131:
      v67 = *(_DWORD *)(v67 + 12);
      if ( !v67 )
      {
        v4 = v413;
        break;
      }
    }
  }
  v400 = (*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0xFFFFF;
  if ( a2 )
  {
    v445 = 0;
    v456 = 0;
    ptr = 0;
    goto LABEL_185;
  }
  v242 = *(_DWORD *)(HIDWORD(v3) + 124);
  if ( !v242 && ((*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0x43) != 1 )
  {
    v445 = 0;
    ptr = 0;
    goto LABEL_480;
  }
  v269 = *(_DWORD *)(HIDWORD(v3) + 100);
  nc = *(int **)(HIDWORD(v3) + 120);
  if ( v269 )
  {
    v271 = 0;
    do
    {
      v272 = *(_DWORD *)(v269 + 8);
      v269 = *(_DWORD *)(v269 + 12);
      if ( v271 < v272 )
        v271 = v272;
    }
    while ( v269 );
    v270 = v271 + 1;
  }
  else
  {
    v270 = 1;
  }
  v273 = sub_2AD188(SHIDWORD(v3), v270, 4u);
  v274 = v273;
  if ( !v273 )
    return 0;
  v275 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348);
  *(_DWORD *)(v275 + 8) = v273;
  *(_DWORD *)(v275 + 40) = v270;
  if ( v242 )
  {
    v276 = nc;
    v277 = nc;
    do
    {
      v279 = (int *)*v277++;
      v278 = v279;
      if ( (v279[3] & 0x100) != 0 && !v278[2] && !sub_2CC0A4((char *)HIDWORD(v3), v278) )
      {
        v280 = v278[4];
        if ( (char **)v280 != &off_470950 )
        {
          if ( HIDWORD(v3) != *(_DWORD *)(v280 + 148) )
            v280 = *(_DWORD *)(v280 + 60);
          v274[*(_DWORD *)(v280 + 8)] = v278;
        }
      }
    }
    while ( &nc[v242] != v277 );
    LODWORD(v3) = 0;
    v281 = 0;
    do
    {
      v282 = *v276++;
      if ( sub_2CC04C(SHIDWORD(v3), v282) )
      {
        ++v281;
      }
      else if ( !sub_2CC0A4((char *)HIDWORD(v3), (int *)*(v276 - 1)) )
      {
        LODWORD(v3) = v3 + 1;
      }
    }
    while ( v277 != v276 );
  }
  else
  {
    LODWORD(v3) = 0;
    v281 = 0;
  }
  for ( j = *(_DWORD **)(HIDWORD(v3) + 100); j; j = (_DWORD *)j[3] )
  {
    if ( !v274[j[2]] )
    {
      if ( sub_2CC04C(SHIDWORD(v3), j[38]) )
        ++v281;
      else
        LODWORD(v3) = v3 + 1;
    }
  }
  v422 = v3 + v281;
  v307 = sub_2AD048(SHIDWORD(v3), v3 + v281, 4u);
  v416 = v307;
  if ( !v307 )
    return 0;
  if ( !v242 )
  {
    v308 = 0;
    goto LABEL_676;
  }
  v309 = nc;
  v426 = v274;
  nd = v4;
  v310 = v309;
  v311 = &v309[v242];
  v242 = 0;
  v308 = 0;
  v312 = v307;
  do
  {
    v316 = *v310++;
    v315 = (int *)v316;
    if ( sub_2CC04C(SHIDWORD(v3), v316) )
    {
      v313 = v3 + v308++;
      v314 = v313 + 1;
LABEL_648:
      *(_DWORD *)(v312 + 4 * v313) = v315;
      v315[5] = v314;
      continue;
    }
    if ( !sub_2CC0A4((char *)HIDWORD(v3), v315) )
    {
      v314 = v242 + 1;
      v313 = v242++;
      goto LABEL_648;
    }
  }
  while ( v311 != v310 );
  v4 = nd;
  v274 = v426;
LABEL_676:
  for ( k = *(_DWORD **)(HIDWORD(v3) + 100); k; k = (_DWORD *)k[3] )
  {
    v324 = k[2];
    if ( !v274[v324] )
    {
      v325 = k[38];
      v274[v324] = v325;
      v326 = sub_2CC04C(SHIDWORD(v3), v325);
      if ( v326 )
      {
        v328 = v3 + v308;
      }
      else
      {
        v327 = v242 + 1;
        v328 = v242;
      }
      if ( v326 )
        v327 = v328 + 1;
      *(_DWORD *)(v416 + 4 * v328) = v325;
      if ( v326 )
        ++v308;
      else
        v242 = v327;
      *(_DWORD *)(v325 + 20) = v327;
    }
  }
  v329 = sub_302AAC(HIDWORD(v3), v416, v422);
  v445 = sub_2F00E8(v329);
  if ( !v445 )
    return 0;
  v330 = *(_DWORD **)(HIDWORD(v3) + 160);
  v331 = *(int (**)(const void *, const void *))(HIDWORD(v3) + 124);
  v2 = v3 + 1;
  v332 = *(_DWORD **)(*(_DWORD *)(HIDWORD(v3) + 4) + 444);
  v330[19] = 2;
  compar = v331;
  v439 = v332;
  v333 = v332[98];
  v452 = v330;
  v423 = (unsigned int)v331 + 1;
  v334 = *(unsigned __int8 *)(v333 + 5);
  v330[26] = v2;
  v330[28] = v334;
  v330[24] = ((_DWORD)v331 + 1) * v334;
  LOBYTE(v334) = *(_BYTE *)(v333 + 11);
  v330[47] = 3;
  v330[27] = 1 << v334;
  ptra = sub_2AB368(28 * ((_DWORD)v331 + 1));
  if ( !ptra )
  {
    sub_2F0164(v445);
    return v412;
  }
  v335 = sub_2AD048(SHIDWORD(v3), v423, *(unsigned __int8 *)(v439[98] + 5));
  v451 = v335;
  if ( !v335 )
    goto LABEL_852;
  v336 = *(_DWORD **)(*(_DWORD *)(HIDWORD(v3) + 160) + 520);
  v452[30] = v335;
  if ( !v336 || !*v336 )
  {
    v337 = ptra;
    v429 = 0;
    v417 = 0;
    *ptra = 0;
    ptra[1] = 0;
    goto LABEL_695;
  }
  v335 = (int)sub_2AD188(SHIDWORD(v3), v423, 4u);
  v429 = v335;
  if ( !v335 )
  {
LABEL_852:
    sub_2F0164(v445);
    free(ptra);
    return v412;
  }
  v336[1] = 18;
  v336[6] = 4 * v423;
  v336[9] = 4;
  v336[10] = 4;
  v337 = ptra;
  v336[12] = v335;
  v417 = 1;
  *ptra = 0;
  ptra[1] = 0;
LABEL_695:
  v337[2] = 0;
  *((_WORD *)v337 + 6) = 0;
  *((_BYTE *)v337 + 14) = 0;
  v337[4] = 0;
  v337[5] = 0;
  v337[6] = 0;
  v338 = (int (__fastcall *)(_DWORD))v439[17];
  if ( v338 )
  {
    v335 = v338(HIDWORD(v3));
    v339 = v335;
    if ( v335 )
      v339 = 1;
    v434 = v339;
  }
  else
  {
    v434 = 0;
  }
  if ( (int)compar <= 0 )
  {
    sub_2F0664(v445);
    if ( !compar )
      goto LABEL_867;
    goto LABEL_872;
  }
  v340 = *(_DWORD **)(HIDWORD(v3) + 120);
  LODWORD(v3) = ptra;
  v341 = 1;
  v454 = v4;
  v427 = HIDWORD(v3);
  while ( 2 )
  {
    v441 = v340;
    v352 = (_DWORD *)*v340++;
    v351 = v352;
    v346 = v352[2];
    v353 = v352[3];
    if ( !v434 && (v353 & 0x102) == 0x100 )
    {
      HIDWORD(v3) = -1;
    }
    else
    {
      v335 = sub_2F0184(v445, v351[1], 0);
      HIDWORD(v3) = v335;
      if ( v335 == -1 )
        goto LABEL_852;
      v351 = (_DWORD *)*(v340 - 1);
    }
    v350 = (_DWORD *)*v351;
    if ( *v351 )
    {
      if ( *(_DWORD *)(v350[1] + 4) == 5 )
      {
        if ( v350[40] )
          v350 = v351;
        else
          v350 = 0;
      }
      else
      {
        v350 = 0;
      }
    }
    v343 = (_DWORD *)v351[4];
    if ( (v353 & 0x100) == 0 && (v343[5] & 0x1000) != 0 )
    {
      if ( !v350 || (v342 = v350[6]) == 0 )
      {
        if ( v346 <= 0xF )
        {
          v342 = 1 << sub_2ABAF4(v346);
          v343 = *(_DWORD **)(*(v340 - 1) + 16);
        }
        else
        {
          v342 = 16;
        }
      }
      v344 = v343[35];
      if ( v344 && (v345 = *(_DWORD *)(v344 + 92)) != 0 )
      {
        ne = v346;
        v346 = v342;
      }
      else
      {
        v440 = v342;
        v345 = sub_2CD260(v427, (int)v343);
        ne = v346;
        v343 = *(_DWORD **)(*(v340 - 1) + 16);
        v346 = v440;
      }
      goto LABEL_711;
    }
    v354 = v343[15];
    v355 = v354 == 0;
    if ( v354 )
      v335 = v343[14];
    else
      v354 = (int)v343;
    if ( !v355 )
      v346 += v335;
    if ( (v400 & 0x42) != 0 )
      v346 += *(_DWORD *)(v354 + 28);
    if ( v350 )
    {
      ne = v350[7];
      if ( (char **)v354 == &off_470950 )
      {
        v345 = v350[10];
        if ( v345 )
        {
          switch ( v345 )
          {
            case -192:
              v345 = *(_DWORD *)(*(_DWORD *)(v427 + 160) + 2320);
              break;
            case -191:
              v345 = *(_DWORD *)(*(_DWORD *)(v427 + 160) + 2324);
              break;
            case -190:
              v345 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v427 + 160) + 2348) + 48);
              break;
            case -189:
              v345 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v427 + 160) + 2348) + 44);
              break;
            case -188:
              v374 = *(_DWORD *)(*(_DWORD *)(v427 + 160) + 520);
              if ( v374 )
                v345 = *(_DWORD *)(v374 + 56);
              break;
            default:
              v345 = -15;
              break;
          }
          goto LABEL_711;
        }
      }
    }
    else
    {
      ne = 0;
    }
    v356 = *(_DWORD *)(v354 + 140);
    if ( !v356 || (v345 = *(_DWORD *)(v356 + 92)) == 0 )
    {
      v447 = v354;
      v357 = sub_2CD260(v427, v354);
      v354 = v447;
      v345 = v357;
    }
    if ( v345 == -257 )
    {
      v448 = (_DWORD *)v354;
      v375 = sub_2AD7AC(v427, *(const char **)v354);
      v376 = (int)v375;
      v377 = v448;
      if ( !v375 )
        goto LABEL_849;
      v378 = *((_DWORD *)v375 + 35);
      if ( !v378 || (v345 = *(_DWORD *)(v378 + 92)) == 0 )
      {
        v379 = sub_2CD260(v427, v376);
        v377 = v448;
        v345 = v379;
      }
      if ( v345 == -257 )
      {
LABEL_849:
        v381 = *(const char **)(*v441 + 4);
        if ( !v381 )
          v381 = "<Local sym>";
        sub_2A6A5C("Unable to find equivalent output section for symbol '%s' from section '%s'", v381, *v377);
        ((void (__fastcall *)(int))loc_2A6C48)(5);
        goto LABEL_852;
      }
      v343 = *(_DWORD **)(*(v340 - 1) + 16);
    }
    else
    {
      v343 = *(_DWORD **)(*(v340 - 1) + 16);
    }
LABEL_711:
    if ( (v353 & 0x40000) != 0 )
    {
      v335 = 6;
    }
    else if ( (v353 & 0x400000) != 0 )
    {
      v335 = 10;
    }
    else if ( (v353 & 8) != 0 )
    {
      v335 = 2;
    }
    else if ( (v353 & 0x10000) != 0 )
    {
      v335 = 1;
    }
    else if ( (v353 & 0x80000) != 0 )
    {
      v335 = 8;
    }
    else if ( (v353 & 0x100000) != 0 )
    {
      v335 = 9;
    }
    else
    {
      v335 = 0;
    }
    if ( (v343[5] & 0x400) != 0 )
      v335 = 6;
    if ( v350 )
    {
      v347 = (int (__fastcall *)(_DWORD *, int))v439[15];
      if ( v347 )
        v335 = v347(v350 + 6, v335);
    }
    if ( (v353 & 0x100) != 0 )
    {
      if ( (v353 & 2) != 0 )
        v348 = 19;
      else
        v348 = 3;
    }
    else
    {
      v358 = *(_DWORD *)(*(v340 - 1) + 16);
      if ( (*(_DWORD *)(v358 + 20) & 0x1000) != 0 )
      {
        if ( v335 == 6 )
        {
          v348 = 22;
        }
        else if ( ((*(_DWORD *)(v427 + 40) >> 5) & 0x40000) != 0 )
        {
          if ( ((*(_DWORD *)(v427 + 40) >> 5) & 0x80000) != 0 )
            v348 = 21;
          else
            v348 = 17;
        }
        else if ( (v353 & 0x40) != 0 )
        {
          v348 = 21;
        }
        else
        {
          v348 = 17;
        }
      }
      else if ( (char **)v358 == &off_4708A8 )
      {
        v335 &= 0xFu;
        if ( (v353 & 0x80) != 0 )
          v380 = 32;
        else
          v380 = 16;
        v348 = v380 + v335;
      }
      else if ( (v353 & 0x4000) != 0 )
      {
        v348 = 4;
      }
      else
      {
        if ( (v353 & 1) != 0 )
        {
          LOBYTE(v368) = 0;
        }
        else if ( (v353 & 0x800000) != 0 )
        {
          LOBYTE(v368) = 10;
        }
        else if ( (v353 & 0x80) != 0 )
        {
          LOBYTE(v368) = 2;
        }
        else
        {
          v368 = (v353 >> 1) & 1;
        }
        v348 = (v335 & 0xF) + 16 * v368;
      }
    }
    if ( v350 )
      v349 = *((_BYTE *)v350 + 37);
    else
      v349 = 0;
    if ( v350 )
      LOBYTE(v350) = *((_BYTE *)v350 + 38);
    LODWORD(v3) = v3 + 28;
    *(_BYTE *)(v3 + 12) = v348;
    *(_DWORD *)(v3 + 20) = v341++;
    *(_DWORD *)(v3 + 24) = v417;
    if ( v429 )
      ++v417;
    *(_DWORD *)v3 = v346;
    *(_DWORD *)(v3 + 4) = ne;
    *(_DWORD *)(v3 + 8) = HIDWORD(v3);
    *(_BYTE *)(v3 + 13) = v349;
    *(_BYTE *)(v3 + 14) = (_BYTE)v350;
    *(_DWORD *)(v3 + 16) = v345;
    if ( v341 != v423 )
      continue;
    break;
  }
  v4 = v454;
  HIDWORD(v3) = v427;
  sub_2F0664(v445);
LABEL_867:
  v388 = ptra;
  v389 = 0;
  v2 = v429;
  do
  {
    if ( v388[2] == -1 )
      v388[2] = 0;
    else
      v388[2] = sub_2F04E0(v445);
    v390 = v388;
    v391 = v388[5];
    v392 = v388[6];
    ++v389;
    v388 += 7;
    (*(void (__fastcall **)(_DWORD, _DWORD *, int, int))(v439[98] + 36))(
      HIDWORD(v3),
      v390,
      v451 + v391 * *(unsigned __int8 *)(v439[98] + 5),
      v429 + 4 * v392);
  }
  while ( (int)compar >= v389 );
LABEL_872:
  free(ptra);
  v393 = sub_2F04CC(v445);
  v394 = v439[115];
  v452[47] = 3;
  v452[52] = v393;
  v452[48] = v394;
  ptr = 1;
  v452[49] = 0;
  v452[56] = 0;
  v452[53] = 0;
  v452[54] = 0;
  v452[55] = 1;
LABEL_480:
  v456 = 0;
  sub_2ADCFC(SHIDWORD(v3), (int (__fastcall *)(int, int, int))sub_2CC3D4, (int)&v456);
  if ( v456 )
    return 0;
  v400 = (*(_DWORD *)(HIDWORD(v3) + 40) >> 5) & 0xFFFFF;
LABEL_185:
  v106 = 1;
  v40 = *(_DWORD **)(HIDWORD(v3) + 160);
  v40[34] = *(_DWORD *)(v4 + 460);
  v40[33] = 3;
  v446 = v40;
  v40[35] = 0;
  v40[42] = 0;
  v40[39] = 0;
  v40[40] = 0;
  v40[41] = 1;
  if ( (v400 & 0x42) != 0 || (*(_BYTE *)(HIDWORD(v3) + 40) & 7) == 3 )
  {
    v428 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 4) + 444);
    if ( !a2 )
    {
      if ( !sub_2D08B0((_DWORD *)HIDWORD(v3), 0) )
        return 0;
      v40 = *(_DWORD **)(HIDWORD(v3) + 160);
    }
    v123 = v40[587];
    v124 = *(unsigned __int8 **)(v428 + 392);
    v125 = *(_DWORD *)v123;
    v126 = v124[1];
    if ( *(_DWORD *)v123 )
    {
      v127 = 0;
      v128 = 0;
      do
      {
        v129 = *(_DWORD *)(v125 + 28);
        ++v128;
        v125 = *(_DWORD *)v125;
        if ( v129 )
          v127 = v129;
      }
      while ( v125 );
      v442 = v128;
      v125 = v126 * v128;
      if ( v128 )
      {
        v130 = *v124;
        v40[11] = v126;
        v40[5] = v130;
LABEL_227:
        v131 = *(_DWORD *)(v123 + 28);
        v40[12] = v442;
        if ( v131 == -1 )
        {
          *(_DWORD *)(v123 + 28) = v125;
        }
        else if ( v131 < v125 )
        {
          sub_2A6BBC("elf.c", 5259);
          v40 = *(_DWORD **)(HIDWORD(v3) + 160);
          v123 = v40[587];
          v124 = *(unsigned __int8 **)(v428 + 392);
        }
        if ( v442 )
        {
          v132 = *(_DWORD *)(v123 + 28);
          v133 = v124[1];
          if ( (unsigned __int64)sub_347674(v132, v133) >> 32 )
          {
            sub_2A6BBC("elf.c", 5277);
            v132 = *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 160) + 2348) + 28);
            v133 = *(unsigned __int8 *)(*(_DWORD *)(v428 + 392) + 1);
          }
          v134 = sub_347418(v132, v133);
          v135 = (char *)sub_2AD188(SHIDWORD(v3), v134, 0x20u);
          v40 = *(_DWORD **)(HIDWORD(v3) + 160);
          v40[17] = v135;
          if ( !v135 )
            return 0;
          if ( (*(_DWORD *)(HIDWORD(v3) + 40) & 0x2000) != 0 )
            v136 = v428;
          else
            v136 = 1;
          if ( (*(_DWORD *)(HIDWORD(v3) + 40) & 0x2000) != 0 )
            v136 = *(_DWORD *)(v136 + 16);
          v453 = v136;
          v137 = *(unsigned __int8 **)(v428 + 392);
          v138 = *v137;
          v139 = v137[1];
          v140 = v138 + (unsigned int)(v442 * v139);
          v141 = v138 + v442 * v139;
          if ( (unsigned int)v140 > v127 )
            v141 = 0;
          nb = v140;
          if ( (unsigned int)v140 <= v127 )
          {
            v455 = v127 - v141;
            nb = v140 + v127 - v141;
          }
          else
          {
            v455 = v141;
          }
          if ( *(_DWORD *)v40[587] )
          {
            LODWORD(v3) = v135 + 32;
            v142 = *(int **)v40[587];
            v424 = 0;
            v450 = 0;
            v419 = HIDWORD(v3);
            while ( 1 )
            {
              HIDWORD(v3) = v142[9];
              if ( HIDWORD(v3) > 1 )
              {
                if ( *(_WORD *)(*(_DWORD *)(v419 + 160) + 36) == 4 )
                {
                  v143 = v142[1];
                  if ( v143 == 4 )
                  {
                    *(_DWORD *)(v3 - 32) = 4;
                    v199 = v142[2];
                    *(_DWORD *)(v3 - 28) = v199;
                    v145 = *((_BYTE *)v142 + 32);
                    v414 = v199;
                    v402 = v145 & 2;
                    goto LABEL_375;
                  }
                }
                qsort(v142 + 10, v142[9], 4u, (__compar_fn_t)sub_2CBB8C);
                v143 = v142[1];
                HIDWORD(v3) = v142[9];
              }
              else
              {
                v143 = v142[1];
              }
              *(_DWORD *)(v3 - 32) = v143;
              v144 = v142[2];
              *(_DWORD *)(v3 - 28) = v144;
              v145 = *((_BYTE *)v142 + 32);
              v414 = v144;
              v402 = v145 & 2;
              if ( !HIDWORD(v3) )
              {
                *(_DWORD *)(v3 - 20) = 0;
                if ( (v145 & 2) == 0 )
                {
                  *(_DWORD *)(v3 - 16) = 0;
                  goto LABEL_256;
                }
LABEL_255:
                *(_DWORD *)(v3 - 16) = v142[3];
                goto LABEL_256;
              }
LABEL_375:
              v200 = v142[10];
              v201 = v142[4];
              *(_DWORD *)(v3 - 20) = *(_DWORD *)(v200 + 28) - v201;
              if ( v402 )
                goto LABEL_255;
              *(_DWORD *)(v3 - 16) = *(_DWORD *)(v200 + 32) - v201;
LABEL_256:
              if ( v143 != 1 )
              {
                if ( (v145 & 4) != 0 )
                {
                  *(_DWORD *)(v3 - 4) = v142[5];
                }
                else
                {
                  if ( !HIDWORD(v3) )
                  {
                    v149 = 0;
                    v435 = 0;
                    *(_DWORD *)(v3 - 4) = 1 << *(_BYTE *)(*(_DWORD *)(v428 + 392) + 11);
                    goto LABEL_265;
                  }
                  *(_DWORD *)(v3 - 4) = 0;
                }
                if ( v143 == 2 )
                {
                  if ( HIDWORD(v3) <= 1 )
                  {
LABEL_670:
                    v149 = 0;
                  }
                  else
                  {
                    v149 = strcmp(*(const char **)v142[10], ".dynamic");
                    if ( v149 )
                    {
                      sub_2A6A5C("%B: The first section in the PT_DYNAMIC segment is not the .dynamic section", v419);
                      ((void (__fastcall *)(int))loc_2A6C48)(17);
                      return v412;
                    }
                  }
                  v435 = 0;
                  goto LABEL_265;
                }
                if ( v143 != 4 )
                  goto LABEL_670;
                if ( HIDWORD(v3) )
                {
                  v146 = v142 + 9;
                  v147 = 0;
                  do
                  {
                    v148 = v146[1];
                    ++v146;
                    ++v147;
                    *(_DWORD *)(*(_DWORD *)(v148 + 140) + 4) = 7;
                  }
                  while ( v147 != HIDWORD(v3) );
                  v149 = 0;
                  v435 = 0;
                  goto LABEL_265;
                }
LABEL_385:
                v149 = HIDWORD(v3);
                v435 = HIDWORD(v3);
                goto LABEL_265;
              }
              if ( (*(_DWORD *)(v419 + 40) & 0x2000) != 0 )
              {
                if ( (v145 & 4) != 0 )
                  v453 = v142[5];
                *(_DWORD *)(v3 - 4) = v453;
                ++v450;
                if ( !HIDWORD(v3) )
                  goto LABEL_385;
                if ( (v145 & 4) == 0 )
                {
                  v317 = v142 + 10;
LABEL_656:
                  v318 = 0;
                  v319 = 0;
                  do
                  {
                    v320 = *v317++;
                    ++v318;
                    v321 = *(_DWORD *)(v320 + 64);
                    if ( v319 < v321 )
                      v319 = v321;
                  }
                  while ( v318 < HIDWORD(v3) );
                  v322 = 1 << v319;
                  if ( v322 < v453 )
                    v322 = v453;
                  v437 = v322;
                  goto LABEL_529;
                }
              }
              else
              {
                if ( (v145 & 4) == 0 )
                {
                  if ( !HIDWORD(v3) )
                  {
                    v149 = 0;
                    v435 = 0;
                    *(_DWORD *)(v3 - 4) = 1 << *(_BYTE *)(*(_DWORD *)(v428 + 392) + 11);
                    goto LABEL_265;
                  }
                  *(_DWORD *)(v3 - 4) = 0;
                  v317 = v142 + 10;
                  goto LABEL_656;
                }
                *(_DWORD *)(v3 - 4) = v142[5];
                if ( !HIDWORD(v3) )
                  goto LABEL_385;
              }
              v437 = *(_DWORD *)(v3 - 4);
LABEL_529:
              v258 = v142 + 9;
              v259 = 0;
              do
              {
                v261 = v258[1];
                ++v258;
                v260 = v261;
                ++v259;
                if ( (*(_DWORD *)(v261 + 20) & 0x102) == 0 )
                  *(_DWORD *)(*(_DWORD *)(v260 + 140) + 4) = 8;
              }
              while ( v259 != HIDWORD(v3) );
              if ( *(_DWORD *)(*(_DWORD *)(v142[10] + 140) + 4) == 8 )
              {
                v262 = v142 + 10;
                v263 = 0;
                do
                {
                  if ( v259 == ++v263 )
                  {
                    v149 = 1;
                    goto LABEL_538;
                  }
                  v264 = v262[1];
                  ++v262;
                }
                while ( *(_DWORD *)(*(_DWORD *)(v264 + 140) + 4) == 8 );
                v149 = 0;
              }
              else
              {
                v149 = 0;
              }
LABEL_538:
              if ( v437 )
              {
                sub_347F74(
                  *(_DWORD *)(v3 - 20) - nb,
                  ((unsigned __int64)*(unsigned int *)(v3 - 20) - nb) >> 32,
                  v437,
                  0);
                v437 = v265;
              }
              else
              {
                v265 = 0;
              }
              if ( v450 > 1
                && *(unsigned __int8 *)(v428 + 466) >> 7
                && ((v453 - 1) & (unsigned int)nb) != 0
                && (((v265 + (_DWORD)nb) ^ (unsigned int)nb) & -v453) == 0 )
              {
                v437 += v453;
              }
              nb += v437;
              if ( v149 )
                v266 = v437;
              else
                v266 = 0;
              v435 = v266;
LABEL_265:
              v150 = v145 & 0x10;
              v151 = 0;
              *(_DWORD *)(v3 - 24) = 0;
              *(_DWORD *)(v3 - 12) = 0;
              *(_DWORD *)(v3 - 8) = 0;
              if ( (v145 & 0x10) != 0 )
              {
                if ( (v145 & 1) == 0 )
                  *(_DWORD *)(v3 - 28) = v414 | 4;
                v151 = **(unsigned __int8 **)(v428 + 392);
                *(_DWORD *)(v3 - 12) = v151;
                *(_DWORD *)(v3 - 8) = v151;
                if ( HIDWORD(v3) )
                {
                  v152 = *(_DWORD *)(v3 - 20);
                  if ( v152 < (unsigned int)nb )
                    goto LABEL_844;
                  if ( v402 )
                  {
                    v151 = v152 - nb;
                    *(_DWORD *)(v3 - 20) = v151;
                  }
                  else
                  {
                    v153 = *(_DWORD *)(v3 - 16);
                    if ( (unsigned int)nb > v153 )
                    {
LABEL_844:
                      sub_2A6A5C("%B: Not enough room for program headers, try linking with -N", v419, v150);
                      ((void (__fastcall *)(int))loc_2A6C48)(17);
                      return v412;
                    }
                    v151 = v152 - nb;
                    *(_DWORD *)(v3 - 20) = v151;
                    *(_DWORD *)(v3 - 16) = v153 - nb;
                  }
                }
              }
              if ( (v145 & 0x20) == 0 )
                goto LABEL_285;
              if ( (v145 & 1) == 0 )
                v151 = *(_DWORD *)(v3 - 28);
              v154 = *(_DWORD *)(v3 - 8);
              if ( (v145 & 1) == 0 )
                *(_DWORD *)(v3 - 28) = v151 | 4;
              v99 = v150 == 0;
              v155 = *(unsigned __int8 **)(v428 + 392);
              v156 = v442 * v155[1];
              LODWORD(v157) = v156 + *(_DWORD *)(v3 - 12);
              HIDWORD(v157) = v156 + v154;
              if ( v99 )
              {
                v158 = *v155;
                *(_DWORD *)(v3 - 24) = v158;
                if ( HIDWORD(v3) )
                {
                  v159 = v158 - nb;
                  *(_DWORD *)(v3 - 20) += v159;
                  if ( !v402 )
                    *(_DWORD *)(v3 - 16) += v159;
LABEL_283:
                  LODWORD(v157) = v455 + v157;
                  HIDWORD(v157) += v455;
                }
                *(_QWORD *)(v3 - 12) = v157;
                goto LABEL_285;
              }
              *(_QWORD *)(v3 - 12) = v157;
              if ( HIDWORD(v3) )
                goto LABEL_283;
LABEL_285:
              if ( v143 == 1 || v143 == 4 && (*(_BYTE *)(v419 + 40) & 7) == 3 )
              {
                if ( (v145 & 0x30) != 0 )
                {
                  v250 = nb - (*(_DWORD *)(v3 - 12) + *(_DWORD *)(v3 - 24));
                  if ( !v149 )
                    *(_DWORD *)(v3 - 12) = nb - *(_DWORD *)(v3 - 24);
                  *(_DWORD *)(v3 - 8) += v250;
                }
                else
                {
                  *(_DWORD *)(v3 - 24) = nb;
                }
              }
              v160 = *(_DWORD *)(v3 - 32);
              if ( HIDWORD(v3) )
              {
                v161 = 0;
                v403 = v142 + 9;
                while ( 1 )
                {
                  v164 = v160 == 7;
                  if ( v160 != 7 )
                    v164 = v160 == 1;
                  v165 = v403[1];
                  ++v403;
                  v166 = *(_DWORD *)(v165 + 140);
                  v167 = 1 << *(_DWORD *)(v165 + 64);
                  if ( v164 )
                  {
                    v168 = *(_DWORD *)(v166 + 4);
                    if ( v168 != 8
                      || (v195 = *(_DWORD *)(v166 + 8), (v195 & 2) != 0) && (v160 == 7) | ((v195 ^ 0x400u) >> 10) & 1 )
                    {
                      v169 = *(_DWORD *)(v3 - 8);
                      v170 = *(_DWORD *)(v3 - 16);
                      v171 = *(_DWORD *)(v165 + 32);
                      v115 = __CFADD__(v170, v169);
                      v172 = v170 + v169;
                      v173 = v115;
                      HIDWORD(v3) = v171 - v172;
                      if ( v171 != v172 )
                      {
                        if ( v172 > v171 )
                          v173 = 1;
                        if ( v173 )
                        {
                          HIDWORD(v3) = 0;
                          sub_2A6A5C("%B: section %A lma %#Lx adjusted to %#Lx", v419, v165);
                          *(_DWORD *)(v165 + 32) = v172;
                          v168 = *(_DWORD *)(v166 + 4);
                          v169 = *(_DWORD *)(v3 - 8);
                        }
                      }
                      v174 = HIDWORD(v3) + v169;
                      *(_DWORD *)(v3 - 8) = HIDWORD(v3) + v169;
                      if ( v168 == 8 )
                      {
                        v160 = *(_DWORD *)(v3 - 32);
                        HIDWORD(v3) = v142[9];
                      }
                      else
                      {
                        v175 = HIDWORD(v3) + *(_DWORD *)(v3 - 12);
                        if ( v174 > v175 )
                        {
                          v430 = *(_DWORD *)(v3 - 12);
                          if ( sub_2A8A04(v419, nb, 0) )
                            return 0;
                          HIDWORD(v3) = v174 - v430;
                          v197 = sub_2AB4EC(v174 - v430);
                          v198 = v197;
                          if ( !v197 )
                            return 0;
                          v431 = sub_2A8884((int)v197, SHIDWORD(v3), v419);
                          free(v198);
                          if ( HIDWORD(v3) != v431 )
                            return 0;
                          v175 = HIDWORD(v3) + *(_DWORD *)(v3 - 12);
                        }
                        v160 = *(_DWORD *)(v3 - 32);
                        v176 = nb + HIDWORD(v3);
                        HIDWORD(v3) = v142[9];
                        nb = v176;
                        *(_DWORD *)(v3 - 12) = v175;
                      }
                    }
                  }
                  if ( v160 != 4 )
                    break;
                  if ( (*(_BYTE *)(v419 + 40) & 7) != 3 )
                  {
                    v178 = *(_DWORD *)(v166 + 8);
                    if ( *(_DWORD *)(v166 + 4) != 8 )
                    {
                      v179 = *(_DWORD *)(v166 + 24);
                      goto LABEL_312;
                    }
LABEL_348:
                    v193 = v178 & 0x400;
                    if ( (v178 & 0x400) != 0 && !*(_QWORD *)(v166 + 16) )
                    {
                      if ( v167 )
                        v194 = ((*(_DWORD *)(v166 + 12) - (_DWORD)nb) & (v167 - 1)) + nb;
                      else
                        v194 = nb;
                      *(_QWORD *)(v165 + 80) = v194;
                      *(_QWORD *)(v166 + 16) = v194;
                    }
                    if ( (v178 & 2) != 0 )
                    {
                      if ( v160 != 7 )
                        goto LABEL_355;
                      goto LABEL_356;
                    }
LABEL_314:
                    v180 = *((_BYTE *)v142 + 32);
                    if ( v167 > *(_DWORD *)(v3 - 4)
                      && (v142[8] & 4) == 0
                      && (v160 != 1 || (*(_DWORD *)(v419 + 40) & 0x2000) == 0) )
                    {
                      *(_DWORD *)(v3 - 4) = v167;
                    }
                    goto LABEL_318;
                  }
                  if ( v161 )
                  {
                    *(_DWORD *)(v165 + 36) = 0;
                    *(_QWORD *)(v165 + 80) = 0;
                    *(_DWORD *)(v165 + 20) = 0;
                    goto LABEL_293;
                  }
                  v196 = *(_DWORD *)(v166 + 24);
                  *(_QWORD *)(v165 + 80) = nb;
                  *(_QWORD *)(v166 + 16) = nb;
                  *(_DWORD *)(v3 - 12) = v196;
                  *(_DWORD *)(v3 - 4) = 1;
                  *(_DWORD *)(v3 - 8) = 0;
                  nb += v196;
                  v180 = *((_BYTE *)v142 + 32);
LABEL_318:
                  if ( (v180 & 1) != 0 )
                    goto LABEL_319;
                  v162 = *(_DWORD *)(v3 - 28);
                  *(_DWORD *)(v3 - 28) = v162 | 4;
                  v163 = *(_DWORD *)(v166 + 8);
                  if ( (v163 & 4) != 0 )
                    *(_DWORD *)(v3 - 28) = v162 | 5;
                  if ( (v163 & 1) == 0 )
                  {
LABEL_319:
                    ++v161;
                    v160 = *(_DWORD *)(v3 - 32);
                    if ( v161 >= HIDWORD(v3) )
                      goto LABEL_320;
                  }
                  else
                  {
                    v160 = *(_DWORD *)(v3 - 32);
                    *(_DWORD *)(v3 - 28) |= 2u;
LABEL_293:
                    if ( ++v161 >= HIDWORD(v3) )
                      goto LABEL_320;
                  }
                }
                v177 = *(_DWORD *)(v166 + 4);
                v178 = *(_DWORD *)(v166 + 8);
                if ( v160 == 1 )
                {
                  *(_QWORD *)(v165 + 80) = nb;
                  *(_QWORD *)(v166 + 16) = nb;
                  if ( v177 != 8 )
                  {
                    v179 = *(_DWORD *)(v166 + 24);
                    nb += v179;
                    goto LABEL_312;
                  }
                  if ( (v178 & 2) != 0 )
                  {
                    v193 = v178 & 0x400;
LABEL_355:
                    if ( !v193 )
LABEL_356:
                      *(_DWORD *)(v3 - 8) += *(_DWORD *)(v166 + 24);
                  }
                }
                else
                {
                  if ( v177 == 8 )
                    goto LABEL_348;
                  v179 = *(_DWORD *)(v166 + 24);
LABEL_312:
                  *(_DWORD *)(v3 - 12) += v179;
                  if ( (v178 & 2) != 0 )
                    *(_DWORD *)(v3 - 8) += v179;
                }
                goto LABEL_314;
              }
LABEL_320:
              nb -= v435;
              if ( v160 == 1 && (*(_BYTE *)(v419 + 40) & 7) != 3 )
              {
                if ( HIDWORD(v3) <= 1 )
                {
                  v432 = 1;
                }
                else
                {
                  v202 = v142 + 10;
                  v203 = 1;
                  do
                  {
                    v204 = v202[1];
                    v206 = *v202++;
                    v205 = v206;
                    if ( *(_DWORD *)(v204 + 28) == *(_DWORD *)(v206 + 28) )
                    {
                      v207 = *(_DWORD **)(v204 + 140);
                      if ( (v207[2] & 0x400) == 0 || v207[1] != 8 )
                      {
                        if ( v207[6] )
                        {
                          v208 = *(_DWORD **)(v205 + 140);
                          if ( (v208[2] & 0x400) == 0 || v208[1] != 8 )
                          {
                            if ( v208[6] )
                            {
                              v432 = 0;
                              goto LABEL_400;
                            }
                          }
                        }
                      }
                    }
                    ++v203;
                  }
                  while ( v203 != HIDWORD(v3) );
                  v432 = 1;
                }
LABEL_400:
                if ( HIDWORD(v3) )
                {
                  v209 = 0;
                  while ( 1 )
                  {
                    v210 = *(_DWORD *)(v142[v209 + 10] + 140);
                    v211 = *(_DWORD *)(v210 + 8);
                    v212 = v211 & 0x400;
                    if ( (v211 & 0x400) != 0 )
                    {
                      v218 = v160 == 7;
                      if ( v160 != 7 )
                        v218 = v160 == 1685382482;
                      v219 = !v218;
                      if ( v160 == 1 )
                        v220 = 0;
                      else
                        v220 = v219 & 1;
                      if ( v220 )
                      {
LABEL_427:
                        v404 = *(_DWORD *)(v210 + 4);
                        goto LABEL_428;
                      }
                    }
                    else if ( (unsigned int)(v160 - 6) <= 1 )
                    {
                      goto LABEL_404;
                    }
                    v221 = v211 & 2;
                    if ( v221 )
                      break;
                    v222 = (unsigned int)(v160 - 1685382480) > 2;
                    if ( (unsigned int)(v160 - 1685382480) > 2 )
                      v222 = (unsigned int)(v160 - 1) > 1;
                    if ( !v222 )
                      goto LABEL_426;
                    v223 = 0;
                    v404 = *(_DWORD *)(v210 + 4);
                    v436 = v404;
                    if ( v404 != 8 )
                      goto LABEL_483;
LABEL_488:
                    if ( v160 != 2 || *(_DWORD *)(v210 + 24) || !*(_DWORD *)(v3 - 8) )
                      goto LABEL_409;
                    if ( v436 != 8 )
                    {
                      v246 = *(_QWORD *)(v210 + 16);
                      v247 = *(_DWORD *)(v3 - 24);
                      if ( v247 >= (unsigned int)v246 || v246 - v247 >= *(unsigned int *)(v3 - 12) )
                        goto LABEL_404;
                    }
                    if ( !v223 )
                      goto LABEL_409;
                    v248 = *(_DWORD *)(v210 + 12);
                    v249 = *(_DWORD *)(v3 - 20);
                    if ( v248 > v249 && *(_DWORD *)(v3 - 8) > v248 - v249 )
                      goto LABEL_409;
LABEL_426:
                    if ( v212 )
                      goto LABEL_427;
LABEL_404:
                    sub_2A6A5C("%B: section `%A' can't be allocated in segment %d", v419);
                    v214 = sub_2CBA84(v142[1]);
                    if ( !v214 )
                    {
                      if ( (unsigned int)(v213 - 1879048192) <= 0xFFFFFFF )
                      {
                        v214 = s;
                        sprintf(s, "LOPROC+%7.7x", v213 - 1879048192);
                      }
                      else
                      {
                        v214 = s;
                        if ( (unsigned int)(v213 - 1610612736) > 0xFFFFFFF )
                          snprintf(s, 0x20u, "%8.8x", v213);
                        else
                          sprintf(s, "LOOS+%7.7x", v213 - 1610612736);
                      }
                    }
                    fflush((FILE *)stdout);
                    fprintf((FILE *)stderr, (const char *)&off_41A5C0, v214);
                    if ( v142[9] )
                    {
                      v215 = v142 + 9;
                      v216 = 0;
                      do
                      {
                        v217 = (const char **)v215[1];
                        ++v215;
                        ++v216;
                        fprintf((FILE *)stderr, " %s", *v217);
                      }
                      while ( v216 < v142[9] );
                    }
                    IO_putc(10, (_IO_FILE *)stderr);
                    fflush((FILE *)stderr);
                    HIDWORD(v3) = v142[9];
LABEL_409:
                    if ( (unsigned int)++v209 >= HIDWORD(v3) )
                      goto LABEL_321;
                    v160 = *(_DWORD *)(v3 - 32);
                  }
                  v404 = *(_DWORD *)(v210 + 4);
                  v436 = v404;
                  if ( v404 != 8 )
                  {
LABEL_483:
                    v243 = *(_QWORD *)(v210 + 16);
                    v244 = *(_DWORD *)(v3 - 24);
                    if ( v244 > (unsigned int)v243
                      || *(unsigned int *)(v3 - 12) < v243 - v244 + *(unsigned int *)(v210 + 24) )
                    {
                      goto LABEL_404;
                    }
                  }
                  v223 = v221;
                  if ( v221 )
                    v223 = 1;
                  v245 = v223 & v432;
                  if ( (v223 & v432) != 0 )
                  {
                    v369 = *(_DWORD *)(v210 + 12);
                    v370 = *(_DWORD *)(v3 - 20);
                    if ( v369 < v370 )
                      goto LABEL_426;
                    v371 = v369 - v370;
                    v372 = *(_DWORD *)(v3 - 8);
                    v223 = v404 != 8;
                    if ( !v212 )
                      v223 = 1;
                    if ( v223 )
                    {
                      if ( v371 + *(_DWORD *)(v210 + 24) > v372 )
                        goto LABEL_426;
                    }
                    else
                    {
                      if ( v160 == 7 )
                      {
                        if ( v371 + *(_DWORD *)(v210 + 24) <= v372 )
                          goto LABEL_409;
LABEL_428:
                        if ( v404 == 8 && v160 != 7 )
                          goto LABEL_409;
                        goto LABEL_404;
                      }
                      if ( v371 > v372 )
                        goto LABEL_409;
                      v223 = v245;
                      v436 = 8;
                    }
                  }
                  goto LABEL_488;
                }
              }
LABEL_321:
              v142 = (int *)*v142;
              LODWORD(v3) = v3 + 32;
              ++v424;
              if ( !v142 )
              {
                HIDWORD(v3) = v419;
                v40 = *(_DWORD **)(v419 + 160);
                break;
              }
            }
          }
          v123 = v40[587];
          *(_QWORD *)(v123 + 32) = nb;
        }
        else
        {
          nb = *v124;
          *(_QWORD *)(v123 + 32) = nb;
        }
        v181 = v40[16];
        v182 = (int *)(v181 + 4);
        v183 = v181 + 4 * v40[133];
        v420 = *(_DWORD *)(*(_DWORD *)(HIDWORD(v3) + 4) + 444);
        if ( v183 <= v181 + 4 )
          goto LABEL_590;
        v415 = HIDWORD(v3);
        v3 = nb;
        while ( 1 )
        {
          v191 = *v182++;
          v190 = v191;
          v188 = *(_DWORD *)(v191 + 44);
          if ( v188 )
          {
            v192 = *(_QWORD *)(v188 + 80);
            if ( v192 )
              goto LABEL_343;
            v184 = *(_DWORD *)(v190 + 4);
            v185 = v184;
            if ( v184 == 8 )
              break;
          }
          if ( (*(_DWORD *)(v190 + 8) & 2) != 0 )
          {
            if ( *(_DWORD *)(v190 + 24) )
            {
              if ( v188 )
                goto LABEL_330;
              v186 = "*unknown*";
              goto LABEL_331;
            }
            goto LABEL_549;
          }
          v185 = *(_DWORD *)(v190 + 4);
          v251 = v185 == 4;
          if ( v185 != 4 )
            v251 = v185 == 9;
          if ( v251 )
          {
            if ( !v188 )
              goto LABEL_525;
LABEL_509:
            if ( (*(_DWORD *)(v188 + 20) & 0x8000000) != 0 )
              goto LABEL_525;
            goto LABEL_510;
          }
          if ( v188 )
            goto LABEL_509;
LABEL_510:
          v252 = *(_DWORD **)(v415 + 160);
          if ( v190 == *(_DWORD *)(v181 + 4 * v252[580])
            || (v253 = v252[130]) != 0 && v190 == *(_DWORD *)(v181 + 4 * *(_DWORD *)(v253 + 56))
            || (v254 = v252[587], v190 == *(_DWORD *)(v181 + 4 * *(_DWORD *)(v254 + 48)))
            || v190 == *(_DWORD *)(v181 + 4 * *(_DWORD *)(v254 + 44)) )
          {
LABEL_525:
            *(_QWORD *)(v190 + 16) = -1;
            goto LABEL_340;
          }
          v255 = *(_DWORD *)(v190 + 36);
          if ( v255 > 1 )
          {
            HIDWORD(v3) = 0;
            v256 = v3 - 1 + v255;
            v257 = (unsigned int)v3 > v256;
            if ( (unsigned int)v3 > v256 )
              LODWORD(v3) = -1;
            else
              v255 = -v255;
            if ( !v257 )
              LODWORD(v3) = v255 & v256;
          }
          *(_QWORD *)(v190 + 16) = v3;
          if ( v188 )
            *(_QWORD *)(v188 + 80) = v3;
          if ( v185 == 8 )
            goto LABEL_340;
LABEL_339:
          v3 += *(unsigned int *)(v190 + 24);
LABEL_340:
          if ( v183 <= (unsigned int)v182 )
          {
            nb = v3;
            HIDWORD(v3) = v415;
            v40 = *(_DWORD **)(v415 + 160);
            v123 = v40[587];
LABEL_590:
            v284 = a2;
            v38 = *(_DWORD **)v123;
            if ( a2 )
              v284 = 1;
            v285 = **(unsigned __int8 **)(v420 + 392);
            LODWORD(v3) = v40[17];
            v421 = v285 + *(_DWORD *)(v420 + 16);
            if ( v38 )
            {
              v286 = 0;
              v287 = v3 + 32;
              v438 = 0;
              v288 = 0;
              v289 = 0;
              v290 = 0;
              v291 = v38;
              do
              {
                ++v286;
                if ( *(_DWORD *)(v287 - 32) == 1 )
                {
                  v292 = *((_BYTE *)v291 + 32);
                  v99 = (v292 & 0x10) == 0;
                  v293 = v292 & 0x20;
                  if ( v99 )
                  {
                    if ( v293 )
                    {
                      v421 = *(_DWORD *)(v287 - 20);
                      v438 = *(_DWORD *)(v287 - 16);
                    }
                  }
                  else
                  {
                    v290 = *(_DWORD *)(v287 - 20);
                    v289 = *(_DWORD *)(v287 - 16);
                    if ( v293 )
                    {
                      v288 = v291;
                      v421 = v285 + v290;
                      v438 = v285 + v289;
                    }
                  }
                }
                v291 = (_DWORD *)*v291;
                v287 += 32;
              }
              while ( v291 );
              v425 = v290;
              if ( !v288 )
                v284 = 0;
              v433 = v289;
              if ( !v284 )
              {
LABEL_606:
                v294 = v3 + 32 * v286;
                v405 = HIDWORD(v3);
                v39 = (int *)v3;
                while ( 1 )
                {
                  v295 = *v39;
                  if ( *v39 == 1685382482 )
                  {
                    if ( a2 )
                    {
                      v34 = (_DWORD *)v3;
                      v35 = **(_DWORD ***)(*(_DWORD *)(v405 + 160) + 2348);
                      if ( v35 )
                      {
                        while ( *v34 != 1
                             || v34[3] >= *(_DWORD *)(a2 + 124)
                             || !v35[9]
                             || *(_DWORD *)(v35[10] + 28) < *(_DWORD *)(a2 + 120) )
                        {
                          v35 = (_DWORD *)*v35;
                          v34 += 8;
                          if ( !v35 )
                            goto LABEL_622;
                        }
                      }
                      else
                      {
LABEL_622:
                        sub_2A6BBC("elf.c", 5867);
                      }
                      if ( v294 > (unsigned int)v34 )
                      {
                        v39[3] = v34[3];
                        v39[4] = v34[4];
                        v39[2] = v34[2];
                        v36 = *(_DWORD *)(a2 + 124) - v34[3];
                        v39[5] = v36;
                        v37 = *((_BYTE *)v38 + 32);
LABEL_53:
                        v39[6] = v36;
                        if ( (v37 & 4) == 0 )
                          v39[7] = 1;
                        if ( (v37 & 1) == 0 )
                          v39[1] = 4;
                        goto LABEL_57;
                      }
                    }
                    else if ( (unsigned int)v3 < v294 )
                    {
                      v306 = (_DWORD *)v3;
                      while ( *v306 != 1 || v306[4] != v39[4] )
                      {
                        v306 += 8;
                        if ( (unsigned int)v306 >= v294 )
                          goto LABEL_627;
                      }
                      if ( v294 > (unsigned int)v306 )
                      {
                        v39[3] = v306[3];
                        v39[2] = v306[2];
                        v37 = *((_BYTE *)v38 + 32);
                        if ( (v37 & 8) == 0 )
                          sub_2A6BF0((int)"elf.c", 5891, (int)"assign_file_positions_for_non_load_sections");
                        v36 = v38[6];
                        v39[5] = v36;
                        goto LABEL_53;
                      }
                    }
LABEL_627:
                    v39[1] = 0;
                    v39[2] = 0;
                    v39[3] = 0;
                    v39[4] = 0;
                    v39[5] = 0;
                    v39[6] = 0;
                    v39[7] = 0;
                    *v39 = 0;
                  }
                  else if ( v295 == 1685382481 )
                  {
                    if ( (v38[8] & 8) != 0 )
                      v39[6] = v38[6];
                  }
                  else
                  {
                    v296 = v38[9];
                    if ( v296 )
                    {
                      if ( v295 != 1 )
                      {
                        if ( v295 == 4 )
                        {
                          if ( (*(_BYTE *)(v405 + 40) & 7) != 3 )
                          {
LABEL_614:
                            if ( (v38[8] & 0x30) != 0 )
                            {
                              sub_2A6A5C(
                                "%B: error: non-load segment %d includes file header and/or program header",
                                v405,
                                (int)((int)v39 - v3) >> 5);
                              return v412;
                            }
                            v297 = v38[10];
                            v298 = &v38[v296];
                            v299 = v296 - 1;
                            v39[5] = v38[8] & 0x30;
                            v300 = v298 + 10;
                            v301 = *(_DWORD *)(v297 + 80);
                            v39[2] = v301;
                            while ( 1 )
                            {
                              v303 = *--v300;
                              v302 = v303;
                              v304 = *(_DWORD *)(v303 + 140);
                              if ( *(_DWORD *)(v304 + 4) != 8 )
                                break;
                              v115 = v299-- != 0;
                              if ( !v115 )
                                goto LABEL_57;
                            }
                            v39[5] = *(_DWORD *)(v304 + 24) - v301 + *(_DWORD *)(v302 + 80);
                          }
                        }
                        else
                        {
                          if ( v295 != 6 )
                            goto LABEL_614;
                          v38[9] = 0;
                        }
                      }
                    }
                    else
                    {
                      v305 = *((_BYTE *)v38 + 32);
                      if ( (v305 & 0x10) != 0 )
                      {
                        v39[3] = v425;
                        if ( (v305 & 2) == 0 )
                          v39[4] = v433;
                      }
                      else if ( (v38[8] & 0x20) != 0 )
                      {
                        v39[3] = v421;
                        if ( (v305 & 2) == 0 )
                          v39[4] = v438;
                      }
                    }
                  }
LABEL_57:
                  v38 = (_DWORD *)*v38;
                  v39 += 8;
                  if ( !v38 )
                  {
                    HIDWORD(v3) = v405;
                    goto LABEL_59;
                  }
                }
              }
              v359 = sub_2FC920(*(_DWORD *)(a2 + 28), "__ehdr_start", 0);
              v360 = *(_DWORD *)(HIDWORD(v3) + 160);
              if ( !v359 )
              {
                v38 = **(_DWORD ***)(v360 + 2348);
                goto LABEL_796;
              }
              v361 = *(unsigned __int8 *)(v359 + 12);
              v362 = *(_DWORD **)(v360 + 2348);
              v363 = v361 > 5;
              if ( v361 != 5 )
                v363 = v361 > 2;
              v38 = (_DWORD *)*v362;
              if ( !v363 )
              {
                if ( v288[9] )
                {
                  v364 = v288[10];
                  goto LABEL_854;
                }
                if ( v38 )
                {
                  v365 = (_DWORD *)*v362;
                  if ( v38[9] )
                  {
LABEL_853:
                    v364 = v365[10];
LABEL_854:
                    if ( v364 )
                    {
                      v382 = *(_DWORD *)(v364 + 28);
                      *(_DWORD *)(v359 + 20) = v364;
                      *(_DWORD *)(v359 + 24) = v425 - v382;
LABEL_795:
                      v366 = *(_BYTE *)(v359 + 51);
                      v367 = *(_BYTE *)(v359 + 52);
                      *(_BYTE *)(v359 + 12) = 3;
                      *(_BYTE *)(v359 + 51) = v366 | 2;
                      *(_BYTE *)(v359 + 52) = v367 & 0xFE;
                      goto LABEL_796;
                    }
                  }
                  else
                  {
                    while ( 1 )
                    {
                      v365 = (_DWORD *)*v365;
                      if ( !v365 )
                        break;
                      if ( v365[9] )
                        goto LABEL_853;
                    }
                  }
                }
                *(_DWORD *)(v359 + 20) = &off_470950;
                *(_DWORD *)(v359 + 24) = v425;
                goto LABEL_795;
              }
LABEL_796:
              if ( v38 )
                goto LABEL_606;
LABEL_59:
              v40 = *(_DWORD **)(HIDWORD(v3) + 160);
            }
            v41 = *(int (__fastcall **)(_DWORD, int))(v428 + 176);
            *(_QWORD *)(v40[587] + 32) = nb;
            if ( v41 )
            {
              if ( !v41(HIDWORD(v3), a2) )
                return 0;
              v40 = *(_DWORD **)(HIDWORD(v3) + 160);
            }
            if ( a2 && (*(_BYTE *)a2 & 3) == 1 )
            {
              v383 = v40[17];
              v384 = 32 * v40[12];
              v385 = v383 + v384;
              if ( v383 >= v383 + v384 )
                goto LABEL_864;
              v386 = v383 + 32;
              v387 = -1;
              do
              {
                if ( *(_DWORD *)(v386 - 32) == 1 && v387 >= *(_DWORD *)(v386 - 20) )
                  v387 = *(_DWORD *)(v386 - 20);
                v386 += 32;
              }
              while ( v386 != v385 + 32 );
              if ( v387 )
LABEL_864:
                *((_WORD *)v446 + 18) = 2;
            }
            v42 = *(unsigned __int8 **)(v428 + 392);
            v43 = sub_347418(*(_DWORD *)(v40[587] + 28), v42[1]);
            v45 = v43;
            if ( !v43 )
              goto LABEL_435;
            if ( v43 != 1 && *(_DWORD *)v446[17] == 6 )
            {
              v412 = (*(int (__fastcall **)(_DWORD))(v428 + 180))(HIDWORD(v3));
              if ( v412 )
              {
                v42 = *(unsigned __int8 **)(v428 + 392);
              }
              else
              {
                v46 = (_DWORD *)v446[17];
                if ( v46[8] == 1 )
                {
                  v395 = v46[11];
                  v396 = v46[3];
                  if ( v395 > v396 || v395 + v46[14] < v396 + v46[6] )
                  {
                    sub_2A6A5C("%B: error: PHDR segment not covered by LOAD segment", HIDWORD(v3));
                    return v412;
                  }
                }
                v42 = *(unsigned __int8 **)(v428 + 392);
              }
            }
            if ( !sub_2A8A04(SHIDWORD(v3), *v42, 0)
              && !(*(int (__fastcall **)(_DWORD, _DWORD, int))(*(_DWORD *)(v428 + 392) + 16))(
                    HIDWORD(v3),
                    v446[17],
                    v45) )
            {
              goto LABEL_435;
            }
            return 0;
          }
        }
        if ( !*(_DWORD *)(v190 + 48) )
        {
LABEL_343:
          if ( v192 != *(_QWORD *)(v190 + 16) )
            sub_2A6BBC("elf.c", 5730);
          goto LABEL_340;
        }
        if ( (*(_DWORD *)(v190 + 8) & 2) != 0 )
        {
          if ( !*(_DWORD *)(v190 + 24) )
          {
LABEL_550:
            v187 = *(_DWORD *)(v190 + 12);
            goto LABEL_551;
          }
LABEL_330:
          v186 = *(const char **)v188;
LABEL_331:
          sub_2A6A5C("%B: warning: allocated section `%s' not in segment", v415, v186);
          if ( (*(_DWORD *)(v415 + 40) & 0x2000) != 0 )
          {
            v187 = *(_DWORD *)(v190 + 12);
            v188 = *(_DWORD *)(v190 + 44);
            if ( *(_DWORD *)(v190 + 24) )
            {
              v189 = *(_DWORD *)(v420 + 16);
              if ( v189 )
              {
                sub_347F74(v187 - v3, ((unsigned __int64)v187 - v3) >> 32, v189, 0);
                v184 = *(_DWORD *)(v190 + 4);
                v3 += v373;
              }
              else
              {
                v184 = *(_DWORD *)(v190 + 4);
              }
            }
            else
            {
              v184 = *(_DWORD *)(v190 + 4);
LABEL_551:
              v267 = *(_DWORD *)(v190 + 36);
              if ( v267 )
              {
                sub_347F74(v187 - v3, ((unsigned __int64)v187 - v3) >> 32, v267, 0);
                v3 += v268;
              }
            }
            *(_QWORD *)(v190 + 16) = v3;
            if ( v188 )
              *(_QWORD *)(v188 + 80) = v3;
            if ( v184 == 8 )
              goto LABEL_340;
            goto LABEL_339;
          }
          v188 = *(_DWORD *)(v190 + 44);
LABEL_549:
          v184 = *(_DWORD *)(v190 + 4);
          goto LABEL_550;
        }
        goto LABEL_509;
      }
    }
    else
    {
      v127 = 0;
    }
    v442 = 0;
    v40[5] = 0;
    v40[11] = 0;
    goto LABEL_227;
  }
  v107 = v40[133];
  v108 = v40[16];
  v109 = v40[587];
  v110 = (unsigned int)v40[10];
  v111 = (unsigned int)v110;
  if ( v107 <= 1 )
    goto LABEL_434;
  v112 = v40[16];
  v401 = HIDWORD(v3);
  while ( 2 )
  {
    v118 = *(_DWORD *)(v112 + 4);
    v112 += 4;
    v117 = v118;
    v119 = *(_DWORD *)(v118 + 4);
    v120 = *(_DWORD *)(v118 + 44);
    v121 = v119 == 4;
    if ( v119 != 4 )
      v121 = v119 == 9;
    if ( v121 )
    {
      if ( v120 )
        goto LABEL_190;
      goto LABEL_212;
    }
    if ( v120 )
    {
LABEL_190:
      if ( (*(_DWORD *)(v120 + 20) & 0x8000000) == 0 )
        goto LABEL_191;
LABEL_212:
      v2 = -1;
      *(_QWORD *)(v117 + 16) = -1;
    }
    else
    {
LABEL_191:
      if ( v40[580] == v106 )
        goto LABEL_212;
      v113 = v40[130];
      if ( v113 )
      {
        if ( v117 == *(_DWORD *)(v108 + 4 * *(_DWORD *)(v113 + 56)) )
          goto LABEL_212;
      }
      if ( *(_DWORD *)(v109 + 48) == v106 || *(_DWORD *)(v109 + 44) == v106 )
        goto LABEL_212;
      v114 = *(_DWORD *)(v117 + 36);
      if ( v114 > 1 )
      {
        HIDWORD(v110) = 0;
        v115 = __CFADD__(v114 - 1, (_DWORD)v110);
        v116 = v114 - 1 + v110;
        if ( v115 )
          LODWORD(v110) = -1;
        else
          v2 = -v114;
        if ( !v115 )
        {
          v2 &= v116;
          LODWORD(v110) = v2;
        }
      }
      *(_QWORD *)(v117 + 16) = v110;
      if ( v120 )
        *(_QWORD *)(v120 + 80) = v110;
      if ( v119 != 8 )
        v110 += *(unsigned int *)(v117 + 24);
    }
    if ( v107 != ++v106 )
      continue;
    break;
  }
  HIDWORD(v3) = v401;
  v111 = v110;
LABEL_434:
  v44 = v111;
  *(_QWORD *)(v109 + 32) = v111;
LABEL_435:
  if ( ptr )
  {
    v224 = *(_DWORD *)(HIDWORD(v3) + 160);
    v225 = *(_DWORD *)(v224 + 108);
    v226 = *(_DWORD *)(v224 + 2348);
    v227 = *(_QWORD *)(v226 + 32);
    if ( v225 > 1 )
    {
      HIDWORD(v227) = 0;
      v228 = __CFADD__((_DWORD)v227, v225 - 1);
      v229 = v227 + v225 - 1;
      if ( v228 )
        LODWORD(v227) = -1;
      else
        v44 = -v225;
      if ( !v228 )
      {
        v44 &= v229;
        LODWORD(v227) = v44;
      }
    }
    v230 = *(_DWORD *)(v224 + 116);
    *(_QWORD *)(v224 + 88) = v227;
    if ( v230 )
      *(_QWORD *)(v230 + 80) = v227;
    if ( *(_DWORD *)(v224 + 76) != 8 )
      v227 += *(unsigned int *)(v224 + 96);
    v231 = *(_DWORD *)(v224 + 520);
    if ( v231 )
    {
      v232 = *(_DWORD *)(v231 + 24);
      if ( v232 )
      {
        v233 = *(_DWORD *)(v231 + 36);
        if ( v233 > 1 )
        {
          HIDWORD(v227) = 0;
          v234 = __CFADD__((_DWORD)v227, v233 - 1);
          v235 = v227 + v233 - 1;
          if ( v234 )
            LODWORD(v227) = -1;
          else
            v44 = -v233;
          if ( !v234 )
          {
            v44 &= v235;
            LODWORD(v227) = v44;
          }
        }
        v236 = *(_DWORD *)(v231 + 44);
        *(_QWORD *)(v231 + 16) = v227;
        if ( v236 )
          *(_QWORD *)(v236 + 80) = v227;
        if ( *(_DWORD *)(v231 + 4) != 8 )
          v227 += v232;
      }
    }
    v237 = *(_DWORD *)(v224 + 220);
    if ( v237 > 1 )
    {
      HIDWORD(v227) = 0;
      v238 = __CFADD__((_DWORD)v227, v237 - 1);
      v239 = v227 + v237 - 1;
      if ( v238 )
        LODWORD(v227) = -1;
      else
        v44 = -v237;
      if ( !v238 )
        LODWORD(v227) = v44 & v239;
    }
    v240 = *(_DWORD *)(v224 + 228);
    *(_QWORD *)(v224 + 200) = v227;
    if ( v240 )
      *(_QWORD *)(v240 + 80) = v227;
    if ( *(_DWORD *)(v224 + 188) == 8 )
      v241 = v227;
    else
      v241 = v227 + *(unsigned int *)(v224 + 208);
    *(_QWORD *)(v226 + 32) = v241;
    if ( !sub_2A8A04(SHIDWORD(v3), v227, 0) && sub_2F0588(HIDWORD(v3), v445) )
    {
      sub_2F0164(v445);
      goto LABEL_471;
    }
    return 0;
  }
  else
  {
LABEL_471:
    v412 = 1;
    *(_BYTE *)(HIDWORD(v3) + 43) |= 0x40u;
  }
  return v412;
}
