int __fastcall sub_2EAA90(int a1, int a2)
{
  int v2; // r4
  int v4; // r10
  int v5; // r3
  int v6; // r2
  int v7; // r3
  _BOOL4 v8; // r3
  int v9; // r6
  int v10; // r2
  const char *v11; // r4
  size_t v12; // r9
  const char *v13; // r8
  int v14; // r1
  _DWORD *v15; // r3
  int v16; // r2
  int v17; // r0
  int v18; // r5
  signed int v19; // r3
  char v20; // r10
  _DWORD *v21; // r4
  _DWORD *v22; // r7
  unsigned int v23; // r8
  int v24; // r2
  int v25; // r6
  int v26; // r1
  int (__fastcall *v27)(int); // r11
  _BOOL4 v28; // r2
  int v29; // r3
  int v30; // r1
  int v31; // r1
  unsigned int v32; // r1
  signed int v33; // r9
  char v34; // r6
  int v35; // r3
  int v36; // r6
  char v37; // r2
  int v38; // r1
  _DWORD *i; // r7
  int v40; // r6
  __int64 v41; // r2
  unsigned int v42; // r3
  void *v43; // r0
  int v44; // r3
  _DWORD *v45; // r0
  int v46; // r6
  unsigned int v47; // r2
  int v48; // r11
  unsigned int v49; // r0
  int (*v50)(const void *, const void *); // r2
  unsigned int v51; // r1
  int v52; // r2
  bool v53; // zf
  int v54; // r1
  int v55; // r0
  int v56; // r2
  int v57; // r1
  int v58; // r3
  int v59; // r0
  int v60; // r3
  int v61; // r1
  int v62; // r6
  int v63; // r0
  void *v64; // r0
  int v65; // r3
  size_t v66; // r2
  int v67; // r0
  unsigned int v68; // r3
  _DWORD *v69; // r1
  int v70; // r3
  int v71; // r6
  void *v72; // r0
  int v73; // r2
  int v74; // r0
  int v75; // r1
  int v76; // r3
  unsigned int v77; // r3
  unsigned int v78; // r5
  int v79; // r3
  char v80; // r2
  int v81; // r1
  int v82; // r0
  _DWORD *v83; // r1
  int v84; // r3
  int v85; // r2
  int v86; // r3
  int v87; // r2
  int v88; // r2
  int v89; // r11
  _DWORD *v90; // r4
  double v91; // r2
  int v92; // r9
  int v93; // r8
  int v94; // r5
  int v95; // r6
  bool v96; // zf
  int v97; // r7
  int (__fastcall *v98)(int, int); // r2
  int v99; // r0
  int j; // r3
  _DWORD *v101; // r6
  int v102; // r9
  int v103; // r8
  _DWORD *k; // r10
  int v105; // r3
  _DWORD *v106; // r4
  int v107; // r5
  int v108; // r2
  int v109; // r3
  int v110; // r2
  int v111; // r11
  int v112; // r3
  bool v113; // zf
  unsigned int v114; // r1
  int v115; // r12
  unsigned int v116; // r0
  unsigned int *v117; // r3
  unsigned int v118; // r2
  int v119; // r3
  int v120; // r1
  bool v121; // zf
  unsigned int *v122; // r1
  _DWORD *v123; // r4
  int v124; // r5
  void *v125; // r0
  unsigned int v126; // r0
  int v127; // r1
  int v128; // r1
  _DWORD *v129; // r6
  int v130; // r2
  int v131; // r3
  bool v132; // zf
  char *v133; // r0
  void *v134; // r6
  unsigned int v135; // r5
  size_t v136; // r1
  char *v137; // r3
  char *v138; // r8
  char *v139; // r4
  int v140; // r9
  int v141; // r5
  int v142; // r0
  int v143; // r0
  int v144; // t1
  int v145; // r2
  int v146; // r0
  int v147; // r3
  int v148; // r2
  int v149; // r0
  _DWORD *v150; // r2
  int v151; // r11
  int v152; // r0
  int v153; // r11
  int (__fastcall *v154)(int, int, int *, int (__fastcall *)(_DWORD *, _BYTE *, int *, int, int)); // r5
  int v155; // r2
  int v156; // r2
  int v157; // r1
  int v158; // r9
  char v159; // r0
  _DWORD *m; // r5
  int v161; // r1
  unsigned int *v162; // r2
  int v163; // r3
  int v164; // r2
  int v165; // r0
  int v166; // r8
  int v167; // r0
  int (__fastcall *v168)(int, int, int *, int (__fastcall *)(_DWORD *, _BYTE *, int *, int, int)); // r5
  int v169; // r2
  int v170; // r7
  int v171; // r2
  int v172; // r3
  int v173; // r9
  void *v174; // r8
  unsigned int ii; // r6
  unsigned int v176; // r5
  _DWORD *v177; // r5
  const char *v178; // r4
  const char *v179; // r5
  int v180; // r2
  _DWORD *v181; // r7
  int v182; // r3
  int v183; // r6
  int v184; // r5
  int v185; // r12
  int v186; // r6
  int v187; // r5
  int v188; // r3
  int v189; // r5
  int v190; // r6
  int v191; // r7
  int v192; // r7
  int v193; // r0
  signed int v194; // r0
  _DWORD *v195; // r8
  int v196; // r7
  int (__fastcall *v197)(int, int, _DWORD *, int); // r6
  signed int v198; // r9
  int v199; // r7
  int v200; // r5
  char *jj; // r9
  int v202; // r4
  int (__fastcall *v203)(char *); // r3
  _BOOL4 v204; // r5
  const char **v205; // r0
  const char *v206; // r4
  const char *v207; // r5
  int v208; // r5
  int v209; // r6
  __int64 v210; // r0
  __int64 v211; // r8
  int v212; // r0
  int v213; // r3
  __int64 v214; // r0
  __int64 v215; // r2
  void *v216; // r0
  void *v217; // r5
  char v218; // r3
  size_t v219; // r8
  const char **v220; // r4
  const char *v221; // r7
  const char *v222; // r5
  _DWORD *v223; // r0
  int v224; // r3
  int v225; // r2
  int v226; // r3
  char *v227; // r0
  int v228; // r2
  int v229; // r2
  char *v230; // r7
  char *v231; // r0
  char *v232; // r2
  int v233; // r3
  bool v234; // zf
  int v235; // r8
  _DWORD *v236; // r5
  int v237; // r0
  int v238; // r3
  bool v239; // zf
  size_t v240; // r0
  size_t v241; // r6
  int v242; // r5
  _DWORD *v243; // r6
  char *v244; // r11
  int v245; // r4
  int v246; // r10
  _DWORD *v247; // r5
  int v248; // r3
  int v249; // r8
  int v250; // r7
  _DWORD *kk; // r6
  int v252; // r0
  int nn; // r4
  int v254; // r3
  char **v255; // r7
  void *v256; // r9
  int v257; // r0
  int v258; // r1
  int v259; // r0
  int v260; // r1
  int v261; // r2
  int v262; // r3
  bool v263; // zf
  int v264; // lr
  unsigned int v265; // r2
  int v266; // r1
  int v267; // r1
  unsigned int mm; // r0
  _DWORD *v269; // r12
  int v270; // r5
  unsigned int v271; // r12
  bool v272; // zf
  _DWORD *v273; // r9
  int v274; // r3
  char *v275; // r4
  size_t v276; // r1
  int v277; // r8
  int v278; // r7
  _DWORD *v279; // r0
  int v280; // r1
  _DWORD *v281; // r4
  char *v282; // r9
  _DWORD *v283; // r0
  int v284; // r12
  _DWORD *v285; // r1
  _DWORD *v286; // r2
  size_t v287; // r12
  int v288; // r3
  _DWORD **v289; // r2
  _DWORD *v290; // r3
  int v291; // r3
  unsigned int v292; // r5
  int v293; // r6
  int v294; // r0
  unsigned int v295; // r6
  unsigned int v296; // r2
  char *v297; // r1
  _DWORD *v298; // r0
  int *v299; // r12
  signed int v300; // r1
  _DWORD *v301; // r3
  int v302; // t1
  _DWORD *v303; // r2
  int v304; // r7
  int v305; // r6
  int v306; // r1
  int v307; // r3
  int v308; // r3
  int v309; // r2
  int v310; // r3
  int v311; // r5
  _DWORD *v313; // [sp+14h] [bp-C8h]
  __compar_fn_t compar; // [sp+18h] [bp-C4h]
  __compar_fn_t compara; // [sp+18h] [bp-C4h]
  size_t comparb; // [sp+18h] [bp-C4h]
  __compar_fn_t compard; // [sp+18h] [bp-C4h]
  __compar_fn_t comparc; // [sp+18h] [bp-C4h]
  int v319; // [sp+1Ch] [bp-C0h]
  _BOOL4 v320; // [sp+20h] [bp-BCh]
  _DWORD *v321; // [sp+20h] [bp-BCh]
  const char *v322; // [sp+20h] [bp-BCh]
  int v323; // [sp+20h] [bp-BCh]
  signed int v324; // [sp+20h] [bp-BCh]
  int base; // [sp+24h] [bp-B8h]
  char *basea; // [sp+24h] [bp-B8h]
  void *baseb; // [sp+24h] [bp-B8h]
  unsigned int v328; // [sp+28h] [bp-B4h]
  int v329; // [sp+28h] [bp-B4h]
  int v330; // [sp+28h] [bp-B4h]
  char *v331; // [sp+28h] [bp-B4h]
  int v332; // [sp+28h] [bp-B4h]
  int v333; // [sp+28h] [bp-B4h]
  int v334; // [sp+2Ch] [bp-B0h]
  int v335; // [sp+2Ch] [bp-B0h]
  int v336; // [sp+2Ch] [bp-B0h]
  int v337; // [sp+2Ch] [bp-B0h]
  int v338; // [sp+2Ch] [bp-B0h]
  int v339; // [sp+2Ch] [bp-B0h]
  int v340; // [sp+2Ch] [bp-B0h]
  int v341; // [sp+2Ch] [bp-B0h]
  int v342; // [sp+30h] [bp-ACh]
  void (__fastcall *v343)(int, size_t, char *); // [sp+30h] [bp-ACh]
  char *v344; // [sp+30h] [bp-ACh]
  unsigned int ptr; // [sp+34h] [bp-A8h]
  void *ptra; // [sp+34h] [bp-A8h]
  _DWORD *ptrb; // [sp+34h] [bp-A8h]
  int ptrc; // [sp+34h] [bp-A8h]
  int ptrd; // [sp+34h] [bp-A8h]
  size_t v350; // [sp+38h] [bp-A4h]
  int n; // [sp+38h] [bp-A4h]
  void (__fastcall *v352)(int, char *, unsigned int); // [sp+38h] [bp-A4h]
  int v353; // [sp+3Ch] [bp-A0h]
  _DWORD *v354; // [sp+40h] [bp-9Ch]
  int v355; // [sp+44h] [bp-98h]
  size_t v356; // [sp+44h] [bp-98h]
  size_t v357; // [sp+48h] [bp-94h]
  int v358; // [sp+4Ch] [bp-90h]
  char *v359; // [sp+4Ch] [bp-90h]
  int v360; // [sp+54h] [bp-88h] BYREF
  int v361; // [sp+58h] [bp-84h]
  int v362; // [sp+5Ch] [bp-80h]
  int *v363; // [sp+60h] [bp-7Ch]
  int v364; // [sp+64h] [bp-78h] BYREF
  int v365; // [sp+68h] [bp-74h]
  __int16 v366; // [sp+70h] [bp-6Ch]
  char v367; // [sp+72h] [bp-6Ah]
  unsigned int v368; // [sp+74h] [bp-68h]
  unsigned int v369; // [sp+78h] [bp-64h] BYREF
  int v370; // [sp+7Ch] [bp-60h]
  unsigned int *v371; // [sp+80h] [bp-5Ch]
  int v372; // [sp+84h] [bp-58h]
  int v373; // [sp+88h] [bp-54h]
  int v374; // [sp+9Ch] [bp-40h] BYREF
  int v375; // [sp+A0h] [bp-3Ch]
  int v376; // [sp+A4h] [bp-38h]
  const char **v377; // [sp+A8h] [bp-34h]
  const char **v378; // [sp+ACh] [bp-30h]
  void *v379; // [sp+B0h] [bp-2Ch]
  void *v380; // [sp+B4h] [bp-28h]
  void *v381; // [sp+B8h] [bp-24h]
  void *v382; // [sp+BCh] [bp-20h]
  void *v383; // [sp+C0h] [bp-1Ch]
  void *v384; // [sp+C4h] [bp-18h]
  void *v385; // [sp+C8h] [bp-14h]
  void *v386; // [sp+CCh] [bp-10h]
  void *v387; // [sp+D0h] [bp-Ch]
  int v388; // [sp+D4h] [bp-8h]

  v313 = *(_DWORD **)(a2 + 28);
  if ( v313[10] != 1 )
    return 0;
  v4 = a1;
  v5 = *(_BYTE *)a2 & 3;
  v319 = *(_DWORD *)(*(_DWORD *)(a1 + 4) + 444);
  if ( (*(_BYTE *)a2 & 1) != 0 )
    *(_DWORD *)(a1 + 40) |= 0x800u;
  v53 = v5 == 2;
  v374 = a2;
  v6 = v313[12];
  v7 = v313[14];
  v375 = a1;
  v342 = v6;
  v353 = v7;
  v8 = v53 || (*(unsigned __int8 *)(a2 + 3) >> 3) & 1;
  v320 = v8;
  v376 = sub_2F00E8(a1);
  if ( !v376 )
    return 0;
  if ( v342 )
  {
    v377 = sub_2AD864(v353, ".hash");
    v378 = sub_2AD864(v353, ".gnu.version");
  }
  else
  {
    v377 = 0;
    v378 = 0;
  }
  v9 = *(_DWORD *)(v4 + 100);
  v10 = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 444);
  v379 = 0;
  base = v320;
  v380 = 0;
  v381 = 0;
  v11 = *(const char **)(v10 + 412);
  v382 = 0;
  v383 = 0;
  v384 = 0;
  v385 = 0;
  v386 = 0;
  v387 = 0;
  v388 = 0;
  if ( !v9 )
  {
    v354 = 0;
    v33 = 0;
    ptr = 0;
    compar = 0;
    v357 = 0;
    v328 = 0;
    v350 = 0;
    goto LABEL_57;
  }
  v354 = 0;
  v12 = 0;
  do
  {
    while ( 1 )
    {
      v13 = *(const char **)v9;
      if ( (!v11 || strcmp(*(const char **)v9, v11)) && strcmp(v13, ".gnu.attributes") )
        goto LABEL_14;
      v15 = *(_DWORD **)(v9 + 160);
      while ( v15 )
      {
        v16 = v15[1];
        if ( v16 == 1 )
          v14 = v15[4];
        v15 = (_DWORD *)*v15;
        if ( v16 == 1 )
          *(_DWORD *)(v14 + 20) &= ~0x100u;
      }
      v17 = sub_2EF3A4(v4);
      v12 = v17;
      if ( !v17 )
        break;
      v354 = (_DWORD *)v9;
      sub_2ADDBC(v4, v9, v17);
      *(_DWORD *)(v9 + 160) = 0;
LABEL_14:
      v9 = *(_DWORD *)(v9 + 12);
      if ( !v9 )
        goto LABEL_26;
    }
    *(_DWORD *)(v9 + 20) |= 0x8000u;
    v9 = *(_DWORD *)(v9 + 12);
  }
  while ( v9 );
LABEL_26:
  v18 = *(_DWORD *)(v4 + 100);
  v357 = v12;
  if ( !v18 )
  {
    ptr = v9;
    v33 = v9;
    compar = (__compar_fn_t)v9;
    v328 = v9;
    v350 = v9;
    goto LABEL_57;
  }
  v19 = v9;
  v355 = v4;
  v20 = v9;
  v328 = v9;
  compar = (__compar_fn_t)v9;
  ptr = v9;
  v350 = v9;
  do
  {
    v21 = *(_DWORD **)(v18 + 160);
    *(_DWORD *)(v18 + 76) = 0;
    v22 = *(_DWORD **)(v18 + 140);
    if ( !v21 )
    {
      v31 = *(_DWORD *)(v18 + 20);
LABEL_115:
      v32 = v31 & 0xFFFFFFFB;
      *(_DWORD *)(v18 + 20) = v32;
      goto LABEL_48;
    }
    v23 = v19;
    do
    {
      while ( 1 )
      {
        v24 = v21[1];
        if ( (unsigned int)(v24 - 3) <= 1 )
        {
          v25 = 0;
          v26 = 1;
          v27 = 0;
          goto LABEL_34;
        }
        if ( v24 != 1 )
          goto LABEL_31;
        v44 = v21[4];
        v45 = *(_DWORD **)(v44 + 148);
        v46 = *(_DWORD *)(v44 + 20);
        v47 = *(_DWORD *)(v44 + 40);
        *(_BYTE *)(v44 + 24) |= 2u;
        if ( (v46 & 0x800000) != 0 )
          v20 = 1;
        if ( v47 < *(_DWORD *)(v44 + 36) )
          v47 = *(_DWORD *)(v44 + 36);
        if ( v23 < v47 )
          v23 = v47;
        if ( *(_DWORD *)(v45[1] + 4) != 5 || (v45[10] & 0x800) != 0 )
          goto LABEL_31;
        v48 = v45[40];
        if ( (*(_BYTE *)(v48 + 2341) & 0x40) != 0 )
        {
          v334 = v44;
          v49 = sub_347418(*(_DWORD *)(v48 + 96), *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 5));
          v44 = v334;
        }
        else
        {
          v49 = *(_DWORD *)(v48 + 104);
        }
        v50 = compar;
        v51 = v328;
        if ( (unsigned int)compar < v49 )
          v50 = (int (*)(const void *, const void *))v49;
        compar = v50;
        if ( v49 > v328 )
        {
          if ( *(_DWORD *)(v48 + 520) )
            v51 = v49;
          v328 = v51;
        }
        v52 = v22[1];
        v53 = v52 == 4;
        if ( v52 != 4 )
          v53 = v52 == 9;
        if ( v53 )
        {
LABEL_123:
          v53 = (v46 & 4) == 0;
          v25 = *(_DWORD *)(v44 + 140);
          if ( v53 )
            goto LABEL_31;
          v27 = 0;
          v54 = 0;
          goto LABEL_126;
        }
        if ( v320 )
        {
          v27 = *(int (__fastcall **)(int))(v319 + 256);
          v54 = *(_DWORD *)(v44 + 76);
          if ( v27 )
          {
            v358 = *(_DWORD *)(v44 + 76);
            v335 = v44;
            v55 = v27(v44);
            v44 = v335;
            v27 = (int (__fastcall *)(int))v55;
            v54 = v358;
            v46 = *(_DWORD *)(v335 + 20);
          }
        }
        else
        {
          v98 = *(int (__fastcall **)(int, int))(v319 + 252);
          if ( !v98 )
            goto LABEL_123;
          v337 = v44;
          v99 = v98(a2, v44);
          v44 = v337;
          v54 = v99;
          v27 = 0;
          v46 = *(_DWORD *)(v337 + 20);
        }
        v53 = (v46 & 4) == 0;
        v25 = *(_DWORD *)(v44 + 140);
        if ( v53 )
          goto LABEL_102;
LABEL_126:
        v66 = *(_DWORD *)(v25 + 60);
        v67 = *(_DWORD *)(v25 + 76);
        if ( v66 )
        {
          v66 = *(_DWORD *)(v66 + 24);
          if ( v67 )
LABEL_128:
            v66 += *(_DWORD *)(v67 + 24);
          if ( v350 >= v66 )
            v66 = v350;
          v350 = v66;
          goto LABEL_132;
        }
        if ( v67 )
          goto LABEL_128;
LABEL_132:
        v68 = *(_DWORD *)(v44 + 76);
        if ( ptr >= v68 )
          v68 = ptr;
        ptr = v68;
LABEL_102:
        if ( v54 )
          break;
LABEL_31:
        v21 = (_DWORD *)*v21;
        if ( !v21 )
          goto LABEL_45;
      }
      v26 = (int)v27 + v54;
      v24 = v21[1];
LABEL_34:
      v28 = v24 == 1 && v320;
      *(_DWORD *)(v18 + 76) += v26;
      if ( v28 )
      {
        v56 = *(_DWORD *)(v25 + 60);
        if ( v56 )
        {
          v57 = *(_DWORD *)(v56 + 40);
          v58 = v22[16];
          if ( v57 )
          {
            v336 = v22[16];
            v59 = sub_347418(*(_DWORD *)(v56 + 24), v57);
            v58 = v336;
          }
          else
          {
            v59 = 0;
          }
          v22[16] = (char *)v27 + v58 + v59;
        }
        v60 = *(_DWORD *)(v25 + 76);
        if ( v60 )
        {
          v61 = *(_DWORD *)(v60 + 40);
          v62 = v22[20];
          if ( v61 )
            v63 = sub_347418(*(_DWORD *)(v60 + 24), v61);
          else
            v63 = 0;
          v22[20] = (char *)v27 + v62 + v63;
        }
        goto LABEL_31;
      }
      v21 = (_DWORD *)*v21;
      if ( (*(_BYTE *)(v18 + 25) & 4) != 0 )
        v29 = v22[20];
      else
        v29 = v22[16];
      v30 = v29 + v26;
      if ( (*(_BYTE *)(v18 + 25) & 4) != 0 )
        v22[20] = v30;
      else
        v22[16] = v30;
    }
    while ( v21 );
LABEL_45:
    v19 = v23;
    v31 = *(_DWORD *)(v18 + 20);
    if ( !*(_DWORD *)(v18 + 76) )
      goto LABEL_115;
    v32 = v31 | 4;
    *(_DWORD *)(v18 + 20) = v32;
LABEL_48:
    if ( (v32 & 1) == 0 && (*(_BYTE *)(v18 + 24) & 1) == 0 )
      *(_DWORD *)(v18 + 28) = *(_BYTE *)(v18 + 24) & 1;
    v18 = *(_DWORD *)(v18 + 12);
  }
  while ( v18 );
  v33 = v19;
  v34 = v20;
  v4 = v355;
  v35 = *(_BYTE *)a2 & 3;
  if ( v35 == 2 )
    v36 = 0;
  else
    v36 = v34 & 1;
  if ( v36 )
    sub_2FCBD4(v313, sub_2DD968, v355, v35);
LABEL_57:
  v37 = *(_BYTE *)(v4 + 43);
  v38 = v320;
  if ( (*(_BYTE *)(a2 + 1) & 0x60) != 0x60 )
    v38 = v320 | 1;
  *(_DWORD *)(v4 + 124) = v38;
  if ( (v37 & 0x40) != 0 )
    sub_2A6BBC("elflink.c", 11778);
  if ( !sub_2D1584(v4, a2) )
  {
LABEL_122:
    sub_2DD778((_DWORD *)(v4 + 100), &v374);
    return 0;
  }
  for ( i = *(_DWORD **)(v4 + 100); i; i = (_DWORD *)i[3] )
  {
    v40 = i[35];
    if ( (i[5] & 4) != 0
      && (*(_DWORD *)(v40 + 60) && !sub_2DD4F0(v4, (_DWORD *)(v40 + 60))
       || *(_DWORD *)(v40 + 76) && !sub_2DD4F0(v4, (_DWORD *)(v40 + 76))) )
    {
      goto LABEL_122;
    }
    v41 = *(_QWORD *)(v40 + 16);
    *(_DWORD *)(v40 + 64) = 0;
    *(_DWORD *)(v40 + 80) = 0;
    if ( v41 == -1 )
    {
      v42 = ((i[5] ^ 0x8000000u) >> 27) & 1;
      if ( *(_DWORD *)(v40 + 48) )
        v42 = 1;
      if ( v42 )
        sub_2A6BF0((int)"elflink.c", 11809, (int)"bfd_elf_final_link");
      v43 = sub_2AB368(*(_DWORD *)(v40 + 24));
      if ( !v43 )
        goto LABEL_122;
      *(_DWORD *)(v40 + 48) = v43;
    }
  }
  v69 = *(_DWORD **)(v4 + 160);
  v70 = *(_DWORD *)(v319 + 392);
  *(_DWORD *)(v4 + 124) = 0;
  v69[19] = 2;
  if ( (unsigned int)compar < 0x14 )
    v71 = 20;
  else
    v71 = (int)compar;
  v321 = v69;
  v69[28] = *(unsigned __int8 *)(v70 + 5);
  v69[27] = 1 << *(_BYTE *)(v70 + 11);
  v313[23] = v71;
  v72 = sub_2AB368(28 * v71);
  v313[24] = v72;
  if ( !v72 )
    goto LABEL_122;
  v73 = *(_DWORD *)(v4 + 160);
  v74 = base;
  if ( *(_DWORD *)(v73 + 532) <= 0xFF00u )
    v75 = 0;
  else
    v75 = -1;
  if ( (*(_BYTE *)(a2 + 1) & 0x60) != 0x60 )
    v74 = base | 1;
  v387 = (void *)v75;
  if ( v74 )
  {
    sub_2D0780((int)(v321 + 18), *(_QWORD *)(*(_DWORD *)(v73 + 2348) + 32), 1);
    v364 = 0;
    v365 = 0;
    v368 = 0;
    v366 = 0;
    v367 = 0;
    if ( sub_2DCC48(&v374, 0, &v364, (int)&off_4708A8, 0) != 1 )
      goto LABEL_122;
    v76 = *(_DWORD *)(v4 + 160);
    v365 = 0;
    v364 = 0;
    v77 = *(_DWORD *)(v76 + 532);
    v367 = 0;
    v366 = 3;
    if ( v77 > 1 )
    {
      v78 = 1;
      do
      {
        v79 = sub_2CFEF4(v4, v78);
        if ( v79 )
        {
          v80 = *(_BYTE *)a2;
          v81 = *(_DWORD *)(v4 + 124);
          v368 = v78;
          *(_DWORD *)(v79 + 136) = v81;
          if ( (v80 & 3) != 2 )
            v364 = *(_DWORD *)(v79 + 28);
          if ( sub_2DCC48(&v374, 0, &v364, v79, 0) != 1 )
            goto LABEL_122;
        }
      }
      while ( *(_DWORD *)(*(_DWORD *)(v4 + 160) + 532) > ++v78 );
    }
  }
  if ( v33 )
  {
    v379 = sub_2AB368(v33);
    if ( !v379 )
      goto LABEL_122;
  }
  if ( v350 )
  {
    v380 = sub_2AB368(v350);
    if ( !v380 )
      goto LABEL_122;
  }
  if ( ptr )
  {
    v381 = sub_2AB368(12 * ptr);
    if ( !v381 )
      goto LABEL_122;
  }
  v382 = sub_2AB368(v71 * *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 5));
  if ( !v382 )
    goto LABEL_122;
  v384 = sub_2AB368(20 * v71);
  if ( !v384 )
    goto LABEL_122;
  v385 = sub_2AB368(4 * v71);
  if ( !v385 )
    goto LABEL_122;
  v386 = sub_2AB368(4 * v71);
  if ( !v386 )
    goto LABEL_122;
  if ( v328 )
  {
    v383 = sub_2AB368(4 * v328);
    if ( !v383 )
      goto LABEL_122;
  }
  v82 = v313[51];
  if ( v82 )
  {
    v83 = (_DWORD *)v313[51];
    v84 = 0;
    do
    {
      v85 = v83[5];
      if ( (v85 & 0x400) == 0 )
        break;
      v86 = v83[9];
      if ( !v86 && (v85 & 0x100) == 0 )
      {
        v87 = v83[41];
        if ( v87 )
          v86 = *(_DWORD *)(v87 + 12) + *(_DWORD *)(v87 + 8);
      }
      v88 = v83[7];
      v83 = (_DWORD *)v83[3];
      v84 = v86 + v88;
    }
    while ( v83 );
    if ( *(_DWORD *)(v319 + 452) == 1 )
      v84 = ((1 << *(_DWORD *)(v82 + 64)) - 1 + v84) & -(1 << *(_DWORD *)(v82 + 64));
    v313[52] = v84 - *(_DWORD *)(v82 + 28);
  }
  v89 = *(_DWORD *)(v4 + 100);
  if ( !v89 )
    goto LABEL_193;
  while ( 2 )
  {
    v90 = *(_DWORD **)(v89 + 160);
    HIDWORD(v91) = *(_DWORD *)(v4 + 4);
    LODWORD(v91) = *(_DWORD *)(HIDWORD(v91) + 444);
    if ( !v90 )
      goto LABEL_192;
    v92 = 0;
    v93 = *(_DWORD *)(HIDWORD(v91) + 444);
    HIDWORD(v91) = 0;
    v94 = 0;
    v95 = 0;
    while ( 2 )
    {
      if ( v90[1] == 1 )
      {
        v97 = v90[4];
        LODWORD(v91) = *(_DWORD *)(v97 + 148);
        if ( *(_DWORD *)(*(_DWORD *)(LODWORD(v91) + 4) + 4) == 5
          && *(unsigned __int8 *)(*(_DWORD *)(LODWORD(v91) + 160) + 4) == *(unsigned __int8 *)(*(_DWORD *)(v93 + 392)
                                                                                             + 12)
          && (v339 = HIDWORD(v91), v330 = *(_DWORD *)(v97 + 148), (v126 = sub_2D4B7C(v330, v90[4])) != 0)
          && (v127 = *(_DWORD *)(v330 + 160), LODWORD(v91) = *(_DWORD *)(v127 + 532), v126 < LODWORD(v91))
          && (v128 = *(_DWORD *)(*(_DWORD *)(v127 + 64) + 4 * v126), (*(_DWORD *)(v128 + 8) & 0x80) != 0)
          && LODWORD(v91) > *(_DWORD *)(v128 + 28) )
        {
          ++v95;
          v92 = v97;
          HIDWORD(v91) = v339;
        }
        else
        {
          ++v94;
          HIDWORD(v91) = v97;
        }
      }
      else
      {
        ++v94;
      }
      v96 = v94 == 0;
      if ( v94 )
        v96 = v95 == 0;
      if ( !v96 )
      {
        v132 = HIDWORD(v91) == 0;
        if ( HIDWORD(v91) )
          v132 = v92 == 0;
        if ( v132 )
          sub_2A6A5C("%A has both ordered and unordered sections", v91);
        else
          sub_2A6A5C(
            "%A has both ordered [`%A' in %B] and unordered [`%A' in %B] sections",
            v89,
            v92,
            *(_DWORD *)(v92 + 148),
            HIDWORD(v91),
            *(_DWORD *)(HIDWORD(v91) + 148));
        v2 = 0;
        ((void (__fastcall *)(int))loc_2A6C48)(17);
        return v2;
      }
      v90 = (_DWORD *)*v90;
      if ( v90 )
        continue;
      break;
    }
    if ( !v95 )
      goto LABEL_192;
    v133 = (char *)sub_2AB368(4 * v95);
    v134 = v133;
    if ( !v133 )
      return 0;
    v135 = *(_DWORD *)(v89 + 160);
    v136 = 0;
    if ( v135 )
    {
      v137 = v133 - 4;
      do
      {
        *((_DWORD *)v137 + 1) = v135;
        v137 += 4;
        ++v136;
        v135 = *(_DWORD *)v135;
      }
      while ( v135 );
      v138 = v133;
      v139 = &v133[4 * v136];
      qsort(v133, v136, 4u, (__compar_fn_t)sub_2DCE44);
      do
      {
        v140 = *(_DWORD *)(*(_DWORD *)v138 + 16);
        v141 = v135 & (-1 << *(_DWORD *)(v140 + 64));
        v142 = sub_2A6904(v4);
        v143 = sub_347418(v141, v142);
        v144 = *(_DWORD *)v138;
        v138 += 4;
        *(_DWORD *)(v140 + 56) = v143;
        v145 = *(_DWORD *)(v144 + 12);
        *(_DWORD *)(v144 + 8) = v141;
        v135 = v141 + v145;
      }
      while ( v139 != v138 );
    }
    else
    {
      qsort(v133, (size_t)v90, 4u, (__compar_fn_t)sub_2DCE44);
    }
    free(v134);
LABEL_192:
    v89 = *(_DWORD *)(v89 + 12);
    if ( v89 )
      continue;
    break;
  }
LABEL_193:
  if ( !sub_2F4EB0(a2) )
    return 0;
  for ( j = *(_DWORD *)(a2 + 56); j; j = *(_DWORD *)(j + 156) )
    *(_BYTE *)(j + 43) &= ~0x40u;
  if ( *(_DWORD *)(v4 + 100) )
  {
    v101 = *(_DWORD **)(v4 + 100);
    v102 = 0;
    v103 = v4;
    do
    {
      for ( k = (_DWORD *)v101[40]; k; k = (_DWORD *)*k )
      {
        v105 = k[1];
        if ( v105 == 1 )
        {
          v102 = *(_DWORD *)(k[4] + 148);
          if ( *(_DWORD *)(*(_DWORD *)(v102 + 4) + 4) == 5
            && *(unsigned __int8 *)(*(_DWORD *)(v102 + 160) + 4) == *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 12) )
          {
            if ( (*(_BYTE *)(v102 + 43) & 0x40) == 0 )
            {
              if ( !sub_2E95CC(&v374, *(_DWORD *)(k[4] + 148)) )
              {
                v4 = v103;
                goto LABEL_122;
              }
              *(_BYTE *)(v102 + 43) |= 0x40u;
            }
            continue;
          }
        }
        else if ( (unsigned int)(v105 - 3) <= 1 )
        {
          v106 = (_DWORD *)v101[35];
          v329 = *(_DWORD *)(*(_DWORD *)(v103 + 4) + 444);
          v107 = sub_301758(v103, *(_DWORD *)k[4]);
          if ( !v107 )
          {
            v4 = v103;
            ((void (__fastcall *)(int))loc_2A6C48)(17);
            goto LABEL_122;
          }
          v108 = v106[15];
          v109 = k[4];
          if ( v108 )
            v106 += 15;
          compara = *(__compar_fn_t *)(v109 + 8);
          if ( !v108 )
          {
            if ( !v106[19] )
            {
              sub_2A6BBC("elflink.c", 11093);
              __und(0);
            }
            v106 += 19;
          }
          v110 = *(_DWORD *)(v109 + 4);
          v111 = v106[1];
          ptrb = (_DWORD *)v106[3];
          if ( k[1] == 3 )
          {
            v338 = *(_DWORD *)(v110 + 136);
            if ( !v338 )
              sub_2A6BBC("elflink.c", 11101);
            ptrb[v111] = 0;
          }
          else
          {
            v146 = sub_2FC960(v103, a2, v110, 0, 0, 1);
            if ( v146 )
            {
              if ( (unsigned int)*(unsigned __int8 *)(v146 + 12) - 3 <= 1 )
              {
                v147 = *(_DWORD *)(v146 + 20);
                v148 = *(_DWORD *)(v147 + 60);
                v338 = *(_DWORD *)(v148 + 136);
                compara = (__compar_fn_t)((char *)compara + *(_DWORD *)(v147 + 56) + *(_DWORD *)(v148 + 28));
                ptrb[v111] = 0;
              }
              else
              {
                *(_DWORD *)(v146 + 28) = -2;
                v338 = 0;
                ptrb[v111] = v146;
              }
            }
            else
            {
              v338 = 0;
              (*(void (__fastcall **)(int))(*(_DWORD *)(a2 + 24) + 36))(a2);
            }
          }
          v112 = *(_DWORD *)(v107 + 36);
          v113 = v112 == 0;
          if ( v112 )
            v113 = compara == 0;
          if ( !v113 )
          {
            n = sub_300850(v107);
            v64 = sub_2AB4EC(n);
            v65 = n;
            ptra = v64;
            if ( n )
              v65 = 1;
            if ( v64 )
              v65 = 0;
            if ( v65 )
              goto LABEL_121;
            v149 = sub_30120C(v107, v103, compara, v64);
            if ( v149 != 2 )
            {
              if ( v149 != 3 )
                sub_2A6BF0((int)"elflink.c", 11166, (int)"elf_reloc_link_order");
              v150 = *(_DWORD **)(k[4] + 4);
              if ( k[1] == 3 )
                v150 = (_DWORD *)*v150;
              (*(void (__fastcall **)(int, _DWORD, _DWORD *, _DWORD))(*(_DWORD *)(a2 + 24) + 28))(
                a2,
                0,
                v150,
                *(_DWORD *)(v107 + 32));
            }
            v151 = k[2];
            v152 = sub_2A6904(v103);
            v153 = sub_2ADDE8(v103, v101, ptra, 0, (unsigned int)(v152 * v151), n);
            free(ptra);
            if ( !v153 )
            {
LABEL_121:
              v4 = v103;
              goto LABEL_122;
            }
          }
          v114 = k[2];
          if ( (*(_BYTE *)a2 & 3) != 2 )
            v114 += v101[7];
          v115 = *(_DWORD *)(v329 + 392);
          v116 = *(unsigned __int8 *)(v115 + 9);
          if ( *(_BYTE *)(v115 + 9) )
          {
            v117 = &v369;
            v118 = 0;
            do
            {
              ++v118;
              *v117 = v114;
              v117[1] = 0;
              v117[2] = 0;
              v117 += 3;
            }
            while ( v118 < v116 );
          }
          v119 = *(_DWORD *)v107;
          if ( *(_BYTE *)(v115 + 10) == 32 )
            v119 = (unsigned __int8)v119 + (v338 << 8);
          v370 = v119;
          v120 = *(_DWORD *)(*v106 + 4);
          v121 = v120 == 9;
          if ( v120 == 9 )
          {
            v122 = &v369;
            v107 = *(_DWORD *)(v115 + 60);
          }
          else
          {
            v122 = (unsigned int *)compara;
          }
          if ( !v121 )
          {
            v371 = v122;
            v107 = *(_DWORD *)(v115 + 68);
          }
          ((void (*)(void))v107)();
          ++v106[1];
          continue;
        }
        if ( !sub_2FE9F0(v103, a2, v101, k) )
        {
          v129 = k;
          v4 = v103;
          if ( v129[1] == 1 && *(_DWORD *)(*(_DWORD *)(v102 + 4) + 4) == 5 )
          {
            v130 = *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 12);
            v131 = *(unsigned __int8 *)(*(_DWORD *)(v102 + 160) + 4);
            if ( v131 != v130 )
            {
              if ( v130 == 1 )
              {
                v179 = "ELFCLASS32";
              }
              else if ( *(_BYTE *)(*(_DWORD *)(v319 + 392) + 12) )
              {
                if ( v130 != 2 )
                  sub_2A6BF0((int)"elflink.c", 12049, (int)"bfd_elf_final_link");
                v179 = "ELFCLASS64";
              }
              else
              {
                v179 = "ELFCLASSNONE";
              }
              if ( v131 == 1 )
              {
                v178 = "ELFCLASS32";
              }
              else if ( *(_BYTE *)(*(_DWORD *)(v102 + 160) + 4) )
              {
                if ( v131 != 2 )
                  sub_2A6BF0((int)"elflink.c", 12057, (int)"bfd_elf_final_link");
                v178 = "ELFCLASS64";
              }
              else
              {
                v178 = "ELFCLASSNONE";
              }
              ((void (__fastcall *)(int))loc_2A6C48)(3);
              sub_2A6A5C("%B: file class %s incompatible with %s", v102, v178, v179);
            }
          }
          goto LABEL_122;
        }
      }
      v101 = (_DWORD *)v101[3];
    }
    while ( v101 );
    v4 = v103;
  }
  if ( (*(_BYTE *)(a2 + 4) & 8) == 0 )
  {
    v123 = *(_DWORD **)(a2 + 56);
    if ( v123 )
    {
      v124 = *(_BYTE *)(a2 + 4) & 8;
      do
      {
        if ( *(_DWORD *)(v123[1] + 4) == 5 )
        {
          v125 = *(void **)(v123[40] + 588);
          if ( v125 )
          {
            free(v125);
            *(_DWORD *)(v123[40] + 588) = v124;
          }
        }
        v123 = (_DWORD *)v123[39];
      }
      while ( v123 );
    }
  }
  v360 = 0;
  v362 = 0;
  v361 = 1;
  v363 = &v374;
  sub_2AAF90(*(_DWORD *)(a2 + 28), (int (__fastcall *)(_DWORD *, int))sub_2DF3C0, (int)&v360);
  v2 = v360;
  if ( v360 )
    return 0;
  v154 = *(int (__fastcall **)(int, int, int *, int (__fastcall *)(_DWORD *, _BYTE *, int *, int, int)))(v319 + 208);
  if ( v154 )
  {
    v155 = base;
    if ( (*(_BYTE *)(a2 + 1) & 0x60) != 0x60 )
      v155 = base | 1;
    if ( v155 && !v154(v4, a2, &v374, sub_2DCC48) )
      return 0;
  }
  v321[26] = *(_DWORD *)(v4 + 124);
  if ( v342 )
  {
    v156 = v313[67];
    if ( v156 )
    {
      v157 = *(_DWORD *)(v156 + 60);
      if ( (char **)v157 != &off_470950 )
      {
        v158 = *(_DWORD *)(v156 + 108);
        v159 = *(_BYTE *)a2;
        *(_DWORD *)(*(_DWORD *)(v157 + 140) + 32) = v313[20] + 1;
        if ( (v159 & 1) != 0 || v313[13] )
        {
          v181 = *(_DWORD **)(v4 + 100);
          v370 = 0;
          v371 = 0;
          BYTE2(v372) = 0;
          LOWORD(v372) = 3;
          while ( v181 )
          {
            v182 = v181[35];
            v183 = *(_DWORD *)(v182 + 96);
            if ( v183 > 0 )
            {
              v184 = *(_DWORD *)(v182 + 92);
              if ( v184 <= 0 )
                sub_2A6BBC("elflink.c", 12154);
              v373 = v184;
              if ( (unsigned int)(v184 - 65280) < 0xFFFF0000 && !sub_2DCC1C(v4) )
                return v2;
              v185 = *(_DWORD *)(v319 + 392);
              v369 = v181[7];
              (*(void (__fastcall **)(int, unsigned int *, int, _DWORD))(v185 + 36))(
                v4,
                &v369,
                v158 + v183 * *(unsigned __int8 *)(v185 + 5),
                0);
            }
            v181 = (_DWORD *)v181[3];
          }
        }
        for ( m = (_DWORD *)v313[49]; m; m = (_DWORD *)*m )
        {
          v161 = m[5];
          v162 = (unsigned int *)m[6];
          v163 = m[7];
          v369 = m[4];
          v370 = v161;
          v371 = v162;
          v372 = v163;
          v164 = m[8];
          BYTE1(v372) = BYTE1(v163) & 0xFC;
          v373 = v164;
          v165 = sub_2CFEF4(m[1], m[8]);
          v166 = v165;
          if ( v165 )
          {
            v180 = *(_DWORD *)(v165 + 60);
            v373 = *(_DWORD *)(*(_DWORD *)(v180 + 140) + 92);
            if ( (unsigned int)(v373 - 65280) < 0xFFFF0000 )
            {
              if ( !sub_2DCC1C(v4) )
                return v2;
              v180 = *(_DWORD *)(v166 + 60);
            }
            v369 = *(_DWORD *)(v166 + 56) + m[4] + *(_DWORD *)(v180 + 28);
          }
          (*(void (__fastcall **)(int, unsigned int *, int, _DWORD))(*(_DWORD *)(v319 + 392) + 36))(
            v4,
            &v369,
            v158 + m[3] * *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 5),
            0);
        }
      }
    }
  }
  v363 = &v374;
  v167 = *(_DWORD *)(a2 + 28);
  v360 = 0;
  v361 = 0;
  sub_2AAF90(v167, (int (__fastcall *)(_DWORD *, int))sub_2DF3C0, (int)&v360);
  v2 = v360;
  if ( v360 )
    return 0;
  v168 = *(int (__fastcall **)(int, int, int *, int (__fastcall *)(_DWORD *, _BYTE *, int *, int, int)))(v319 + 212);
  if ( v168 )
  {
    v169 = base;
    if ( (*(_BYTE *)(a2 + 1) & 0x60) != 0x60 )
      v169 = base | 1;
    if ( v169 && !v168(v4, a2, &v374, sub_2DCC48) )
      return 0;
  }
  sub_2F0664(v376);
  v170 = *(_DWORD *)(v374 + 28);
  v171 = *(_DWORD *)(v170 + 88);
  if ( !v171 )
    goto LABEL_358;
  v172 = v375;
  if ( !*(_DWORD *)(*(_DWORD *)(v375 + 160) + 2320) )
  {
    sub_2A6BBC("elflink.c", 9290);
    v171 = *(_DWORD *)(v170 + 88);
    v172 = v375;
  }
  v173 = *(_DWORD *)(*(_DWORD *)(v172 + 4) + 444);
  v174 = sub_2AB368(v171 * *(unsigned __int8 *)(*(_DWORD *)(v173 + 392) + 5));
  if ( !v174 )
    return 0;
  if ( v387 )
  {
    v387 = sub_2AB4EC(4 * *(_DWORD *)(v375 + 124));
    if ( !v387 )
    {
      free(v174);
      return v2;
    }
  }
  for ( ii = 0; ; ++ii )
  {
    v176 = *(_DWORD *)(v170 + 88);
    if ( ii >= v176 )
      break;
    v177 = (_DWORD *)(*(_DWORD *)(v170 + 96) + 28 * ii);
    if ( v177[2] == -1 )
      v177[2] = 0;
    else
      v177[2] = sub_2F04E0(v376);
    (*(void (__fastcall **)(int, _DWORD *, int, int))(*(_DWORD *)(v173 + 392) + 36))(
      v375,
      v177,
      (int)v174 + v177[5] * *(unsigned __int8 *)(*(_DWORD *)(v173 + 392) + 5),
      (int)v387 + 4 * v177[6]);
  }
  v186 = *(_DWORD *)(v375 + 160);
  v187 = v176 * *(unsigned __int8 *)(*(_DWORD *)(v173 + 392) + 5);
  if ( sub_2A8A04(v375, *(_QWORD *)(v186 + 88) + *(unsigned int *)(v186 + 96), 0)
    || v187 != sub_2A8884((int)v174, v187, v375) )
  {
    free(v174);
    free(*(void **)(v170 + 96));
    *(_DWORD *)(v170 + 96) = 0;
    return v2;
  }
  *(_DWORD *)(v186 + 96) += v187;
  free(v174);
  free(*(void **)(v170 + 96));
  *(_DWORD *)(v170 + 96) = 0;
LABEL_358:
  v188 = *(_DWORD *)(v4 + 124);
  if ( v188 )
  {
    v208 = *(_DWORD *)(v4 + 160);
    v209 = *(_DWORD *)(v208 + 520);
    v210 = *((_QWORD *)v321 + 11) + (unsigned int)v321[24];
    v211 = v210;
    if ( v209 && *(_DWORD *)v209 )
    {
      v311 = 4 * v188;
      *(_DWORD *)(v209 + 40) = 4;
      *(_DWORD *)(v209 + 4) = 18;
      *(_DWORD *)(v209 + 24) = 4 * v188;
      *(_DWORD *)(v209 + 36) = 4;
      v211 = sub_2D0780(v209, v210, 1);
      if ( sub_2A8A04(v4, *(_QWORD *)(v209 + 16), 0) || sub_2A8884((int)v387, v311, v4) != v311 )
        return 0;
      v208 = *(_DWORD *)(v4 + 160);
    }
    v212 = v376;
    v213 = *(_DWORD *)(v319 + 460);
    *(_DWORD *)(v208 + 188) = 3;
    *(_DWORD *)(v208 + 196) = 0;
    *(_DWORD *)(v208 + 192) = v213;
    *(_DWORD *)(v208 + 208) = sub_2F04CC(v212);
    *(_DWORD *)(v208 + 224) = 0;
    *(_DWORD *)(v208 + 212) = 0;
    *(_DWORD *)(v208 + 216) = 0;
    *(_DWORD *)(v208 + 220) = 1;
    v214 = sub_2D0780(v208 + 184, v211, 1);
    v215 = *(_QWORD *)(v208 + 200);
    *(_QWORD *)(*(_DWORD *)(*(_DWORD *)(v4 + 160) + 2348) + 32) = v214;
    if ( !sub_2A8A04(v4, v215, 0) && sub_2F0588(v4, v376) )
      goto LABEL_359;
    return 0;
  }
LABEL_359:
  v189 = *(_DWORD *)(a2 + 52);
  if ( v189 )
  {
    v190 = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 444);
    if ( sub_2AA874(*(_DWORD *)(a2 + 52), 1) )
    {
      v191 = (*(_DWORD *)(v4 + 40) >> 5) & 0xFFFFF;
      if ( sub_2A7A10(v189, 0) )
      {
        if ( sub_2A6B50(v189, v191 & 0xFFFFC) )
        {
          v192 = sub_2A6780(v4);
          v193 = sub_2A678C(v4);
          if ( (*(int (__fastcall **)(int, int, int))(*(_DWORD *)(v189 + 4) + 340))(v189, v192, v193)
            || (*(_BYTE *)(v4 + 43) & 4) == 0 && (v199 = sub_2A6780(v4), v199 == sub_2A6780(v189)) )
          {
            v194 = (*(int (__fastcall **)(int))(*(_DWORD *)(v4 + 4) + 260))(v4);
            if ( v194 >= 0 )
            {
              v195 = sub_93028(v194);
              v196 = (*(int (__fastcall **)(int, _DWORD *))(*(_DWORD *)(v4 + 4) + 264))(v4, v195);
              if ( v196 < 0 || !(*(int (__fastcall **)(int, int))(*(_DWORD *)(v189 + 4) + 188))(v4, v189) )
                goto LABEL_374;
              v197 = *(int (__fastcall **)(int, int, _DWORD *, int))(v190 + 216);
              if ( v197 )
                v198 = v197(v4, a2, v195, v196);
              else
                v198 = sub_2D06B0(v4, a2, v195, v196);
              if ( !v198 )
              {
                ((void (__fastcall *)(int))loc_2A6C48)(7);
                sub_2A6A5C("%B: no symbol found for import library", v189);
                goto LABEL_374;
              }
              v298 = (_DWORD *)sub_2AD048(v189, v198, 0x34u);
              v299 = v195 - 1;
              v300 = 0;
              while ( v198 > v300 )
              {
                v302 = v299[1];
                ++v299;
                v301 = (_DWORD *)v302;
                v303 = v298;
                v324 = v300;
                comparc = (__compar_fn_t)(v302 + 48);
                do
                {
                  v301 += 4;
                  v303 += 4;
                  v304 = *(v301 - 3);
                  v305 = *(v301 - 2);
                  v306 = *(v301 - 1);
                  *(v303 - 4) = *(v301 - 4);
                  *(v303 - 3) = v304;
                  *(v303 - 2) = v305;
                  *(v303 - 1) = v306;
                }
                while ( v301 != (_DWORD *)comparc );
                *v303 = *v301;
                v307 = *v299;
                v300 = v324 + 1;
                v298[4] = &off_470950;
                v308 = *(_DWORD *)(v307 + 16);
                v309 = v298[2];
                v298[10] = -15;
                v310 = *(_DWORD *)(v308 + 28) + v309;
                v298[2] = v310;
                v298[6] = v310;
                *v299 = (int)v298;
                v298 += 13;
              }
              sub_302AAC(v189, v195, v198);
              if ( (*(int (__fastcall **)(int, int))(*(_DWORD *)(v189 + 4) + 168))(v4, v189) )
              {
                v200 = sub_2AC9DC(v189);
                free(v195);
                if ( v200 )
                  goto LABEL_380;
              }
              else
              {
LABEL_374:
                free(v195);
              }
            }
          }
        }
      }
    }
    sub_2A6A5C("%B: failed to generate import library", *(_DWORD *)(a2 + 52));
    return v2;
  }
LABEL_380:
  for ( jj = *(char **)(v4 + 100); jj; jj = (char *)*((_DWORD *)jj + 3) )
  {
    v202 = *((_DWORD *)jj + 35);
    if ( (*((_DWORD *)jj + 5) & 4) != 0 )
    {
      v203 = *(int (__fastcall **)(char *))(v319 + 260);
      if ( v203 )
        v204 = v203(jj) != 0;
      else
        v204 = 1;
      if ( *(_DWORD *)(v202 + 60) && !sub_16894(v4, (int)jj, (_DWORD *)(v202 + 60), (_DWORD *)v204, (_BYTE *)a2)
        || *(_DWORD *)(v202 + 76) && !sub_16894(v4, (int)jj, (_DWORD *)(v202 + 76), (_DWORD *)v204, (_BYTE *)a2) )
      {
        return 0;
      }
      *((_DWORD *)jj + 19) = 0;
    }
  }
  if ( v342 )
  {
    v218 = v353;
    if ( v353 )
      v218 = 1;
    if ( (*(_DWORD *)&v218 & (*(unsigned __int8 *)(a2 + 4) >> 5)) == 0 )
      goto LABEL_420;
    v332 = *(_DWORD *)(*(_DWORD *)(v4 + 4) + 444);
    ptrc = *(unsigned __int8 *)(*(_DWORD *)(v332 + 392) + 9);
    v340 = sub_2A6904(v4);
    v230 = sub_2AD7AC(v4, ".rela.dyn");
    v231 = sub_2AD7AC(v4, ".rel.dyn");
    v232 = v231;
    if ( v230 )
    {
      v233 = *((_DWORD *)v230 + 9);
      v234 = v231 == 0;
      if ( v231 )
        v234 = v233 == 0;
      if ( !v234 )
      {
        if ( *((_DWORD *)v231 + 9) )
        {
          v242 = 0;
          v243 = (_DWORD *)*((_DWORD *)v230 + 40);
          v244 = v230;
          baseb = (void *)v4;
          v245 = 1;
          v246 = *(_DWORD *)(v332 + 392);
          v344 = v231;
          while ( v243 )
          {
            if ( v243[1] == 1 )
            {
              v249 = *(_DWORD *)(v243[4] + 36);
              v250 = (unsigned __int64)sub_347674(v249, *(unsigned __int8 *)(v246 + 3)) >> 32;
              if ( (unsigned __int64)sub_347674(v249, *(unsigned __int8 *)(v246 + 4)) >> 32 )
              {
                if ( v250 )
                {
LABEL_658:
                  v4 = (int)baseb;
                  jj = 0;
                  v219 = 0;
                  sub_2A6A5C("%B: Unable to sort relocs - they are of an unknown size", baseb);
                  ((void (__fastcall *)(int))loc_2A6C48)(5);
                  goto LABEL_421;
                }
                v245 &= v242;
                if ( v245 )
                {
LABEL_526:
                  v4 = (int)baseb;
                  jj = 0;
                  v219 = 0;
                  sub_2A6A5C("%B: Unable to sort relocs - they are in more than one size", baseb);
                  ((void (__fastcall *)(int))loc_2A6C48)(5);
                  goto LABEL_421;
                }
                v242 = 1;
              }
              else if ( v250 )
              {
                if ( ((v245 ^ 1) & v242) != 0 )
                  goto LABEL_526;
                v242 = 1;
                v245 = 1;
              }
            }
            v243 = (_DWORD *)*v243;
          }
          for ( kk = (_DWORD *)*((_DWORD *)v344 + 40); kk; kk = (_DWORD *)*kk )
          {
            if ( kk[1] == 1 )
            {
              v277 = *(_DWORD *)(kk[4] + 36);
              v278 = (unsigned __int64)sub_347674(v277, *(unsigned __int8 *)(v246 + 3)) >> 32;
              if ( (unsigned __int64)sub_347674(v277, *(unsigned __int8 *)(v246 + 4)) >> 32 )
              {
                if ( v278 )
                  goto LABEL_658;
                v245 &= v242;
                if ( v245 )
                  goto LABEL_526;
                v242 = 1;
              }
              else if ( v278 )
              {
                if ( ((v245 ^ 1) & v242) != 0 )
                  goto LABEL_526;
                v242 = 1;
                v245 = 1;
              }
            }
          }
          v230 = v244;
          v235 = v246;
          jj = 0;
          v232 = v344;
          v4 = (int)baseb;
          if ( (((unsigned __int8)v242 ^ 1 | (unsigned __int8)v245) & 1) == 0 )
          {
LABEL_510:
            v230 = v232;
            v323 = *(unsigned __int8 *)(v235 + 3);
            v343 = *(void (__fastcall **)(int, size_t, char *))(v235 + 56);
            v352 = *(void (__fastcall **)(int, char *, unsigned int))(v235 + 60);
            goto LABEL_488;
          }
LABEL_487:
          v323 = *(unsigned __int8 *)(v235 + 4);
          v343 = *(void (__fastcall **)(int, size_t, char *))(v235 + 64);
          v352 = *(void (__fastcall **)(int, char *, unsigned int))(v235 + 68);
LABEL_488:
          v236 = (_DWORD *)*((_DWORD *)v230 + 40);
          v237 = 0;
          while ( v236 )
          {
            v238 = v236[1];
            v239 = v238 == 1;
            if ( v238 == 1 )
              v238 = v236[4];
            v236 = (_DWORD *)*v236;
            if ( v239 )
              v237 += *(_DWORD *)(v238 + 36);
          }
          if ( v237 == *((_DWORD *)v230 + 9) )
          {
            comparb = 12 * (ptrc - 1) + 20;
            v240 = sub_347418(v237, v323);
            v241 = v240;
            if ( v240 )
            {
              basea = (char *)sub_2AB4EC(v240 * comparb);
              if ( !basea )
              {
                v219 = 0;
                (*(void (__fastcall **)(int, const char *, _DWORD, int, _DWORD, _DWORD))(*(_DWORD *)(a2 + 24) + 20))(
                  a2,
                  "Not enough memory to sort relocations",
                  0,
                  v4,
                  0,
                  0);
                goto LABEL_421;
              }
              v247 = (_DWORD *)*((_DWORD *)v230 + 40);
              v359 = jj;
              if ( *(_BYTE *)(*(_DWORD *)(v332 + 392) + 10) == 32 )
                v248 = -256;
              else
                v248 = 0;
              ptrd = v248;
              while ( v247 )
              {
                if ( v247[1] == 1 )
                {
                  v273 = (_DWORD *)v247[4];
                  v219 = v273[27];
                  v274 = v273[9];
                  if ( !v219 && v274 )
                  {
                    jj = v359;
                    free(basea);
                    goto LABEL_421;
                  }
                  v356 = v219 + v274;
                  v275 = &basea[comparb * sub_347418(v273[14] * v340, v323) + 8];
                  while ( v356 > v219 )
                  {
                    v276 = v219;
                    v219 += v323;
                    v343(v4, v276, v275);
                    *((_DWORD *)v275 - 1) = (*(int (__fastcall **)(int, _DWORD *, char *))(v332 + 284))(a2, v273, v275);
                    *((_DWORD *)v275 - 2) = ptrd;
                    v275 += comparb;
                  }
                }
                v247 = (_DWORD *)*v247;
              }
              v219 = 0;
              qsort(basea, v241, comparb, (__compar_fn_t)sub_2DC840);
              v279 = basea;
              while ( v279[1] == 1 )
              {
                ++v219;
                v279 = (_DWORD *)((char *)v279 + comparb);
                if ( v241 == v219 )
                {
                  v219 = v241;
                  goto LABEL_602;
                }
              }
              v285 = v279;
              v286 = v279;
              v287 = v219;
              while ( v241 > v287 )
              {
                ++v287;
                if ( ((v286[3] ^ v285[3]) & ptrd) != 0 )
                  v285 = v286;
                *v286 = v285[2];
                v286 = (_DWORD *)((char *)v286 + comparb);
              }
LABEL_602:
              qsort(v279, v241 - v219, comparb, (__compar_fn_t)sub_2DF36C);
              v280 = *(_DWORD *)(*(_DWORD *)(a2 + 28) + 232);
              if ( v280 && v230 == *(char **)(v280 + 60) )
              {
                v288 = 0;
                while ( *(_DWORD *)&basea[20 * v241 - 20 * v288 - 16] == 4 )
                {
                  if ( v241 == ++v288 )
                    goto LABEL_629;
                }
                if ( v288 )
                {
LABEL_629:
                  if ( *(_DWORD *)(v280 + 36) == v288 * v323 )
                  {
                    v289 = (_DWORD **)(v230 + 160);
                    while ( 1 )
                    {
                      v290 = *v289;
                      if ( !*v289 )
                        break;
                      if ( v290[1] == 1 && v280 == v290[4] )
                      {
                        *v289 = (_DWORD *)*v290;
                        v247 = v290;
                      }
                      else
                      {
                        v289 = (_DWORD **)*v289;
                      }
                    }
                    *v289 = v247;
                    *v247 = 0;
                    *((_DWORD *)v230 + 41) = v247;
                  }
                }
              }
              v281 = (_DWORD *)*((_DWORD *)v230 + 40);
              v282 = basea;
              while ( v281 )
              {
                if ( v281[1] == 1 )
                {
                  v291 = v281[4];
                  v292 = *(_DWORD *)(v291 + 108);
                  v293 = *(_DWORD *)(v291 + 36);
                  v333 = v291;
                  v294 = sub_347418(v282 - basea, comparb);
                  v295 = v292 + v293;
                  *(_DWORD *)(v333 + 56) = sub_347418(v323 * v294, v340);
                  while ( v295 > v292 )
                  {
                    v296 = v292;
                    v297 = v282 + 8;
                    v292 += v323;
                    v282 += comparb;
                    v352(v4, v297, v296);
                  }
                }
                v281 = (_DWORD *)*v281;
              }
              jj = v230;
              free(basea);
LABEL_421:
              v220 = sub_2AD864(v353, ".dynamic");
              if ( !v220 )
                sub_2A6BBC("elflink.c", 12318);
              v221 = v220[27];
              v322 = &v220[9][(_DWORD)v221];
              while ( 1 )
              {
                if ( v221 >= v322 )
                  goto LABEL_393;
                (*(void (__fastcall **)(int, const char *, unsigned int *))(*(_DWORD *)(v319 + 392) + 48))(
                  v353,
                  v221,
                  &v369);
                if ( v369 > 0x12 )
                  break;
                if ( v369 >= 0x11 )
                  goto LABEL_567;
                if ( v369 == 6 )
                {
                  v222 = ".dynsym";
LABEL_434:
                  v223 = sub_2AD864(v353, v222);
LABEL_435:
                  if ( !v223 || (v224 = v223[15], (char **)v224 == &off_470950) )
                  {
LABEL_652:
                    sub_2A6A5C("could not find section %s", v222);
                    goto LABEL_122;
                  }
                  if ( *(_DWORD *)(*(_DWORD *)(v224 + 140) + 4) == 7 )
                  {
                    sub_2A6A5C("warning: section '%s' is being made into a note", v222);
                    ((void (__fastcall *)(int))loc_2A6C48)(15);
                    goto LABEL_122;
                  }
                  v225 = *(_DWORD *)(v224 + 28);
                  v226 = *(_DWORD *)(v319 + 392);
                  v370 = v225 + v223[14];
LABEL_439:
                  (*(void (__fastcall **)(int, unsigned int *, const char *))(v226 + 52))(v353, &v369, v221);
LABEL_440:
                  v226 = *(_DWORD *)(v319 + 392);
                  goto LABEL_441;
                }
                if ( v369 > 6 )
                {
                  if ( v369 == 12 )
                  {
                    v258 = *(_DWORD *)(a2 + 76);
                  }
                  else
                  {
                    if ( v369 <= 0xC )
                    {
                      if ( v369 <= 8 )
                      {
LABEL_567:
                        v264 = *(_DWORD *)(v4 + 160);
                        v265 = 0;
                        if ( v369 - 17 <= 1 )
                          v266 = 9;
                        else
                          v266 = 4;
                        v341 = v266;
                        v267 = 0;
                        for ( mm = 1; *(_DWORD *)(v264 + 532) > mm; ++mm )
                        {
                          v269 = *(_DWORD **)(*(_DWORD *)(v264 + 64) + 4 * mm);
                          if ( v269[1] == v341 && (v269[2] & 2) != 0 )
                          {
                            v270 = v269[6];
                            v271 = v269[3];
                            v267 += v270;
                            if ( v265 )
                            {
                              if ( v265 >= v271 )
                                v265 = v271;
                            }
                            else
                            {
                              v265 = v271;
                            }
                          }
                        }
                        if ( *(unsigned __int8 *)(v319 + 464) >> 7 )
                        {
                          v283 = (_DWORD *)v313[58];
                          if ( v283 )
                          {
                            v284 = v283[9];
                            v267 -= v284;
                            if ( v267 )
                            {
                              if ( *(_DWORD *)(v283[15] + 28) + v283[14] == v265 )
                                v265 += v284;
                            }
                            else
                            {
                              v265 = 0;
                            }
                          }
                        }
                        v272 = v369 == 8;
                        if ( v369 != 8 )
                          v272 = v369 == 18;
                        if ( v272 )
                          v370 = v267;
                        v226 = *(_DWORD *)(v319 + 392);
                        if ( !v272 )
                          v370 = v265;
                        goto LABEL_439;
                      }
                      goto LABEL_440;
                    }
                    if ( v369 != 13 )
                      goto LABEL_440;
                    v258 = *(_DWORD *)(a2 + 80);
                  }
                  v259 = sub_2FC920(v313, v258, 0);
                  if ( v259 && (unsigned int)*(unsigned __int8 *)(v259 + 12) - 3 <= 1 )
                  {
                    v260 = *(_DWORD *)(v259 + 20);
                    v261 = *(_DWORD *)(v259 + 24);
                    v262 = *(_DWORD *)(v260 + 60);
                    v370 = v261;
                    v263 = v262 == 0;
                    if ( v262 )
                    {
                      v259 = *(_DWORD *)(v260 + 56);
                      v260 = *(_DWORD *)(v262 + 28);
                    }
                    else
                    {
                      v370 = 0;
                    }
                    if ( v262 )
                    {
                      v226 = *(_DWORD *)(v319 + 392);
                      v261 += v259 + v260;
                    }
                    else
                    {
                      v226 = *(_DWORD *)(v319 + 392);
                    }
                    if ( !v263 )
                      v370 = v261;
                    goto LABEL_439;
                  }
                  goto LABEL_440;
                }
                if ( v369 == 4 )
                {
                  v222 = ".hash";
                  goto LABEL_434;
                }
                if ( v369 > 4 )
                {
                  v222 = ".dynstr";
                  goto LABEL_434;
                }
                v226 = *(_DWORD *)(v319 + 392);
                if ( !v369 && v219 && v322 > &v221[*(unsigned __int8 *)(v226 + 6)] )
                {
                  v229 = *(_DWORD *)(*((_DWORD *)jj + 35) + 4);
                  if ( v229 == 4 )
                  {
                    v369 = 1879048185;
                    goto LABEL_478;
                  }
                  if ( v229 == 9 )
                  {
                    v369 = 1879048186;
LABEL_478:
                    v370 = v219;
                    v219 = 0;
                    goto LABEL_439;
                  }
                }
LABEL_441:
                v221 += *(unsigned __int8 *)(v226 + 6);
              }
              if ( v369 == 32 )
              {
                v222 = ".preinit_array";
              }
              else
              {
                if ( v369 > 0x20 )
                {
                  if ( v369 == 1879048176 )
                  {
                    v222 = ".gnu.version";
                    goto LABEL_434;
                  }
                  if ( v369 >= 0x6FFFFFF1 )
                  {
                    if ( v369 == 1879048188 )
                    {
                      v222 = ".gnu.version_d";
                      goto LABEL_434;
                    }
                    if ( v369 == 1879048190 )
                    {
                      v222 = ".gnu.version_r";
                      goto LABEL_434;
                    }
                    goto LABEL_440;
                  }
                  if ( v369 != 33 )
                  {
                    if ( v369 == 1879047925 )
                    {
                      v222 = ".gnu.hash";
                      goto LABEL_434;
                    }
                    goto LABEL_440;
                  }
                  v222 = ".preinit_array";
LABEL_443:
                  v227 = sub_2AD7AC(v4, v222);
                  if ( !v227 )
                    goto LABEL_652;
                  v228 = *((_DWORD *)v227 + 9);
                  if ( !v228 )
                  {
                    v331 = v227;
                    sub_2A6A5C("warning: %s section has zero size", v222);
                    v228 = *((_DWORD *)v331 + 9);
                  }
                  v370 = v228;
                  v226 = *(_DWORD *)(v319 + 392);
                  goto LABEL_439;
                }
                if ( v369 == 26 )
                {
                  v222 = ".fini_array";
                }
                else
                {
                  if ( v369 > 0x1A )
                  {
                    if ( v369 == 27 )
                    {
                      v222 = ".init_array";
                    }
                    else
                    {
                      if ( v369 != 28 )
                        goto LABEL_440;
                      v222 = ".fini_array";
                    }
                    goto LABEL_443;
                  }
                  if ( v369 != 25 )
                    goto LABEL_440;
                  v222 = ".init_array";
                }
              }
              v223 = sub_2AD7AC(v4, v222);
              goto LABEL_435;
            }
          }
LABEL_420:
          v219 = 0;
          goto LABEL_421;
        }
LABEL_486:
        v235 = *(_DWORD *)(v332 + 392);
        goto LABEL_487;
      }
      if ( v233 )
        goto LABEL_486;
    }
    if ( !v231 || !*((_DWORD *)v231 + 9) )
      goto LABEL_420;
    v235 = *(_DWORD *)(v332 + 392);
    goto LABEL_510;
  }
LABEL_393:
  if ( v353 )
  {
    if ( !(*(int (__fastcall **)(int, int))(v319 + 156))(v4, a2) )
      goto LABEL_122;
    if ( *(char *)(a2 + 3) < 0 && (*(_BYTE *)a2 & 1) != 0 || (*(_BYTE *)(a2 + 4) & 1) != 0 )
    {
      v205 = sub_2AD864(v353, ".dynamic");
      if ( v205 )
      {
        v206 = v205[27];
        v207 = &v205[9][(_DWORD)v206];
        while ( v206 < v207 )
        {
          (*(void (__fastcall **)(int, const char *, unsigned int *))(*(_DWORD *)(v319 + 392) + 48))(v353, v206, &v369);
          if ( v369 == 22 )
          {
            if ( (*(_BYTE *)(a2 + 4) & 1) != 0 )
              LOWORD(v252) = -17428;
            else
              LOWORD(v252) = -17376;
            HIWORD(v252) = 65;
            (*(void (__fastcall **)(int))(*(_DWORD *)(a2 + 24) + 44))(v252);
            break;
          }
          v206 += *(unsigned __int8 *)(*(_DWORD *)(v319 + 392) + 6);
        }
      }
    }
    for ( nn = *(_DWORD *)(v353 + 100); nn; nn = *(_DWORD *)(nn + 12) )
    {
      v254 = *(_DWORD *)(nn + 20);
      if ( (v254 & 0x100) != 0 )
      {
        if ( *(_DWORD *)(nn + 36) )
        {
          v255 = *(char ***)(nn + 60);
          if ( v255 != &off_470950 && (v254 & 0x100000) != 0 && v313[41] != nn && v313[42] != nn )
          {
            if ( !strcmp(*(const char **)nn, ".dynstr") )
            {
              if ( sub_2A8A04(v4, *((_QWORD *)v255[35] + 2), 0) || !sub_2F0588(v4, v313[21]) )
                goto LABEL_122;
            }
            else
            {
              v256 = *(void **)(nn + 108);
              compard = *(__compar_fn_t *)(nn + 56);
              v257 = sub_2A6904(v4);
              if ( !sub_2ADDE8(
                      v4,
                      v255,
                      v256,
                      *(_DWORD *)(nn + 36),
                      (unsigned int)compard * (unsigned __int64)(unsigned int)v257,
                      *(_DWORD *)(nn + 36)) )
                goto LABEL_122;
            }
          }
        }
      }
    }
  }
  if ( (*(_BYTE *)(a2 + 1) & 0x10) == 0 )
  {
    v369 = *(_BYTE *)(a2 + 1) & 0x10;
    if ( (*(_BYTE *)a2 & 3) != 2 )
      sub_2A6BBC("elflink.c", 12591);
    sub_2ADCFC(v4, (int (__fastcall *)(int, int, int))sub_2CC3D4, (int)&v369);
    if ( v369 )
      goto LABEL_122;
  }
  if ( v313[41] && !sub_302920(v4, v313 + 33) || !sub_2F4FC4(v4, a2) )
    goto LABEL_122;
  v2 = 1;
  sub_2DD778((_DWORD *)(v4 + 100), &v374);
  *(_DWORD *)(*(_DWORD *)(*(_DWORD *)(v4 + 160) + 2348) + 56) = 1;
  if ( v354 )
  {
    v216 = sub_2AB368(v357);
    v217 = v216;
    if ( v216 )
    {
      sub_2EF3D0(v4, v216, v357);
      sub_2ADDE8(v4, v354, v217, 0, 0, v357);
      free(v217);
      return v2;
    }
    return 0;
  }
  return v2;
}
